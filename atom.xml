<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>SuooL&#39;s Blog</title>
  
  <subtitle>蛰伏于盛夏 藏华于当春</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://suool.net/"/>
  <updated>2018-12-16T08:13:29.318Z</updated>
  <id>https://suool.net/</id>
  
  <author>
    <name>SuooL</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Numpy  API函数用法</title>
    <link href="https://suool.net/2018/12/14/Numpy-Where/"/>
    <id>https://suool.net/2018/12/14/Numpy-Where/</id>
    <published>2018-12-14T06:25:21.000Z</published>
    <updated>2018-12-16T08:13:29.318Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>此部分主要是学习过程中的一些函数笔记. <a id="more"></a></p><h2 id="where函数">Where函数</h2><p><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.where.html" target="_blank" rel="noopener">官方文档的解释</a></p><p><img src="https://suool-bolg.b0.upaiyun.com/2018/12/14/9D71420E-7E75-4B4F-AA0A-63E3F8EAA0B3.png"></p><p>然而看的没怎么明白。</p><p>numpy.where() 有两种用法：</p><ol type="1"><li><code>np.where(condition, x, y)</code> 满足条件<code>(condition)</code>，输出<code>x</code>，不满足输出<code>y</code>。</li><li><code>np.where(condition)</code> 只有条件 <code>(condition)</code>，没有<code>x</code>和<code>y</code>，则输出满足条件 (即非0) 元素的坐标 (等价于<code>numpy.nonzero</code>)。这里的坐标以<code>tuple</code>的形式给出，通常原数组有多少维，输出的<code>tuple</code>中就包含几个数组，分别对应符合条件元素的各维坐标。</li></ol><p>看到<a href="https://www.zhihu.com/question/62844162/answer/300561552" target="_blank" rel="noopener">知乎回答</a>的图示非常清晰，如下</p><p>第一种用法的图示:</p><p>输出位置的对应如下： <img src="https://suool-bolg.b0.upaiyun.com/2018/12/14/15447692455357.jpg"></p><p>同理： <img src="https://suool-bolg.b0.upaiyun.com/2018/12/14/15447691065494.jpg"></p><p>第二种用法的图示： 只有条件 (condition)，没有x和y，则输出满足条件 (即非0) 元素的坐标 (等价于numpy.nonzero)。这里的坐标以tuple的形式给出，通常原数组有多少维，输出的tuple中就包含几个数组，分别对应符合条件元素的各维坐标。即是第一组为第一维度的坐标，依次对应，每列对应一个元素完整的坐标，如下: <img src="https://suool-bolg.b0.upaiyun.com/2018/12/14/15447691689662.jpg"> 即有: <img src="https://suool-bolg.b0.upaiyun.com/2018/12/14/15447691891533.jpg"></p><h2 id="numpy.random.multinomial函数">numpy.random.multinomial函数</h2><p><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.multinomial.html" target="_blank" rel="noopener">官方文档地址</a></p><figure><img src="https://suool-bolg.b0.upaiyun.com/2018/12/14/D3481F88-A58F-429F-A43C-A09F515DB3DF.png" alt="官方介绍"><figcaption>官方介绍</figcaption></figure><p>这是 numpy 提供的随机二项式分布实现，二项式分布(<code>binomial distribution</code>)如下表示: <span class="math display">\[P(N)=\begin{pmatrix}n \\ N\end{pmatrix}p^N(1-p)^{n-N}\]</span> 函数原型如下： <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy<span class="selector-class">.random</span><span class="selector-class">.RandomState</span><span class="selector-class">.binomial</span>(n, <span class="selector-tag">p</span>, size=None)</span><br></pre></td></tr></table></figure></p><p>表示对一个二项分布进行采样，<code>size</code>表示采样的次数，参数中的<code>n, p</code>分别对应于公式中的<span class="math inline">\(n,p\)</span>，函数的返回值表示<code>n</code>中<code>成功（success）</code>的次数（也即<span class="math inline">\(N\)</span>）。 举个例子，比如掷骰子，一共3个硬币，每个都投一次，三个都是正面朝上的概率是多少？</p><p>这个使用简单的概率统计知识很容易计算得到： <span class="math display">\[ P=\begin{pmatrix}n \\ N\end{pmatrix}p^N(1-p)^{n-N}=\begin{pmatrix}3 \\ 0\end{pmatrix}0.5^0(1-0.5)^3=0.5^3 = 0.125\]</span></p><p>使用上述函数计算大概值则是做足够多次的试验，统计其中全为正面朝上的概率，通过频率计算概率，如下： <img src="https://suool-bolg.b0.upaiyun.com/2018/12/14/4B6FFD2C-82EC-4C9C-82E2-9808FA9560F4.png" alt="实验结果"></p><h2 id="numpy中矩阵乘法星乘和点乘.dot的区别">numpy中矩阵乘法，星乘(*)和点乘(.dot)的区别</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line">a = numpy.array([[<span class="number">1</span>,<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">3</span>,<span class="number">4</span>]])</span><br><span class="line">b = numpy.array([[<span class="number">5</span>,<span class="number">6</span>],</span><br><span class="line">                 [<span class="number">7</span>,<span class="number">8</span>]])</span><br></pre></td></tr></table></figure><p>计算结果</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a*b</span><br><span class="line">&gt;&gt;&gt;array([[ <span class="number">5</span>, <span class="number">12</span>],</span><br><span class="line">          [<span class="number">21</span>, <span class="number">32</span>]])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a.dot(b)</span><br><span class="line">&gt;&gt;&gt;array([[<span class="number">19</span>, <span class="number">22</span>],</span><br><span class="line">          [<span class="number">43</span>, <span class="number">50</span>]])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">numpy.dot(a,b)</span><br><span class="line">&gt;&gt;&gt;array([[<span class="number">19</span>, <span class="number">22</span>],</span><br><span class="line">          [<span class="number">43</span>, <span class="number">50</span>]])</span><br><span class="line">          </span><br><span class="line">numpy.dot(b,a)</span><br><span class="line">&gt;&gt;&gt;array([[<span class="number">23</span>, <span class="number">34</span>],</span><br><span class="line">          [<span class="number">31</span>, <span class="number">46</span>]])</span><br></pre></td></tr></table></figure><p><strong>星乘表示矩阵内各对应位置相乘，保证矩阵size 相同。 点乘表示求矩阵内积，遵循矩阵乘法的规则。</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;此部分主要是学习过程中的一些函数笔记.
    
    </summary>
    
      <category term="基础学习" scheme="https://suool.net/categories/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="Python" scheme="https://suool.net/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>“熵”不起：从熵、最大熵原理到最大熵模型</title>
    <link href="https://suool.net/2018/11/27/maximum-entropy-model/"/>
    <id>https://suool.net/2018/11/27/maximum-entropy-model/</id>
    <published>2018-11-27T00:50:23.000Z</published>
    <updated>2018-12-17T12:24:34.652Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="引言">引言</h2><p>“熵”最初是热力学中的一个概念，之前关于<a href="https://suool.net/2018/07/19/Mnist-With-Decision-Tree-ID3/">决策树算法</a>的部分涉及到一部分熵的知识，上世纪40年代，香农首先在信息论中引入了信息熵的概念。信息熵用来表示不确定度的度量，不确定度越大，熵值越大。极限情况，当一个随机变量均匀分布时，熵值最大；完全确定时，熵值为0。</p><p>什么是最大熵原理呢？我们常常讲不要把所有鸡蛋放在一个篮子里，这样可以降低风险，这其实就是最大熵原理的一个朴素说法，因为当我们遇到不确定性时，就要保留各种可能性。在信息处理中，这个原理同样适用。在数学上，这个原理被称为<code>最大熵原理</code>（<code>the maximum entropy principle</code>）。同样的，当我们在回答，扔一个色子的时候，每个面朝上的概率分别是多少？所有人都会回答说是<span class="math inline">\(\frac{1}{6}\)</span>。这个回答是正确的，但是为什么是<span class="math inline">\(\frac{1}{6}\)</span>而不是其他呢？这里就应用到最大熵原理。对这个“一无所知”的色子，假定每一面朝上的概率相同是最保险的做法。从信息论的角度来解释，就是保留了最大的不确定性，也就是让熵达到最大。</p><a id="more"></a><p>最大熵原理指出，当我们需要对一个随机事件的概率分布进行预测的时候，我们的预测应当满足已知的条件，而对未知的情况不做任何主观的假设。在这种情况下，概率分布最均匀，预测的风险最小。因为这时候概率分布的信息熵最大，所以人们称这种模型为“最大熵模型”。</p><p>最大熵模型是由最大熵原理推导实现。在这篇文章中的提纲如下：</p><ol type="1"><li>预备知识<ul><li>什么是熵 ( Entropy )</li><li>常见的「熵」</li><li>贝叶斯定理</li><li>拉格朗日乘数</li><li>最大似然估计</li></ul></li><li>最大熵原理</li><li>最大熵模型</li><li>最大熵模型求解</li><li>最大熵模型算法实战</li><li>最大熵模型小结</li></ol><h2 id="预备知识">预备知识</h2><h3 id="什么是熵">什么是熵</h3><p>熵的概念最早起源于物理学，用于度量一个热力学系统的无序程度。后由香农引入到信息论中，在信息论和概率统计中，熵用来表示随机变量不确定性的度量。</p><p>熵是根据已知的知识进行建模，而对未知的的不作任何假设。熵是对「不确定性」的量度，比较不可能发生的事情，当它发生了，会提供更多的信息。也就是说，当信息源越随机，它的「熵」越大。</p><p>这部分其实在前面的文章中有过<a href="https://suool.net/2018/06/21/%E4%BF%A1%E6%81%AF%E8%AE%BA%E5%92%8C%E8%B4%9D%E5%8F%B6%E6%96%AF/">形象化的说明</a>，这里不再细说。</p><p>具体的，随机变量X的熵的表达式如下： <span class="math display">\[H(X) = -\sum\limits_{i=1}^{n}p_i logp_i\]</span></p><p>其中<span class="math inline">\(n\)</span>代表<span class="math inline">\(X\)</span>的<span class="math inline">\(n\)</span>种不同的离散取值。而<span class="math inline">\(p_i\)</span>代表了<span class="math inline">\(X\)</span>取值为<span class="math inline">\(i\)</span>的概率，<span class="math inline">\(log\)</span>为以2或者<span class="math inline">\(e\)</span>为底的对数。当<span class="math inline">\(p_i=0\)</span>时，定义<span class="math inline">\(0log0=0\)</span>。</p><p>连续变量的表达式如下： <span class="math display">\[S=-\sum_x p(x)\log p(x)\]</span> 或： <span class="math display">\[S=-\int p(x)\log p(x) dx\]</span></p><h3 id="常见的熵">常见的熵</h3><p><strong>联合熵</strong> 熟悉了一个变量X的熵，很容易推广到多个变量的联合熵，这里给出两个变量X和Y的联合熵表达式： <span class="math display">\[H(X,Y) = -\sum\limits_{i=1}^{n}p(x_i,y_i)logp(x_i,y_i)\]</span></p><p><strong>条件熵</strong> 有了联合熵，又可以得到条件熵的表达式<span class="math inline">\(H(Y|X)\)</span>，条件熵类似于条件概率，描述了在已知第二个随机变量 <span class="math inline">\(X\)</span>的值的前提下，随机变量 <span class="math inline">\(Y\)</span>的信息熵还有多少。。表达式如下： <span class="math display">\[H(Y|X) = -\sum\limits_{i=1}^{n}p(x_i,y_i)logp(y_i|x_i) = \sum\limits_{j=1}^{n}p(x_j)H(Y|x_j)\]</span></p><p><strong>交叉熵</strong></p><p><strong>相对熵与互信息</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;引言&quot;&gt;引言&lt;/h2&gt;
&lt;p&gt;“熵”最初是热力学中的一个概念，之前关于&lt;a href=&quot;https://suool.net/2018/07/19/Mnist-With-Decision-Tree-ID3/&quot;&gt;决策树算法&lt;/a&gt;的部分涉及到一部分熵的知识，上世纪40年代，香农首先在信息论中引入了信息熵的概念。信息熵用来表示不确定度的度量，不确定度越大，熵值越大。极限情况，当一个随机变量均匀分布时，熵值最大；完全确定时，熵值为0。&lt;/p&gt;
&lt;p&gt;什么是最大熵原理呢？我们常常讲不要把所有鸡蛋放在一个篮子里，这样可以降低风险，这其实就是最大熵原理的一个朴素说法，因为当我们遇到不确定性时，就要保留各种可能性。在信息处理中，这个原理同样适用。在数学上，这个原理被称为&lt;code&gt;最大熵原理&lt;/code&gt;（&lt;code&gt;the maximum entropy principle&lt;/code&gt;）。同样的，当我们在回答，扔一个色子的时候，每个面朝上的概率分别是多少？所有人都会回答说是&lt;span class=&quot;math inline&quot;&gt;\(\frac{1}{6}\)&lt;/span&gt;。这个回答是正确的，但是为什么是&lt;span class=&quot;math inline&quot;&gt;\(\frac{1}{6}\)&lt;/span&gt;而不是其他呢？这里就应用到最大熵原理。对这个“一无所知”的色子，假定每一面朝上的概率相同是最保险的做法。从信息论的角度来解释，就是保留了最大的不确定性，也就是让熵达到最大。&lt;/p&gt;
    
    </summary>
    
      <category term="机器学习" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="机器学习" scheme="https://suool.net/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>NLP 之关键词提取算法概述</title>
    <link href="https://suool.net/2018/11/19/keywords-extract-1/"/>
    <id>https://suool.net/2018/11/19/keywords-extract-1/</id>
    <published>2018-11-19T11:00:31.000Z</published>
    <updated>2018-11-22T14:24:26.180Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="前言">前言</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;

      
    
    </summary>
    
      <category term="机器学习" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="NLP" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/NLP/"/>
    
    
      <category term="NLP" scheme="https://suool.net/tags/NLP/"/>
    
  </entry>
  
  <entry>
    <title>隐马尔科夫模型（HMM）</title>
    <link href="https://suool.net/2018/11/18/HMM-Viterbi/"/>
    <id>https://suool.net/2018/11/18/HMM-Viterbi/</id>
    <published>2018-11-18T14:32:35.000Z</published>
    <updated>2018-12-16T13:48:54.196Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="前言">前言</h2><p>同时在<a href="https://suool.net/2018/11/16/Text-Segmentation-1/">LP 之分词技术概述</a>中有提到 HMM 模型，虽然此方法在现代的作用和地位有所下降，但是依然是非常值得了解的学习机器学习经典算法。 <a id="more"></a> 本文的基本提纲如下： 1. 基础知识 1. 定义 2. 适用场景 3. 隐马尔科夫模型的两个基本假设 4. 实例 2. HMM模型的三个基本问题 1. 前向后向算法评估观察序列概率 2. 鲍姆-韦尔奇算法求解HMM参数 3. 维特比算法解码隐藏状态序列 3. 分词实战</p><h2 id="基础知识">基础知识</h2><h3 id="定义">定义</h3><p><strong>直观定义</strong> 首先看一个图： <img src="https://suool-bolg.b0.upaiyun.com/2018/12/14/15439271020806.jpg" alt="状态序列图"></p><p>该图的文字描述是其分成两排，第一排是<span class="math inline">\(y\)</span>序列，第二排是<span class="math inline">\(x\)</span>序列。每个<span class="math inline">\(x\)</span>都只有一个<span class="math inline">\(y\)</span>指向它，每个<span class="math inline">\(y\)</span>也都有另一个<span class="math inline">\(y\)</span>指向它。</p><p>下面按照上述描述给出一个定义：</p><ul><li><strong>状态序列（上图中的<span class="math inline">\(y\)</span>，下面的<span class="math inline">\(I\)</span>）</strong>：隐藏的马尔科夫链随机生成的状态序列，称为状态序列（state sequence）</li><li><strong>观测序列（上图中的<span class="math inline">\(x\)</span>，下面的<span class="math inline">\(O\)</span>）</strong>: 每个状态生成一个观测，而由此产生的观测的随机序列，称为观测序列（obeservation sequence）</li><li><strong>隐马尔科夫模型</strong>：隐马尔科夫模型是关于时序的概率模型，描述由一个隐藏的马尔科夫链随机生成不可观测的状态随机序列，再由各个状态生成一个观测而产生观测随机序列的过程。</li></ul><p>序列的每一个位置可以看做是一个时刻，HMM 由初始概率分布、状态转移概率分布和观测概率分布确定。</p><p>形式化的定义如下：</p><p><strong>形式化定义</strong></p><p>设<span class="math inline">\(Q\)</span>是所有可能的状态的集合，<span class="math inline">\(V\)</span>是所有可能的观测的集合，如下:</p><p><span class="math display">\[Q={q_1,q_2,...,q_N},V={v_1,v_2,...,v_M}\]</span> 其中，<span class="math inline">\(N\)</span>是可能的状态数，<span class="math inline">\(M\)</span>是可能的观测数。</p><p><span class="math inline">\(I\)</span>是长度为<span class="math inline">\(T\)</span>的状态序列，<span class="math inline">\(O\)</span>是对应的观测序列。 <span class="math display">\[I=(i_1,i_2,...,i_T),O=(o_1,o_2,...,o_T)\]</span></p><p>A是状态转移概率矩阵： <span class="math display">\[A=[a_{ij}]_{N×N}\]</span></p><p>在时刻<span class="math inline">\(t\)</span>，处于<span class="math inline">\(q_i\)</span> 状态的条件下在时刻<span class="math inline">\(t+1\)</span>转移到状态<span class="math inline">\(q_j\)</span> 的概率【<strong>齐次马尔科夫链假设,下面的第一个假设</strong>】： <span class="math display">\[a_{ij}=P(i_{t+1}=q_j|i_t=q_i)\]</span></p><p>B是观测概率矩阵: <span class="math display">\[B=[b_j(k)]_{N×M}\]</span> 其中<span class="math inline">\(k=1,2,...,M; j=1,2,...,N\)</span> 其中，在时刻<span class="math inline">\(t\)</span>处于状态<span class="math inline">\(q_j\)</span> 的条件下生成观测<span class="math inline">\(v_k\)</span> 的概率【<strong>观测独立性假设，下面第二个假设</strong>】： <span class="math display">\[b_j(k)=P(o_t=v_k|i_t=q_j)\]</span></p><p>π是初始状态概率向量: <span class="math display">\[π=(π_i)\]</span> 其中，<span class="math inline">\(π_i=P(i_1=q_i)\)</span> 隐马尔科夫模型由初始状态概率向量<span class="math inline">\(π\)</span>、状态转移概率矩阵A和观测概率矩阵<span class="math inline">\(B\)</span>决定。<span class="math inline">\(π\)</span>和<span class="math inline">\(A\)</span>决定状态序列，<span class="math inline">\(B\)</span>决定观测序列。因此，隐马尔科夫模型<span class="math inline">\(λ\)</span>可以由三元符号表示，即：<span class="math inline">\(λ=(A,B,π)\)</span>。<span class="math inline">\(A,B,π\)</span>称为隐马尔科夫模型的<strong>三要素</strong>。</p><h3 id="适用场景">适用场景</h3><p>有了上述的定义可以看出使用HMM模型时我们的问题一般有这两个特征：</p><ul><li>我们的问题是基于序列的，比如时间序列，或者状态序列。</li><li>我们的问题中有两类数据，一类序列数据是可以观测到的，即观测序列；而另一类数据是不能观察到的，即隐藏状态序列，简称状态序列。</li></ul><p>比如语言转文字的问题，发出的一串连续的声音就是观测序列，而实际要表达的一段话的文字就是状态序列，机器的任务，就是从这一串连续的声音中判断出最可能要表达的文字的内容。</p><h3 id="隐马尔科夫模型的两个基本假设">隐马尔科夫模型的两个基本假设</h3><ol type="1"><li>设隐马尔科夫链在任意时刻<span class="math inline">\(t\)</span>的状态只依赖于其前一时刻的状态，与其他时刻的状态及观测无关，也与时刻<span class="math inline">\(t\)</span>无关。（齐次马尔科夫性假设）</li><li>假设任意时刻的观测只依赖于该时刻的马尔科夫链的状态，与其他观测和状态无关。（观测独立性假设）</li></ol><h3 id="一个例子">一个例子</h3><p>李航的《统计学习方法》的例子，假设我们有3个盒子，每个盒子里都有红色和白色两种球，这三个盒子里球的数量分别是：</p><table><thead><tr class="header"><th>盒子</th><th>1</th><th>2</th><th>3</th></tr></thead><tbody><tr class="odd"><td>红球数</td><td>5</td><td>4</td><td>7</td></tr><tr class="even"><td>白球数</td><td>5</td><td>6</td><td>3</td></tr></tbody></table><p>按照下面的方法从盒子里抽球: 1. 开始的时候，从第一个盒子抽球的概率是0.2，从第二个盒子抽球的概率是0.4，从第三个盒子抽球的概率是0.4。以这个概率抽一次球后，将球放回。 2. 从当前盒子转移到下一个盒子进行抽球。规则是： 1. 如果当前抽球的盒子是第一个盒子，则以0.5的概率仍然留在第一个盒子继续抽球，以0.2的概率去第二个盒子抽球，以0.3的概率去第三个盒子抽球。 2. 如果当前抽球的盒子是第二个盒子，则以0.5的概率仍然留在第二个盒子继续抽球，以0.3的概率去第一个盒子抽球，以0.2的概率去第三个盒子抽球。 3. 如果当前抽球的盒子是第三个盒子，则以0.5的概率仍然留在第三个盒子继续抽球，以0.2的概率去第一个盒子抽球，以0.3的概率去第二个盒子抽球。 4. 如此下去，直到重复三次.</p><p>得到一个球的颜色的观测序列: <img src="https://suool-bolg.b0.upaiyun.com/2018/12/14/D5B700EB-22B4-487C-9C7D-1AC101E2E7BD.png" alt="参数"></p><p><strong>HMM观测序列的生成</strong> 从上面的例子，我们也可以抽象出HMM观测序列生成的过程。 输入的模型是<span class="math inline">\(\lambda = (A, B, \Pi)\)</span>，观测序列长度是<span class="math inline">\(T\)</span>. 输出是观测序列：<span class="math inline">\(O =\{o_1,o_2,...o_T\}\)</span></p><p>以下代码是 HMM 一个模拟，</p><script text="text/javascript" src="/lib/jquery/index.js"></script><iframe id="ipynb" marginheight="0" frameborder="0" width="824px" srcdoc="<!DOCTYPE html><html><head><meta charset='utf-8' /><!-- hexo-inject:begin --><!-- hexo-inject:end --><title>HMMBall</title><script src='https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js'></script><script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js'></script><style type='text/css'>    /*!** Twitter Bootstrap**//*! * Bootstrap v3.3.7 (http://getbootstrap.com) * Copyright 2011-2016 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE) *//*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html {  font-family: sans-serif;  -ms-text-size-adjust: 100%;  -webkit-text-size-adjust: 100%;}body {  margin: 0;}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary {  display: block;}audio,canvas,progress,video {  display: inline-block;  vertical-align: baseline;}audio:not([controls]) {  display: none;  height: 0;}[hidden],template {  display: none;}a {  background-color: transparent;}a:active,a:hover {  outline: 0;}abbr[title] {  border-bottom: 1px dotted;}b,strong {  font-weight: bold;}dfn {  font-style: italic;}h1 {  font-size: 2em;  margin: 0.67em 0;}mark {  background: #ff0;  color: #000;}small {  font-size: 80%;}sub,sup {  font-size: 75%;  line-height: 0;  position: relative;  vertical-align: baseline;}sup {  top: -0.5em;}sub {  bottom: -0.25em;}img {  border: 0;}svg:not(:root) {  overflow: hidden;}figure {  margin: 1em 40px;}hr {  box-sizing: content-box;  height: 0;}pre {  overflow: auto;}code,kbd,pre,samp {  font-family: monospace, monospace;  font-size: 1em;}button,input,optgroup,select,textarea {  color: inherit;  font: inherit;  margin: 0;}button {  overflow: visible;}button,select {  text-transform: none;}button,html input[type='button'],input[type='reset'],input[type='submit'] {  -webkit-appearance: button;  cursor: pointer;}button[disabled],html input[disabled] {  cursor: default;}button::-moz-focus-inner,input::-moz-focus-inner {  border: 0;  padding: 0;}input {  line-height: normal;}input[type='checkbox'],input[type='radio'] {  box-sizing: border-box;  padding: 0;}input[type='number']::-webkit-inner-spin-button,input[type='number']::-webkit-outer-spin-button {  height: auto;}input[type='search'] {  -webkit-appearance: textfield;  box-sizing: content-box;}input[type='search']::-webkit-search-cancel-button,input[type='search']::-webkit-search-decoration {  -webkit-appearance: none;}fieldset {  border: 1px solid #c0c0c0;  margin: 0 2px;  padding: 0.35em 0.625em 0.75em;}legend {  border: 0;  padding: 0;}textarea {  overflow: auto;}optgroup {  font-weight: bold;}table {  border-collapse: collapse;  border-spacing: 0;}td,th {  padding: 0;}/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */@media print {  *,  *:before,  *:after {    background: transparent !important;    box-shadow: none !important;    text-shadow: none !important;  }  a,  a:visited {    text-decoration: underline;  }  a[href]:after {    content: ' (' attr(href) ')';  }  abbr[title]:after {    content: ' (' attr(title) ')';  }  a[href^='#']:after,  a[href^='javascript:']:after {    content: '';  }  pre,  blockquote {    border: 1px solid #999;    page-break-inside: avoid;  }  thead {    display: table-header-group;  }  tr,  img {    page-break-inside: avoid;  }  img {    max-width: 100% !important;  }  p,  h2,  h3 {    orphans: 3;    widows: 3;  }  h2,  h3 {    page-break-after: avoid;  }  .navbar {    display: none;  }  .btn > .caret,  .dropup > .btn > .caret {    border-top-color: #000 !important;  }  .label {    border: 1px solid #000;  }  .table {    border-collapse: collapse !important;  }  .table td,  .table th {    background-color: #fff !important;  }  .table-bordered th,  .table-bordered td {    border: 1px solid #ddd !important;  }}@font-face {  font-family: 'Glyphicons Halflings';  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot');  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff2') format('woff2'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff') format('woff'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');}.glyphicon {  position: relative;  top: 1px;  display: inline-block;  font-family: 'Glyphicons Halflings';  font-style: normal;  font-weight: normal;  line-height: 1;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;}.glyphicon-asterisk:before {  content: '\002a';}.glyphicon-plus:before {  content: '\002b';}.glyphicon-euro:before,.glyphicon-eur:before {  content: '\20ac';}.glyphicon-minus:before {  content: '\2212';}.glyphicon-cloud:before {  content: '\2601';}.glyphicon-envelope:before {  content: '\2709';}.glyphicon-pencil:before {  content: '\270f';}.glyphicon-glass:before {  content: '\e001';}.glyphicon-music:before {  content: '\e002';}.glyphicon-search:before {  content: '\e003';}.glyphicon-heart:before {  content: '\e005';}.glyphicon-star:before {  content: '\e006';}.glyphicon-star-empty:before {  content: '\e007';}.glyphicon-user:before {  content: '\e008';}.glyphicon-film:before {  content: '\e009';}.glyphicon-th-large:before {  content: '\e010';}.glyphicon-th:before {  content: '\e011';}.glyphicon-th-list:before {  content: '\e012';}.glyphicon-ok:before {  content: '\e013';}.glyphicon-remove:before {  content: '\e014';}.glyphicon-zoom-in:before {  content: '\e015';}.glyphicon-zoom-out:before {  content: '\e016';}.glyphicon-off:before {  content: '\e017';}.glyphicon-signal:before {  content: '\e018';}.glyphicon-cog:before {  content: '\e019';}.glyphicon-trash:before {  content: '\e020';}.glyphicon-home:before {  content: '\e021';}.glyphicon-file:before {  content: '\e022';}.glyphicon-time:before {  content: '\e023';}.glyphicon-road:before {  content: '\e024';}.glyphicon-download-alt:before {  content: '\e025';}.glyphicon-download:before {  content: '\e026';}.glyphicon-upload:before {  content: '\e027';}.glyphicon-inbox:before {  content: '\e028';}.glyphicon-play-circle:before {  content: '\e029';}.glyphicon-repeat:before {  content: '\e030';}.glyphicon-refresh:before {  content: '\e031';}.glyphicon-list-alt:before {  content: '\e032';}.glyphicon-lock:before {  content: '\e033';}.glyphicon-flag:before {  content: '\e034';}.glyphicon-headphones:before {  content: '\e035';}.glyphicon-volume-off:before {  content: '\e036';}.glyphicon-volume-down:before {  content: '\e037';}.glyphicon-volume-up:before {  content: '\e038';}.glyphicon-qrcode:before {  content: '\e039';}.glyphicon-barcode:before {  content: '\e040';}.glyphicon-tag:before {  content: '\e041';}.glyphicon-tags:before {  content: '\e042';}.glyphicon-book:before {  content: '\e043';}.glyphicon-bookmark:before {  content: '\e044';}.glyphicon-print:before {  content: '\e045';}.glyphicon-camera:before {  content: '\e046';}.glyphicon-font:before {  content: '\e047';}.glyphicon-bold:before {  content: '\e048';}.glyphicon-italic:before {  content: '\e049';}.glyphicon-text-height:before {  content: '\e050';}.glyphicon-text-width:before {  content: '\e051';}.glyphicon-align-left:before {  content: '\e052';}.glyphicon-align-center:before {  content: '\e053';}.glyphicon-align-right:before {  content: '\e054';}.glyphicon-align-justify:before {  content: '\e055';}.glyphicon-list:before {  content: '\e056';}.glyphicon-indent-left:before {  content: '\e057';}.glyphicon-indent-right:before {  content: '\e058';}.glyphicon-facetime-video:before {  content: '\e059';}.glyphicon-picture:before {  content: '\e060';}.glyphicon-map-marker:before {  content: '\e062';}.glyphicon-adjust:before {  content: '\e063';}.glyphicon-tint:before {  content: '\e064';}.glyphicon-edit:before {  content: '\e065';}.glyphicon-share:before {  content: '\e066';}.glyphicon-check:before {  content: '\e067';}.glyphicon-move:before {  content: '\e068';}.glyphicon-step-backward:before {  content: '\e069';}.glyphicon-fast-backward:before {  content: '\e070';}.glyphicon-backward:before {  content: '\e071';}.glyphicon-play:before {  content: '\e072';}.glyphicon-pause:before {  content: '\e073';}.glyphicon-stop:before {  content: '\e074';}.glyphicon-forward:before {  content: '\e075';}.glyphicon-fast-forward:before {  content: '\e076';}.glyphicon-step-forward:before {  content: '\e077';}.glyphicon-eject:before {  content: '\e078';}.glyphicon-chevron-left:before {  content: '\e079';}.glyphicon-chevron-right:before {  content: '\e080';}.glyphicon-plus-sign:before {  content: '\e081';}.glyphicon-minus-sign:before {  content: '\e082';}.glyphicon-remove-sign:before {  content: '\e083';}.glyphicon-ok-sign:before {  content: '\e084';}.glyphicon-question-sign:before {  content: '\e085';}.glyphicon-info-sign:before {  content: '\e086';}.glyphicon-screenshot:before {  content: '\e087';}.glyphicon-remove-circle:before {  content: '\e088';}.glyphicon-ok-circle:before {  content: '\e089';}.glyphicon-ban-circle:before {  content: '\e090';}.glyphicon-arrow-left:before {  content: '\e091';}.glyphicon-arrow-right:before {  content: '\e092';}.glyphicon-arrow-up:before {  content: '\e093';}.glyphicon-arrow-down:before {  content: '\e094';}.glyphicon-share-alt:before {  content: '\e095';}.glyphicon-resize-full:before {  content: '\e096';}.glyphicon-resize-small:before {  content: '\e097';}.glyphicon-exclamation-sign:before {  content: '\e101';}.glyphicon-gift:before {  content: '\e102';}.glyphicon-leaf:before {  content: '\e103';}.glyphicon-fire:before {  content: '\e104';}.glyphicon-eye-open:before {  content: '\e105';}.glyphicon-eye-close:before {  content: '\e106';}.glyphicon-warning-sign:before {  content: '\e107';}.glyphicon-plane:before {  content: '\e108';}.glyphicon-calendar:before {  content: '\e109';}.glyphicon-random:before {  content: '\e110';}.glyphicon-comment:before {  content: '\e111';}.glyphicon-magnet:before {  content: '\e112';}.glyphicon-chevron-up:before {  content: '\e113';}.glyphicon-chevron-down:before {  content: '\e114';}.glyphicon-retweet:before {  content: '\e115';}.glyphicon-shopping-cart:before {  content: '\e116';}.glyphicon-folder-close:before {  content: '\e117';}.glyphicon-folder-open:before {  content: '\e118';}.glyphicon-resize-vertical:before {  content: '\e119';}.glyphicon-resize-horizontal:before {  content: '\e120';}.glyphicon-hdd:before {  content: '\e121';}.glyphicon-bullhorn:before {  content: '\e122';}.glyphicon-bell:before {  content: '\e123';}.glyphicon-certificate:before {  content: '\e124';}.glyphicon-thumbs-up:before {  content: '\e125';}.glyphicon-thumbs-down:before {  content: '\e126';}.glyphicon-hand-right:before {  content: '\e127';}.glyphicon-hand-left:before {  content: '\e128';}.glyphicon-hand-up:before {  content: '\e129';}.glyphicon-hand-down:before {  content: '\e130';}.glyphicon-circle-arrow-right:before {  content: '\e131';}.glyphicon-circle-arrow-left:before {  content: '\e132';}.glyphicon-circle-arrow-up:before {  content: '\e133';}.glyphicon-circle-arrow-down:before {  content: '\e134';}.glyphicon-globe:before {  content: '\e135';}.glyphicon-wrench:before {  content: '\e136';}.glyphicon-tasks:before {  content: '\e137';}.glyphicon-filter:before {  content: '\e138';}.glyphicon-briefcase:before {  content: '\e139';}.glyphicon-fullscreen:before {  content: '\e140';}.glyphicon-dashboard:before {  content: '\e141';}.glyphicon-paperclip:before {  content: '\e142';}.glyphicon-heart-empty:before {  content: '\e143';}.glyphicon-link:before {  content: '\e144';}.glyphicon-phone:before {  content: '\e145';}.glyphicon-pushpin:before {  content: '\e146';}.glyphicon-usd:before {  content: '\e148';}.glyphicon-gbp:before {  content: '\e149';}.glyphicon-sort:before {  content: '\e150';}.glyphicon-sort-by-alphabet:before {  content: '\e151';}.glyphicon-sort-by-alphabet-alt:before {  content: '\e152';}.glyphicon-sort-by-order:before {  content: '\e153';}.glyphicon-sort-by-order-alt:before {  content: '\e154';}.glyphicon-sort-by-attributes:before {  content: '\e155';}.glyphicon-sort-by-attributes-alt:before {  content: '\e156';}.glyphicon-unchecked:before {  content: '\e157';}.glyphicon-expand:before {  content: '\e158';}.glyphicon-collapse-down:before {  content: '\e159';}.glyphicon-collapse-up:before {  content: '\e160';}.glyphicon-log-in:before {  content: '\e161';}.glyphicon-flash:before {  content: '\e162';}.glyphicon-log-out:before {  content: '\e163';}.glyphicon-new-window:before {  content: '\e164';}.glyphicon-record:before {  content: '\e165';}.glyphicon-save:before {  content: '\e166';}.glyphicon-open:before {  content: '\e167';}.glyphicon-saved:before {  content: '\e168';}.glyphicon-import:before {  content: '\e169';}.glyphicon-export:before {  content: '\e170';}.glyphicon-send:before {  content: '\e171';}.glyphicon-floppy-disk:before {  content: '\e172';}.glyphicon-floppy-saved:before {  content: '\e173';}.glyphicon-floppy-remove:before {  content: '\e174';}.glyphicon-floppy-save:before {  content: '\e175';}.glyphicon-floppy-open:before {  content: '\e176';}.glyphicon-credit-card:before {  content: '\e177';}.glyphicon-transfer:before {  content: '\e178';}.glyphicon-cutlery:before {  content: '\e179';}.glyphicon-header:before {  content: '\e180';}.glyphicon-compressed:before {  content: '\e181';}.glyphicon-earphone:before {  content: '\e182';}.glyphicon-phone-alt:before {  content: '\e183';}.glyphicon-tower:before {  content: '\e184';}.glyphicon-stats:before {  content: '\e185';}.glyphicon-sd-video:before {  content: '\e186';}.glyphicon-hd-video:before {  content: '\e187';}.glyphicon-subtitles:before {  content: '\e188';}.glyphicon-sound-stereo:before {  content: '\e189';}.glyphicon-sound-dolby:before {  content: '\e190';}.glyphicon-sound-5-1:before {  content: '\e191';}.glyphicon-sound-6-1:before {  content: '\e192';}.glyphicon-sound-7-1:before {  content: '\e193';}.glyphicon-copyright-mark:before {  content: '\e194';}.glyphicon-registration-mark:before {  content: '\e195';}.glyphicon-cloud-download:before {  content: '\e197';}.glyphicon-cloud-upload:before {  content: '\e198';}.glyphicon-tree-conifer:before {  content: '\e199';}.glyphicon-tree-deciduous:before {  content: '\e200';}.glyphicon-cd:before {  content: '\e201';}.glyphicon-save-file:before {  content: '\e202';}.glyphicon-open-file:before {  content: '\e203';}.glyphicon-level-up:before {  content: '\e204';}.glyphicon-copy:before {  content: '\e205';}.glyphicon-paste:before {  content: '\e206';}.glyphicon-alert:before {  content: '\e209';}.glyphicon-equalizer:before {  content: '\e210';}.glyphicon-king:before {  content: '\e211';}.glyphicon-queen:before {  content: '\e212';}.glyphicon-pawn:before {  content: '\e213';}.glyphicon-bishop:before {  content: '\e214';}.glyphicon-knight:before {  content: '\e215';}.glyphicon-baby-formula:before {  content: '\e216';}.glyphicon-tent:before {  content: '\26fa';}.glyphicon-blackboard:before {  content: '\e218';}.glyphicon-bed:before {  content: '\e219';}.glyphicon-apple:before {  content: '\f8ff';}.glyphicon-erase:before {  content: '\e221';}.glyphicon-hourglass:before {  content: '\231b';}.glyphicon-lamp:before {  content: '\e223';}.glyphicon-duplicate:before {  content: '\e224';}.glyphicon-piggy-bank:before {  content: '\e225';}.glyphicon-scissors:before {  content: '\e226';}.glyphicon-bitcoin:before {  content: '\e227';}.glyphicon-btc:before {  content: '\e227';}.glyphicon-xbt:before {  content: '\e227';}.glyphicon-yen:before {  content: '\00a5';}.glyphicon-jpy:before {  content: '\00a5';}.glyphicon-ruble:before {  content: '\20bd';}.glyphicon-rub:before {  content: '\20bd';}.glyphicon-scale:before {  content: '\e230';}.glyphicon-ice-lolly:before {  content: '\e231';}.glyphicon-ice-lolly-tasted:before {  content: '\e232';}.glyphicon-education:before {  content: '\e233';}.glyphicon-option-horizontal:before {  content: '\e234';}.glyphicon-option-vertical:before {  content: '\e235';}.glyphicon-menu-hamburger:before {  content: '\e236';}.glyphicon-modal-window:before {  content: '\e237';}.glyphicon-oil:before {  content: '\e238';}.glyphicon-grain:before {  content: '\e239';}.glyphicon-sunglasses:before {  content: '\e240';}.glyphicon-text-size:before {  content: '\e241';}.glyphicon-text-color:before {  content: '\e242';}.glyphicon-text-background:before {  content: '\e243';}.glyphicon-object-align-top:before {  content: '\e244';}.glyphicon-object-align-bottom:before {  content: '\e245';}.glyphicon-object-align-horizontal:before {  content: '\e246';}.glyphicon-object-align-left:before {  content: '\e247';}.glyphicon-object-align-vertical:before {  content: '\e248';}.glyphicon-object-align-right:before {  content: '\e249';}.glyphicon-triangle-right:before {  content: '\e250';}.glyphicon-triangle-left:before {  content: '\e251';}.glyphicon-triangle-bottom:before {  content: '\e252';}.glyphicon-triangle-top:before {  content: '\e253';}.glyphicon-console:before {  content: '\e254';}.glyphicon-superscript:before {  content: '\e255';}.glyphicon-subscript:before {  content: '\e256';}.glyphicon-menu-left:before {  content: '\e257';}.glyphicon-menu-right:before {  content: '\e258';}.glyphicon-menu-down:before {  content: '\e259';}.glyphicon-menu-up:before {  content: '\e260';}* {  -webkit-box-sizing: border-box;  -moz-box-sizing: border-box;  box-sizing: border-box;}*:before,*:after {  -webkit-box-sizing: border-box;  -moz-box-sizing: border-box;  box-sizing: border-box;}html {  font-size: 10px;  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);}body {  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;  font-size: 13px;  line-height: 1.42857143;  color: #000;  background-color: #fff;}input,button,select,textarea {  font-family: inherit;  font-size: inherit;  line-height: inherit;}a {  color: #337ab7;  text-decoration: none;}a:hover,a:focus {  color: #23527c;  text-decoration: underline;}a:focus {  outline: 5px auto -webkit-focus-ring-color;  outline-offset: -2px;}figure {  margin: 0;}img {  vertical-align: middle;}.img-responsive,.thumbnail > img,.thumbnail a > img,.carousel-inner > .item > img,.carousel-inner > .item > a > img {  display: block;  max-width: 100%;  height: auto;}.img-rounded {  border-radius: 3px;}.img-thumbnail {  padding: 4px;  line-height: 1.42857143;  background-color: #fff;  border: 1px solid #ddd;  border-radius: 2px;  -webkit-transition: all 0.2s ease-in-out;  -o-transition: all 0.2s ease-in-out;  transition: all 0.2s ease-in-out;  display: inline-block;  max-width: 100%;  height: auto;}.img-circle {  border-radius: 50%;}hr {  margin-top: 18px;  margin-bottom: 18px;  border: 0;  border-top: 1px solid #eeeeee;}.sr-only {  position: absolute;  width: 1px;  height: 1px;  margin: -1px;  padding: 0;  overflow: hidden;  clip: rect(0, 0, 0, 0);  border: 0;}.sr-only-focusable:active,.sr-only-focusable:focus {  position: static;  width: auto;  height: auto;  margin: 0;  overflow: visible;  clip: auto;}[role='button'] {  cursor: pointer;}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6 {  font-family: inherit;  font-weight: 500;  line-height: 1.1;  color: inherit;}h1 small,h2 small,h3 small,h4 small,h5 small,h6 small,.h1 small,.h2 small,.h3 small,.h4 small,.h5 small,.h6 small,h1 .small,h2 .small,h3 .small,h4 .small,h5 .small,h6 .small,.h1 .small,.h2 .small,.h3 .small,.h4 .small,.h5 .small,.h6 .small {  font-weight: normal;  line-height: 1;  color: #777777;}h1,.h1,h2,.h2,h3,.h3 {  margin-top: 18px;  margin-bottom: 9px;}h1 small,.h1 small,h2 small,.h2 small,h3 small,.h3 small,h1 .small,.h1 .small,h2 .small,.h2 .small,h3 .small,.h3 .small {  font-size: 65%;}h4,.h4,h5,.h5,h6,.h6 {  margin-top: 9px;  margin-bottom: 9px;}h4 small,.h4 small,h5 small,.h5 small,h6 small,.h6 small,h4 .small,.h4 .small,h5 .small,.h5 .small,h6 .small,.h6 .small {  font-size: 75%;}h1,.h1 {  font-size: 33px;}h2,.h2 {  font-size: 27px;}h3,.h3 {  font-size: 23px;}h4,.h4 {  font-size: 17px;}h5,.h5 {  font-size: 13px;}h6,.h6 {  font-size: 12px;}p {  margin: 0 0 9px;}.lead {  margin-bottom: 18px;  font-size: 14px;  font-weight: 300;  line-height: 1.4;}@media (min-width: 768px) {  .lead {    font-size: 19.5px;  }}small,.small {  font-size: 92%;}mark,.mark {  background-color: #fcf8e3;  padding: .2em;}.text-left {  text-align: left;}.text-right {  text-align: right;}.text-center {  text-align: center;}.text-justify {  text-align: justify;}.text-nowrap {  white-space: nowrap;}.text-lowercase {  text-transform: lowercase;}.text-uppercase {  text-transform: uppercase;}.text-capitalize {  text-transform: capitalize;}.text-muted {  color: #777777;}.text-primary {  color: #337ab7;}a.text-primary:hover,a.text-primary:focus {  color: #286090;}.text-success {  color: #3c763d;}a.text-success:hover,a.text-success:focus {  color: #2b542c;}.text-info {  color: #31708f;}a.text-info:hover,a.text-info:focus {  color: #245269;}.text-warning {  color: #8a6d3b;}a.text-warning:hover,a.text-warning:focus {  color: #66512c;}.text-danger {  color: #a94442;}a.text-danger:hover,a.text-danger:focus {  color: #843534;}.bg-primary {  color: #fff;  background-color: #337ab7;}a.bg-primary:hover,a.bg-primary:focus {  background-color: #286090;}.bg-success {  background-color: #dff0d8;}a.bg-success:hover,a.bg-success:focus {  background-color: #c1e2b3;}.bg-info {  background-color: #d9edf7;}a.bg-info:hover,a.bg-info:focus {  background-color: #afd9ee;}.bg-warning {  background-color: #fcf8e3;}a.bg-warning:hover,a.bg-warning:focus {  background-color: #f7ecb5;}.bg-danger {  background-color: #f2dede;}a.bg-danger:hover,a.bg-danger:focus {  background-color: #e4b9b9;}.page-header {  padding-bottom: 8px;  margin: 36px 0 18px;  border-bottom: 1px solid #eeeeee;}ul,ol {  margin-top: 0;  margin-bottom: 9px;}ul ul,ol ul,ul ol,ol ol {  margin-bottom: 0;}.list-unstyled {  padding-left: 0;  list-style: none;}.list-inline {  padding-left: 0;  list-style: none;  margin-left: -5px;}.list-inline > li {  display: inline-block;  padding-left: 5px;  padding-right: 5px;}dl {  margin-top: 0;  margin-bottom: 18px;}dt,dd {  line-height: 1.42857143;}dt {  font-weight: bold;}dd {  margin-left: 0;}@media (min-width: 541px) {  .dl-horizontal dt {    float: left;    width: 160px;    clear: left;    text-align: right;    overflow: hidden;    text-overflow: ellipsis;    white-space: nowrap;  }  .dl-horizontal dd {    margin-left: 180px;  }}abbr[title],abbr[data-original-title] {  cursor: help;  border-bottom: 1px dotted #777777;}.initialism {  font-size: 90%;  text-transform: uppercase;}blockquote {  padding: 9px 18px;  margin: 0 0 18px;  font-size: inherit;  border-left: 5px solid #eeeeee;}blockquote p:last-child,blockquote ul:last-child,blockquote ol:last-child {  margin-bottom: 0;}blockquote footer,blockquote small,blockquote .small {  display: block;  font-size: 80%;  line-height: 1.42857143;  color: #777777;}blockquote footer:before,blockquote small:before,blockquote .small:before {  content: '\2014 \00A0';}.blockquote-reverse,blockquote.pull-right {  padding-right: 15px;  padding-left: 0;  border-right: 5px solid #eeeeee;  border-left: 0;  text-align: right;}.blockquote-reverse footer:before,blockquote.pull-right footer:before,.blockquote-reverse small:before,blockquote.pull-right small:before,.blockquote-reverse .small:before,blockquote.pull-right .small:before {  content: '';}.blockquote-reverse footer:after,blockquote.pull-right footer:after,.blockquote-reverse small:after,blockquote.pull-right small:after,.blockquote-reverse .small:after,blockquote.pull-right .small:after {  content: '\00A0 \2014';}address {  margin-bottom: 18px;  font-style: normal;  line-height: 1.42857143;}code,kbd,pre,samp {  font-family: monospace;}code {  padding: 2px 4px;  font-size: 90%;  color: #c7254e;  background-color: #f9f2f4;  border-radius: 2px;}kbd {  padding: 2px 4px;  font-size: 90%;  color: #888;  background-color: transparent;  border-radius: 1px;  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);}kbd kbd {  padding: 0;  font-size: 100%;  font-weight: bold;  box-shadow: none;}pre {  display: block;  padding: 8.5px;  margin: 0 0 9px;  font-size: 12px;  line-height: 1.42857143;  word-break: break-all;  word-wrap: break-word;  color: #333333;  background-color: #f5f5f5;  border: 1px solid #ccc;  border-radius: 2px;}pre code {  padding: 0;  font-size: inherit;  color: inherit;  white-space: pre-wrap;  background-color: transparent;  border-radius: 0;}.pre-scrollable {  max-height: 340px;  overflow-y: scroll;}.container {  margin-right: auto;  margin-left: auto;  padding-left: 0px;  padding-right: 0px;}@media (min-width: 768px) {  .container {    width: 768px;  }}@media (min-width: 992px) {  .container {    width: 940px;  }}@media (min-width: 1200px) {  .container {    width: 1140px;  }}.container-fluid {  margin-right: auto;  margin-left: auto;  padding-left: 0px;  padding-right: 0px;}.row {  margin-left: 0px;  margin-right: 0px;}.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {  position: relative;  min-height: 1px;  padding-left: 0px;  padding-right: 0px;}.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {  float: left;}.col-xs-12 {  width: 100%;}.col-xs-11 {  width: 91.66666667%;}.col-xs-10 {  width: 83.33333333%;}.col-xs-9 {  width: 75%;}.col-xs-8 {  width: 66.66666667%;}.col-xs-7 {  width: 58.33333333%;}.col-xs-6 {  width: 50%;}.col-xs-5 {  width: 41.66666667%;}.col-xs-4 {  width: 33.33333333%;}.col-xs-3 {  width: 25%;}.col-xs-2 {  width: 16.66666667%;}.col-xs-1 {  width: 8.33333333%;}.col-xs-pull-12 {  right: 100%;}.col-xs-pull-11 {  right: 91.66666667%;}.col-xs-pull-10 {  right: 83.33333333%;}.col-xs-pull-9 {  right: 75%;}.col-xs-pull-8 {  right: 66.66666667%;}.col-xs-pull-7 {  right: 58.33333333%;}.col-xs-pull-6 {  right: 50%;}.col-xs-pull-5 {  right: 41.66666667%;}.col-xs-pull-4 {  right: 33.33333333%;}.col-xs-pull-3 {  right: 25%;}.col-xs-pull-2 {  right: 16.66666667%;}.col-xs-pull-1 {  right: 8.33333333%;}.col-xs-pull-0 {  right: auto;}.col-xs-push-12 {  left: 100%;}.col-xs-push-11 {  left: 91.66666667%;}.col-xs-push-10 {  left: 83.33333333%;}.col-xs-push-9 {  left: 75%;}.col-xs-push-8 {  left: 66.66666667%;}.col-xs-push-7 {  left: 58.33333333%;}.col-xs-push-6 {  left: 50%;}.col-xs-push-5 {  left: 41.66666667%;}.col-xs-push-4 {  left: 33.33333333%;}.col-xs-push-3 {  left: 25%;}.col-xs-push-2 {  left: 16.66666667%;}.col-xs-push-1 {  left: 8.33333333%;}.col-xs-push-0 {  left: auto;}.col-xs-offset-12 {  margin-left: 100%;}.col-xs-offset-11 {  margin-left: 91.66666667%;}.col-xs-offset-10 {  margin-left: 83.33333333%;}.col-xs-offset-9 {  margin-left: 75%;}.col-xs-offset-8 {  margin-left: 66.66666667%;}.col-xs-offset-7 {  margin-left: 58.33333333%;}.col-xs-offset-6 {  margin-left: 50%;}.col-xs-offset-5 {  margin-left: 41.66666667%;}.col-xs-offset-4 {  margin-left: 33.33333333%;}.col-xs-offset-3 {  margin-left: 25%;}.col-xs-offset-2 {  margin-left: 16.66666667%;}.col-xs-offset-1 {  margin-left: 8.33333333%;}.col-xs-offset-0 {  margin-left: 0%;}@media (min-width: 768px) {  .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12 {    float: left;  }  .col-sm-12 {    width: 100%;  }  .col-sm-11 {    width: 91.66666667%;  }  .col-sm-10 {    width: 83.33333333%;  }  .col-sm-9 {    width: 75%;  }  .col-sm-8 {    width: 66.66666667%;  }  .col-sm-7 {    width: 58.33333333%;  }  .col-sm-6 {    width: 50%;  }  .col-sm-5 {    width: 41.66666667%;  }  .col-sm-4 {    width: 33.33333333%;  }  .col-sm-3 {    width: 25%;  }  .col-sm-2 {    width: 16.66666667%;  }  .col-sm-1 {    width: 8.33333333%;  }  .col-sm-pull-12 {    right: 100%;  }  .col-sm-pull-11 {    right: 91.66666667%;  }  .col-sm-pull-10 {    right: 83.33333333%;  }  .col-sm-pull-9 {    right: 75%;  }  .col-sm-pull-8 {    right: 66.66666667%;  }  .col-sm-pull-7 {    right: 58.33333333%;  }  .col-sm-pull-6 {    right: 50%;  }  .col-sm-pull-5 {    right: 41.66666667%;  }  .col-sm-pull-4 {    right: 33.33333333%;  }  .col-sm-pull-3 {    right: 25%;  }  .col-sm-pull-2 {    right: 16.66666667%;  }  .col-sm-pull-1 {    right: 8.33333333%;  }  .col-sm-pull-0 {    right: auto;  }  .col-sm-push-12 {    left: 100%;  }  .col-sm-push-11 {    left: 91.66666667%;  }  .col-sm-push-10 {    left: 83.33333333%;  }  .col-sm-push-9 {    left: 75%;  }  .col-sm-push-8 {    left: 66.66666667%;  }  .col-sm-push-7 {    left: 58.33333333%;  }  .col-sm-push-6 {    left: 50%;  }  .col-sm-push-5 {    left: 41.66666667%;  }  .col-sm-push-4 {    left: 33.33333333%;  }  .col-sm-push-3 {    left: 25%;  }  .col-sm-push-2 {    left: 16.66666667%;  }  .col-sm-push-1 {    left: 8.33333333%;  }  .col-sm-push-0 {    left: auto;  }  .col-sm-offset-12 {    margin-left: 100%;  }  .col-sm-offset-11 {    margin-left: 91.66666667%;  }  .col-sm-offset-10 {    margin-left: 83.33333333%;  }  .col-sm-offset-9 {    margin-left: 75%;  }  .col-sm-offset-8 {    margin-left: 66.66666667%;  }  .col-sm-offset-7 {    margin-left: 58.33333333%;  }  .col-sm-offset-6 {    margin-left: 50%;  }  .col-sm-offset-5 {    margin-left: 41.66666667%;  }  .col-sm-offset-4 {    margin-left: 33.33333333%;  }  .col-sm-offset-3 {    margin-left: 25%;  }  .col-sm-offset-2 {    margin-left: 16.66666667%;  }  .col-sm-offset-1 {    margin-left: 8.33333333%;  }  .col-sm-offset-0 {    margin-left: 0%;  }}@media (min-width: 992px) {  .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12 {    float: left;  }  .col-md-12 {    width: 100%;  }  .col-md-11 {    width: 91.66666667%;  }  .col-md-10 {    width: 83.33333333%;  }  .col-md-9 {    width: 75%;  }  .col-md-8 {    width: 66.66666667%;  }  .col-md-7 {    width: 58.33333333%;  }  .col-md-6 {    width: 50%;  }  .col-md-5 {    width: 41.66666667%;  }  .col-md-4 {    width: 33.33333333%;  }  .col-md-3 {    width: 25%;  }  .col-md-2 {    width: 16.66666667%;  }  .col-md-1 {    width: 8.33333333%;  }  .col-md-pull-12 {    right: 100%;  }  .col-md-pull-11 {    right: 91.66666667%;  }  .col-md-pull-10 {    right: 83.33333333%;  }  .col-md-pull-9 {    right: 75%;  }  .col-md-pull-8 {    right: 66.66666667%;  }  .col-md-pull-7 {    right: 58.33333333%;  }  .col-md-pull-6 {    right: 50%;  }  .col-md-pull-5 {    right: 41.66666667%;  }  .col-md-pull-4 {    right: 33.33333333%;  }  .col-md-pull-3 {    right: 25%;  }  .col-md-pull-2 {    right: 16.66666667%;  }  .col-md-pull-1 {    right: 8.33333333%;  }  .col-md-pull-0 {    right: auto;  }  .col-md-push-12 {    left: 100%;  }  .col-md-push-11 {    left: 91.66666667%;  }  .col-md-push-10 {    left: 83.33333333%;  }  .col-md-push-9 {    left: 75%;  }  .col-md-push-8 {    left: 66.66666667%;  }  .col-md-push-7 {    left: 58.33333333%;  }  .col-md-push-6 {    left: 50%;  }  .col-md-push-5 {    left: 41.66666667%;  }  .col-md-push-4 {    left: 33.33333333%;  }  .col-md-push-3 {    left: 25%;  }  .col-md-push-2 {    left: 16.66666667%;  }  .col-md-push-1 {    left: 8.33333333%;  }  .col-md-push-0 {    left: auto;  }  .col-md-offset-12 {    margin-left: 100%;  }  .col-md-offset-11 {    margin-left: 91.66666667%;  }  .col-md-offset-10 {    margin-left: 83.33333333%;  }  .col-md-offset-9 {    margin-left: 75%;  }  .col-md-offset-8 {    margin-left: 66.66666667%;  }  .col-md-offset-7 {    margin-left: 58.33333333%;  }  .col-md-offset-6 {    margin-left: 50%;  }  .col-md-offset-5 {    margin-left: 41.66666667%;  }  .col-md-offset-4 {    margin-left: 33.33333333%;  }  .col-md-offset-3 {    margin-left: 25%;  }  .col-md-offset-2 {    margin-left: 16.66666667%;  }  .col-md-offset-1 {    margin-left: 8.33333333%;  }  .col-md-offset-0 {    margin-left: 0%;  }}@media (min-width: 1200px) {  .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12 {    float: left;  }  .col-lg-12 {    width: 100%;  }  .col-lg-11 {    width: 91.66666667%;  }  .col-lg-10 {    width: 83.33333333%;  }  .col-lg-9 {    width: 75%;  }  .col-lg-8 {    width: 66.66666667%;  }  .col-lg-7 {    width: 58.33333333%;  }  .col-lg-6 {    width: 50%;  }  .col-lg-5 {    width: 41.66666667%;  }  .col-lg-4 {    width: 33.33333333%;  }  .col-lg-3 {    width: 25%;  }  .col-lg-2 {    width: 16.66666667%;  }  .col-lg-1 {    width: 8.33333333%;  }  .col-lg-pull-12 {    right: 100%;  }  .col-lg-pull-11 {    right: 91.66666667%;  }  .col-lg-pull-10 {    right: 83.33333333%;  }  .col-lg-pull-9 {    right: 75%;  }  .col-lg-pull-8 {    right: 66.66666667%;  }  .col-lg-pull-7 {    right: 58.33333333%;  }  .col-lg-pull-6 {    right: 50%;  }  .col-lg-pull-5 {    right: 41.66666667%;  }  .col-lg-pull-4 {    right: 33.33333333%;  }  .col-lg-pull-3 {    right: 25%;  }  .col-lg-pull-2 {    right: 16.66666667%;  }  .col-lg-pull-1 {    right: 8.33333333%;  }  .col-lg-pull-0 {    right: auto;  }  .col-lg-push-12 {    left: 100%;  }  .col-lg-push-11 {    left: 91.66666667%;  }  .col-lg-push-10 {    left: 83.33333333%;  }  .col-lg-push-9 {    left: 75%;  }  .col-lg-push-8 {    left: 66.66666667%;  }  .col-lg-push-7 {    left: 58.33333333%;  }  .col-lg-push-6 {    left: 50%;  }  .col-lg-push-5 {    left: 41.66666667%;  }  .col-lg-push-4 {    left: 33.33333333%;  }  .col-lg-push-3 {    left: 25%;  }  .col-lg-push-2 {    left: 16.66666667%;  }  .col-lg-push-1 {    left: 8.33333333%;  }  .col-lg-push-0 {    left: auto;  }  .col-lg-offset-12 {    margin-left: 100%;  }  .col-lg-offset-11 {    margin-left: 91.66666667%;  }  .col-lg-offset-10 {    margin-left: 83.33333333%;  }  .col-lg-offset-9 {    margin-left: 75%;  }  .col-lg-offset-8 {    margin-left: 66.66666667%;  }  .col-lg-offset-7 {    margin-left: 58.33333333%;  }  .col-lg-offset-6 {    margin-left: 50%;  }  .col-lg-offset-5 {    margin-left: 41.66666667%;  }  .col-lg-offset-4 {    margin-left: 33.33333333%;  }  .col-lg-offset-3 {    margin-left: 25%;  }  .col-lg-offset-2 {    margin-left: 16.66666667%;  }  .col-lg-offset-1 {    margin-left: 8.33333333%;  }  .col-lg-offset-0 {    margin-left: 0%;  }}table {  background-color: transparent;}caption {  padding-top: 8px;  padding-bottom: 8px;  color: #777777;  text-align: left;}th {  text-align: left;}.table {  width: 100%;  max-width: 100%;  margin-bottom: 18px;}.table > thead > tr > th,.table > tbody > tr > th,.table > tfoot > tr > th,.table > thead > tr > td,.table > tbody > tr > td,.table > tfoot > tr > td {  padding: 8px;  line-height: 1.42857143;  vertical-align: top;  border-top: 1px solid #ddd;}.table > thead > tr > th {  vertical-align: bottom;  border-bottom: 2px solid #ddd;}.table > caption + thead > tr:first-child > th,.table > colgroup + thead > tr:first-child > th,.table > thead:first-child > tr:first-child > th,.table > caption + thead > tr:first-child > td,.table > colgroup + thead > tr:first-child > td,.table > thead:first-child > tr:first-child > td {  border-top: 0;}.table > tbody + tbody {  border-top: 2px solid #ddd;}.table .table {  background-color: #fff;}.table-condensed > thead > tr > th,.table-condensed > tbody > tr > th,.table-condensed > tfoot > tr > th,.table-condensed > thead > tr > td,.table-condensed > tbody > tr > td,.table-condensed > tfoot > tr > td {  padding: 5px;}.table-bordered {  border: 1px solid #ddd;}.table-bordered > thead > tr > th,.table-bordered > tbody > tr > th,.table-bordered > tfoot > tr > th,.table-bordered > thead > tr > td,.table-bordered > tbody > tr > td,.table-bordered > tfoot > tr > td {  border: 1px solid #ddd;}.table-bordered > thead > tr > th,.table-bordered > thead > tr > td {  border-bottom-width: 2px;}.table-striped > tbody > tr:nth-of-type(odd) {  background-color: #f9f9f9;}.table-hover > tbody > tr:hover {  background-color: #f5f5f5;}table col[class*='col-'] {  position: static;  float: none;  display: table-column;}table td[class*='col-'],table th[class*='col-'] {  position: static;  float: none;  display: table-cell;}.table > thead > tr > td.active,.table > tbody > tr > td.active,.table > tfoot > tr > td.active,.table > thead > tr > th.active,.table > tbody > tr > th.active,.table > tfoot > tr > th.active,.table > thead > tr.active > td,.table > tbody > tr.active > td,.table > tfoot > tr.active > td,.table > thead > tr.active > th,.table > tbody > tr.active > th,.table > tfoot > tr.active > th {  background-color: #f5f5f5;}.table-hover > tbody > tr > td.active:hover,.table-hover > tbody > tr > th.active:hover,.table-hover > tbody > tr.active:hover > td,.table-hover > tbody > tr:hover > .active,.table-hover > tbody > tr.active:hover > th {  background-color: #e8e8e8;}.table > thead > tr > td.success,.table > tbody > tr > td.success,.table > tfoot > tr > td.success,.table > thead > tr > th.success,.table > tbody > tr > th.success,.table > tfoot > tr > th.success,.table > thead > tr.success > td,.table > tbody > tr.success > td,.table > tfoot > tr.success > td,.table > thead > tr.success > th,.table > tbody > tr.success > th,.table > tfoot > tr.success > th {  background-color: #dff0d8;}.table-hover > tbody > tr > td.success:hover,.table-hover > tbody > tr > th.success:hover,.table-hover > tbody > tr.success:hover > td,.table-hover > tbody > tr:hover > .success,.table-hover > tbody > tr.success:hover > th {  background-color: #d0e9c6;}.table > thead > tr > td.info,.table > tbody > tr > td.info,.table > tfoot > tr > td.info,.table > thead > tr > th.info,.table > tbody > tr > th.info,.table > tfoot > tr > th.info,.table > thead > tr.info > td,.table > tbody > tr.info > td,.table > tfoot > tr.info > td,.table > thead > tr.info > th,.table > tbody > tr.info > th,.table > tfoot > tr.info > th {  background-color: #d9edf7;}.table-hover > tbody > tr > td.info:hover,.table-hover > tbody > tr > th.info:hover,.table-hover > tbody > tr.info:hover > td,.table-hover > tbody > tr:hover > .info,.table-hover > tbody > tr.info:hover > th {  background-color: #c4e3f3;}.table > thead > tr > td.warning,.table > tbody > tr > td.warning,.table > tfoot > tr > td.warning,.table > thead > tr > th.warning,.table > tbody > tr > th.warning,.table > tfoot > tr > th.warning,.table > thead > tr.warning > td,.table > tbody > tr.warning > td,.table > tfoot > tr.warning > td,.table > thead > tr.warning > th,.table > tbody > tr.warning > th,.table > tfoot > tr.warning > th {  background-color: #fcf8e3;}.table-hover > tbody > tr > td.warning:hover,.table-hover > tbody > tr > th.warning:hover,.table-hover > tbody > tr.warning:hover > td,.table-hover > tbody > tr:hover > .warning,.table-hover > tbody > tr.warning:hover > th {  background-color: #faf2cc;}.table > thead > tr > td.danger,.table > tbody > tr > td.danger,.table > tfoot > tr > td.danger,.table > thead > tr > th.danger,.table > tbody > tr > th.danger,.table > tfoot > tr > th.danger,.table > thead > tr.danger > td,.table > tbody > tr.danger > td,.table > tfoot > tr.danger > td,.table > thead > tr.danger > th,.table > tbody > tr.danger > th,.table > tfoot > tr.danger > th {  background-color: #f2dede;}.table-hover > tbody > tr > td.danger:hover,.table-hover > tbody > tr > th.danger:hover,.table-hover > tbody > tr.danger:hover > td,.table-hover > tbody > tr:hover > .danger,.table-hover > tbody > tr.danger:hover > th {  background-color: #ebcccc;}.table-responsive {  overflow-x: auto;  min-height: 0.01%;}@media screen and (max-width: 767px) {  .table-responsive {    width: 100%;    margin-bottom: 13.5px;    overflow-y: hidden;    -ms-overflow-style: -ms-autohiding-scrollbar;    border: 1px solid #ddd;  }  .table-responsive > .table {    margin-bottom: 0;  }  .table-responsive > .table > thead > tr > th,  .table-responsive > .table > tbody > tr > th,  .table-responsive > .table > tfoot > tr > th,  .table-responsive > .table > thead > tr > td,  .table-responsive > .table > tbody > tr > td,  .table-responsive > .table > tfoot > tr > td {    white-space: nowrap;  }  .table-responsive > .table-bordered {    border: 0;  }  .table-responsive > .table-bordered > thead > tr > th:first-child,  .table-responsive > .table-bordered > tbody > tr > th:first-child,  .table-responsive > .table-bordered > tfoot > tr > th:first-child,  .table-responsive > .table-bordered > thead > tr > td:first-child,  .table-responsive > .table-bordered > tbody > tr > td:first-child,  .table-responsive > .table-bordered > tfoot > tr > td:first-child {    border-left: 0;  }  .table-responsive > .table-bordered > thead > tr > th:last-child,  .table-responsive > .table-bordered > tbody > tr > th:last-child,  .table-responsive > .table-bordered > tfoot > tr > th:last-child,  .table-responsive > .table-bordered > thead > tr > td:last-child,  .table-responsive > .table-bordered > tbody > tr > td:last-child,  .table-responsive > .table-bordered > tfoot > tr > td:last-child {    border-right: 0;  }  .table-responsive > .table-bordered > tbody > tr:last-child > th,  .table-responsive > .table-bordered > tfoot > tr:last-child > th,  .table-responsive > .table-bordered > tbody > tr:last-child > td,  .table-responsive > .table-bordered > tfoot > tr:last-child > td {    border-bottom: 0;  }}fieldset {  padding: 0;  margin: 0;  border: 0;  min-width: 0;}legend {  display: block;  width: 100%;  padding: 0;  margin-bottom: 18px;  font-size: 19.5px;  line-height: inherit;  color: #333333;  border: 0;  border-bottom: 1px solid #e5e5e5;}label {  display: inline-block;  max-width: 100%;  margin-bottom: 5px;  font-weight: bold;}input[type='search'] {  -webkit-box-sizing: border-box;  -moz-box-sizing: border-box;  box-sizing: border-box;}input[type='radio'],input[type='checkbox'] {  margin: 4px 0 0;  margin-top: 1px \9;  line-height: normal;}input[type='file'] {  display: block;}input[type='range'] {  display: block;  width: 100%;}select[multiple],select[size] {  height: auto;}input[type='file']:focus,input[type='radio']:focus,input[type='checkbox']:focus {  outline: 5px auto -webkit-focus-ring-color;  outline-offset: -2px;}output {  display: block;  padding-top: 7px;  font-size: 13px;  line-height: 1.42857143;  color: #555555;}.form-control {  display: block;  width: 100%;  height: 32px;  padding: 6px 12px;  font-size: 13px;  line-height: 1.42857143;  color: #555555;  background-color: #fff;  background-image: none;  border: 1px solid #ccc;  border-radius: 2px;  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;}.form-control:focus {  border-color: #66afe9;  outline: 0;  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);}.form-control::-moz-placeholder {  color: #999;  opacity: 1;}.form-control:-ms-input-placeholder {  color: #999;}.form-control::-webkit-input-placeholder {  color: #999;}.form-control::-ms-expand {  border: 0;  background-color: transparent;}.form-control[disabled],.form-control[readonly],fieldset[disabled] .form-control {  background-color: #eeeeee;  opacity: 1;}.form-control[disabled],fieldset[disabled] .form-control {  cursor: not-allowed;}textarea.form-control {  height: auto;}input[type='search'] {  -webkit-appearance: none;}@media screen and (-webkit-min-device-pixel-ratio: 0) {  input[type='date'].form-control,  input[type='time'].form-control,  input[type='datetime-local'].form-control,  input[type='month'].form-control {    line-height: 32px;  }  input[type='date'].input-sm,  input[type='time'].input-sm,  input[type='datetime-local'].input-sm,  input[type='month'].input-sm,  .input-group-sm input[type='date'],  .input-group-sm input[type='time'],  .input-group-sm input[type='datetime-local'],  .input-group-sm input[type='month'] {    line-height: 30px;  }  input[type='date'].input-lg,  input[type='time'].input-lg,  input[type='datetime-local'].input-lg,  input[type='month'].input-lg,  .input-group-lg input[type='date'],  .input-group-lg input[type='time'],  .input-group-lg input[type='datetime-local'],  .input-group-lg input[type='month'] {    line-height: 45px;  }}.form-group {  margin-bottom: 15px;}.radio,.checkbox {  position: relative;  display: block;  margin-top: 10px;  margin-bottom: 10px;}.radio label,.checkbox label {  min-height: 18px;  padding-left: 20px;  margin-bottom: 0;  font-weight: normal;  cursor: pointer;}.radio input[type='radio'],.radio-inline input[type='radio'],.checkbox input[type='checkbox'],.checkbox-inline input[type='checkbox'] {  position: absolute;  margin-left: -20px;  margin-top: 4px \9;}.radio + .radio,.checkbox + .checkbox {  margin-top: -5px;}.radio-inline,.checkbox-inline {  position: relative;  display: inline-block;  padding-left: 20px;  margin-bottom: 0;  vertical-align: middle;  font-weight: normal;  cursor: pointer;}.radio-inline + .radio-inline,.checkbox-inline + .checkbox-inline {  margin-top: 0;  margin-left: 10px;}input[type='radio'][disabled],input[type='checkbox'][disabled],input[type='radio'].disabled,input[type='checkbox'].disabled,fieldset[disabled] input[type='radio'],fieldset[disabled] input[type='checkbox'] {  cursor: not-allowed;}.radio-inline.disabled,.checkbox-inline.disabled,fieldset[disabled] .radio-inline,fieldset[disabled] .checkbox-inline {  cursor: not-allowed;}.radio.disabled label,.checkbox.disabled label,fieldset[disabled] .radio label,fieldset[disabled] .checkbox label {  cursor: not-allowed;}.form-control-static {  padding-top: 7px;  padding-bottom: 7px;  margin-bottom: 0;  min-height: 31px;}.form-control-static.input-lg,.form-control-static.input-sm {  padding-left: 0;  padding-right: 0;}.input-sm {  height: 30px;  padding: 5px 10px;  font-size: 12px;  line-height: 1.5;  border-radius: 1px;}select.input-sm {  height: 30px;  line-height: 30px;}textarea.input-sm,select[multiple].input-sm {  height: auto;}.form-group-sm .form-control {  height: 30px;  padding: 5px 10px;  font-size: 12px;  line-height: 1.5;  border-radius: 1px;}.form-group-sm select.form-control {  height: 30px;  line-height: 30px;}.form-group-sm textarea.form-control,.form-group-sm select[multiple].form-control {  height: auto;}.form-group-sm .form-control-static {  height: 30px;  min-height: 30px;  padding: 6px 10px;  font-size: 12px;  line-height: 1.5;}.input-lg {  height: 45px;  padding: 10px 16px;  font-size: 17px;  line-height: 1.3333333;  border-radius: 3px;}select.input-lg {  height: 45px;  line-height: 45px;}textarea.input-lg,select[multiple].input-lg {  height: auto;}.form-group-lg .form-control {  height: 45px;  padding: 10px 16px;  font-size: 17px;  line-height: 1.3333333;  border-radius: 3px;}.form-group-lg select.form-control {  height: 45px;  line-height: 45px;}.form-group-lg textarea.form-control,.form-group-lg select[multiple].form-control {  height: auto;}.form-group-lg .form-control-static {  height: 45px;  min-height: 35px;  padding: 11px 16px;  font-size: 17px;  line-height: 1.3333333;}.has-feedback {  position: relative;}.has-feedback .form-control {  padding-right: 40px;}.form-control-feedback {  position: absolute;  top: 0;  right: 0;  z-index: 2;  display: block;  width: 32px;  height: 32px;  line-height: 32px;  text-align: center;  pointer-events: none;}.input-lg + .form-control-feedback,.input-group-lg + .form-control-feedback,.form-group-lg .form-control + .form-control-feedback {  width: 45px;  height: 45px;  line-height: 45px;}.input-sm + .form-control-feedback,.input-group-sm + .form-control-feedback,.form-group-sm .form-control + .form-control-feedback {  width: 30px;  height: 30px;  line-height: 30px;}.has-success .help-block,.has-success .control-label,.has-success .radio,.has-success .checkbox,.has-success .radio-inline,.has-success .checkbox-inline,.has-success.radio label,.has-success.checkbox label,.has-success.radio-inline label,.has-success.checkbox-inline label {  color: #3c763d;}.has-success .form-control {  border-color: #3c763d;  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);}.has-success .form-control:focus {  border-color: #2b542c;  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;}.has-success .input-group-addon {  color: #3c763d;  border-color: #3c763d;  background-color: #dff0d8;}.has-success .form-control-feedback {  color: #3c763d;}.has-warning .help-block,.has-warning .control-label,.has-warning .radio,.has-warning .checkbox,.has-warning .radio-inline,.has-warning .checkbox-inline,.has-warning.radio label,.has-warning.checkbox label,.has-warning.radio-inline label,.has-warning.checkbox-inline label {  color: #8a6d3b;}.has-warning .form-control {  border-color: #8a6d3b;  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);}.has-warning .form-control:focus {  border-color: #66512c;  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;}.has-warning .input-group-addon {  color: #8a6d3b;  border-color: #8a6d3b;  background-color: #fcf8e3;}.has-warning .form-control-feedback {  color: #8a6d3b;}.has-error .help-block,.has-error .control-label,.has-error .radio,.has-error .checkbox,.has-error .radio-inline,.has-error .checkbox-inline,.has-error.radio label,.has-error.checkbox label,.has-error.radio-inline label,.has-error.checkbox-inline label {  color: #a94442;}.has-error .form-control {  border-color: #a94442;  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);}.has-error .form-control:focus {  border-color: #843534;  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;}.has-error .input-group-addon {  color: #a94442;  border-color: #a94442;  background-color: #f2dede;}.has-error .form-control-feedback {  color: #a94442;}.has-feedback label ~ .form-control-feedback {  top: 23px;}.has-feedback label.sr-only ~ .form-control-feedback {  top: 0;}.help-block {  display: block;  margin-top: 5px;  margin-bottom: 10px;  color: #404040;}@media (min-width: 768px) {  .form-inline .form-group {    display: inline-block;    margin-bottom: 0;    vertical-align: middle;  }  .form-inline .form-control {    display: inline-block;    width: auto;    vertical-align: middle;  }  .form-inline .form-control-static {    display: inline-block;  }  .form-inline .input-group {    display: inline-table;    vertical-align: middle;  }  .form-inline .input-group .input-group-addon,  .form-inline .input-group .input-group-btn,  .form-inline .input-group .form-control {    width: auto;  }  .form-inline .input-group > .form-control {    width: 100%;  }  .form-inline .control-label {    margin-bottom: 0;    vertical-align: middle;  }  .form-inline .radio,  .form-inline .checkbox {    display: inline-block;    margin-top: 0;    margin-bottom: 0;    vertical-align: middle;  }  .form-inline .radio label,  .form-inline .checkbox label {    padding-left: 0;  }  .form-inline .radio input[type='radio'],  .form-inline .checkbox input[type='checkbox'] {    position: relative;    margin-left: 0;  }  .form-inline .has-feedback .form-control-feedback {    top: 0;  }}.form-horizontal .radio,.form-horizontal .checkbox,.form-horizontal .radio-inline,.form-horizontal .checkbox-inline {  margin-top: 0;  margin-bottom: 0;  padding-top: 7px;}.form-horizontal .radio,.form-horizontal .checkbox {  min-height: 25px;}.form-horizontal .form-group {  margin-left: 0px;  margin-right: 0px;}@media (min-width: 768px) {  .form-horizontal .control-label {    text-align: right;    margin-bottom: 0;    padding-top: 7px;  }}.form-horizontal .has-feedback .form-control-feedback {  right: 0px;}@media (min-width: 768px) {  .form-horizontal .form-group-lg .control-label {    padding-top: 11px;    font-size: 17px;  }}@media (min-width: 768px) {  .form-horizontal .form-group-sm .control-label {    padding-top: 6px;    font-size: 12px;  }}.btn {  display: inline-block;  margin-bottom: 0;  font-weight: normal;  text-align: center;  vertical-align: middle;  touch-action: manipulation;  cursor: pointer;  background-image: none;  border: 1px solid transparent;  white-space: nowrap;  padding: 6px 12px;  font-size: 13px;  line-height: 1.42857143;  border-radius: 2px;  -webkit-user-select: none;  -moz-user-select: none;  -ms-user-select: none;  user-select: none;}.btn:focus,.btn:active:focus,.btn.active:focus,.btn.focus,.btn:active.focus,.btn.active.focus {  outline: 5px auto -webkit-focus-ring-color;  outline-offset: -2px;}.btn:hover,.btn:focus,.btn.focus {  color: #333;  text-decoration: none;}.btn:active,.btn.active {  outline: 0;  background-image: none;  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);}.btn.disabled,.btn[disabled],fieldset[disabled] .btn {  cursor: not-allowed;  opacity: 0.65;  filter: alpha(opacity=65);  -webkit-box-shadow: none;  box-shadow: none;}a.btn.disabled,fieldset[disabled] a.btn {  pointer-events: none;}.btn-default {  color: #333;  background-color: #fff;  border-color: #ccc;}.btn-default:focus,.btn-default.focus {  color: #333;  background-color: #e6e6e6;  border-color: #8c8c8c;}.btn-default:hover {  color: #333;  background-color: #e6e6e6;  border-color: #adadad;}.btn-default:active,.btn-default.active,.open > .dropdown-toggle.btn-default {  color: #333;  background-color: #e6e6e6;  border-color: #adadad;}.btn-default:active:hover,.btn-default.active:hover,.open > .dropdown-toggle.btn-default:hover,.btn-default:active:focus,.btn-default.active:focus,.open > .dropdown-toggle.btn-default:focus,.btn-default:active.focus,.btn-default.active.focus,.open > .dropdown-toggle.btn-default.focus {  color: #333;  background-color: #d4d4d4;  border-color: #8c8c8c;}.btn-default:active,.btn-default.active,.open > .dropdown-toggle.btn-default {  background-image: none;}.btn-default.disabled:hover,.btn-default[disabled]:hover,fieldset[disabled] .btn-default:hover,.btn-default.disabled:focus,.btn-default[disabled]:focus,fieldset[disabled] .btn-default:focus,.btn-default.disabled.focus,.btn-default[disabled].focus,fieldset[disabled] .btn-default.focus {  background-color: #fff;  border-color: #ccc;}.btn-default .badge {  color: #fff;  background-color: #333;}.btn-primary {  color: #fff;  background-color: #337ab7;  border-color: #2e6da4;}.btn-primary:focus,.btn-primary.focus {  color: #fff;  background-color: #286090;  border-color: #122b40;}.btn-primary:hover {  color: #fff;  background-color: #286090;  border-color: #204d74;}.btn-primary:active,.btn-primary.active,.open > .dropdown-toggle.btn-primary {  color: #fff;  background-color: #286090;  border-color: #204d74;}.btn-primary:active:hover,.btn-primary.active:hover,.open > .dropdown-toggle.btn-primary:hover,.btn-primary:active:focus,.btn-primary.active:focus,.open > .dropdown-toggle.btn-primary:focus,.btn-primary:active.focus,.btn-primary.active.focus,.open > .dropdown-toggle.btn-primary.focus {  color: #fff;  background-color: #204d74;  border-color: #122b40;}.btn-primary:active,.btn-primary.active,.open > .dropdown-toggle.btn-primary {  background-image: none;}.btn-primary.disabled:hover,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary:hover,.btn-primary.disabled:focus,.btn-primary[disabled]:focus,fieldset[disabled] .btn-primary:focus,.btn-primary.disabled.focus,.btn-primary[disabled].focus,fieldset[disabled] .btn-primary.focus {  background-color: #337ab7;  border-color: #2e6da4;}.btn-primary .badge {  color: #337ab7;  background-color: #fff;}.btn-success {  color: #fff;  background-color: #5cb85c;  border-color: #4cae4c;}.btn-success:focus,.btn-success.focus {  color: #fff;  background-color: #449d44;  border-color: #255625;}.btn-success:hover {  color: #fff;  background-color: #449d44;  border-color: #398439;}.btn-success:active,.btn-success.active,.open > .dropdown-toggle.btn-success {  color: #fff;  background-color: #449d44;  border-color: #398439;}.btn-success:active:hover,.btn-success.active:hover,.open > .dropdown-toggle.btn-success:hover,.btn-success:active:focus,.btn-success.active:focus,.open > .dropdown-toggle.btn-success:focus,.btn-success:active.focus,.btn-success.active.focus,.open > .dropdown-toggle.btn-success.focus {  color: #fff;  background-color: #398439;  border-color: #255625;}.btn-success:active,.btn-success.active,.open > .dropdown-toggle.btn-success {  background-image: none;}.btn-success.disabled:hover,.btn-success[disabled]:hover,fieldset[disabled] .btn-success:hover,.btn-success.disabled:focus,.btn-success[disabled]:focus,fieldset[disabled] .btn-success:focus,.btn-success.disabled.focus,.btn-success[disabled].focus,fieldset[disabled] .btn-success.focus {  background-color: #5cb85c;  border-color: #4cae4c;}.btn-success .badge {  color: #5cb85c;  background-color: #fff;}.btn-info {  color: #fff;  background-color: #5bc0de;  border-color: #46b8da;}.btn-info:focus,.btn-info.focus {  color: #fff;  background-color: #31b0d5;  border-color: #1b6d85;}.btn-info:hover {  color: #fff;  background-color: #31b0d5;  border-color: #269abc;}.btn-info:active,.btn-info.active,.open > .dropdown-toggle.btn-info {  color: #fff;  background-color: #31b0d5;  border-color: #269abc;}.btn-info:active:hover,.btn-info.active:hover,.open > .dropdown-toggle.btn-info:hover,.btn-info:active:focus,.btn-info.active:focus,.open > .dropdown-toggle.btn-info:focus,.btn-info:active.focus,.btn-info.active.focus,.open > .dropdown-toggle.btn-info.focus {  color: #fff;  background-color: #269abc;  border-color: #1b6d85;}.btn-info:active,.btn-info.active,.open > .dropdown-toggle.btn-info {  background-image: none;}.btn-info.disabled:hover,.btn-info[disabled]:hover,fieldset[disabled] .btn-info:hover,.btn-info.disabled:focus,.btn-info[disabled]:focus,fieldset[disabled] .btn-info:focus,.btn-info.disabled.focus,.btn-info[disabled].focus,fieldset[disabled] .btn-info.focus {  background-color: #5bc0de;  border-color: #46b8da;}.btn-info .badge {  color: #5bc0de;  background-color: #fff;}.btn-warning {  color: #fff;  background-color: #f0ad4e;  border-color: #eea236;}.btn-warning:focus,.btn-warning.focus {  color: #fff;  background-color: #ec971f;  border-color: #985f0d;}.btn-warning:hover {  color: #fff;  background-color: #ec971f;  border-color: #d58512;}.btn-warning:active,.btn-warning.active,.open > .dropdown-toggle.btn-warning {  color: #fff;  background-color: #ec971f;  border-color: #d58512;}.btn-warning:active:hover,.btn-warning.active:hover,.open > .dropdown-toggle.btn-warning:hover,.btn-warning:active:focus,.btn-warning.active:focus,.open > .dropdown-toggle.btn-warning:focus,.btn-warning:active.focus,.btn-warning.active.focus,.open > .dropdown-toggle.btn-warning.focus {  color: #fff;  background-color: #d58512;  border-color: #985f0d;}.btn-warning:active,.btn-warning.active,.open > .dropdown-toggle.btn-warning {  background-image: none;}.btn-warning.disabled:hover,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning:hover,.btn-warning.disabled:focus,.btn-warning[disabled]:focus,fieldset[disabled] .btn-warning:focus,.btn-warning.disabled.focus,.btn-warning[disabled].focus,fieldset[disabled] .btn-warning.focus {  background-color: #f0ad4e;  border-color: #eea236;}.btn-warning .badge {  color: #f0ad4e;  background-color: #fff;}.btn-danger {  color: #fff;  background-color: #d9534f;  border-color: #d43f3a;}.btn-danger:focus,.btn-danger.focus {  color: #fff;  background-color: #c9302c;  border-color: #761c19;}.btn-danger:hover {  color: #fff;  background-color: #c9302c;  border-color: #ac2925;}.btn-danger:active,.btn-danger.active,.open > .dropdown-toggle.btn-danger {  color: #fff;  background-color: #c9302c;  border-color: #ac2925;}.btn-danger:active:hover,.btn-danger.active:hover,.open > .dropdown-toggle.btn-danger:hover,.btn-danger:active:focus,.btn-danger.active:focus,.open > .dropdown-toggle.btn-danger:focus,.btn-danger:active.focus,.btn-danger.active.focus,.open > .dropdown-toggle.btn-danger.focus {  color: #fff;  background-color: #ac2925;  border-color: #761c19;}.btn-danger:active,.btn-danger.active,.open > .dropdown-toggle.btn-danger {  background-image: none;}.btn-danger.disabled:hover,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger:hover,.btn-danger.disabled:focus,.btn-danger[disabled]:focus,fieldset[disabled] .btn-danger:focus,.btn-danger.disabled.focus,.btn-danger[disabled].focus,fieldset[disabled] .btn-danger.focus {  background-color: #d9534f;  border-color: #d43f3a;}.btn-danger .badge {  color: #d9534f;  background-color: #fff;}.btn-link {  color: #337ab7;  font-weight: normal;  border-radius: 0;}.btn-link,.btn-link:active,.btn-link.active,.btn-link[disabled],fieldset[disabled] .btn-link {  background-color: transparent;  -webkit-box-shadow: none;  box-shadow: none;}.btn-link,.btn-link:hover,.btn-link:focus,.btn-link:active {  border-color: transparent;}.btn-link:hover,.btn-link:focus {  color: #23527c;  text-decoration: underline;  background-color: transparent;}.btn-link[disabled]:hover,fieldset[disabled] .btn-link:hover,.btn-link[disabled]:focus,fieldset[disabled] .btn-link:focus {  color: #777777;  text-decoration: none;}.btn-lg,.btn-group-lg > .btn {  padding: 10px 16px;  font-size: 17px;  line-height: 1.3333333;  border-radius: 3px;}.btn-sm,.btn-group-sm > .btn {  padding: 5px 10px;  font-size: 12px;  line-height: 1.5;  border-radius: 1px;}.btn-xs,.btn-group-xs > .btn {  padding: 1px 5px;  font-size: 12px;  line-height: 1.5;  border-radius: 1px;}.btn-block {  display: block;  width: 100%;}.btn-block + .btn-block {  margin-top: 5px;}input[type='submit'].btn-block,input[type='reset'].btn-block,input[type='button'].btn-block {  width: 100%;}.fade {  opacity: 0;  -webkit-transition: opacity 0.15s linear;  -o-transition: opacity 0.15s linear;  transition: opacity 0.15s linear;}.fade.in {  opacity: 1;}.collapse {  display: none;}.collapse.in {  display: block;}tr.collapse.in {  display: table-row;}tbody.collapse.in {  display: table-row-group;}.collapsing {  position: relative;  height: 0;  overflow: hidden;  -webkit-transition-property: height, visibility;  transition-property: height, visibility;  -webkit-transition-duration: 0.35s;  transition-duration: 0.35s;  -webkit-transition-timing-function: ease;  transition-timing-function: ease;}.caret {  display: inline-block;  width: 0;  height: 0;  margin-left: 2px;  vertical-align: middle;  border-top: 4px dashed;  border-top: 4px solid \9;  border-right: 4px solid transparent;  border-left: 4px solid transparent;}.dropup,.dropdown {  position: relative;}.dropdown-toggle:focus {  outline: 0;}.dropdown-menu {  position: absolute;  top: 100%;  left: 0;  z-index: 1000;  display: none;  float: left;  min-width: 160px;  padding: 5px 0;  margin: 2px 0 0;  list-style: none;  font-size: 13px;  text-align: left;  background-color: #fff;  border: 1px solid #ccc;  border: 1px solid rgba(0, 0, 0, 0.15);  border-radius: 2px;  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);  background-clip: padding-box;}.dropdown-menu.pull-right {  right: 0;  left: auto;}.dropdown-menu .divider {  height: 1px;  margin: 8px 0;  overflow: hidden;  background-color: #e5e5e5;}.dropdown-menu > li > a {  display: block;  padding: 3px 20px;  clear: both;  font-weight: normal;  line-height: 1.42857143;  color: #333333;  white-space: nowrap;}.dropdown-menu > li > a:hover,.dropdown-menu > li > a:focus {  text-decoration: none;  color: #262626;  background-color: #f5f5f5;}.dropdown-menu > .active > a,.dropdown-menu > .active > a:hover,.dropdown-menu > .active > a:focus {  color: #fff;  text-decoration: none;  outline: 0;  background-color: #337ab7;}.dropdown-menu > .disabled > a,.dropdown-menu > .disabled > a:hover,.dropdown-menu > .disabled > a:focus {  color: #777777;}.dropdown-menu > .disabled > a:hover,.dropdown-menu > .disabled > a:focus {  text-decoration: none;  background-color: transparent;  background-image: none;  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);  cursor: not-allowed;}.open > .dropdown-menu {  display: block;}.open > a {  outline: 0;}.dropdown-menu-right {  left: auto;  right: 0;}.dropdown-menu-left {  left: 0;  right: auto;}.dropdown-header {  display: block;  padding: 3px 20px;  font-size: 12px;  line-height: 1.42857143;  color: #777777;  white-space: nowrap;}.dropdown-backdrop {  position: fixed;  left: 0;  right: 0;  bottom: 0;  top: 0;  z-index: 990;}.pull-right > .dropdown-menu {  right: 0;  left: auto;}.dropup .caret,.navbar-fixed-bottom .dropdown .caret {  border-top: 0;  border-bottom: 4px dashed;  border-bottom: 4px solid \9;  content: '';}.dropup .dropdown-menu,.navbar-fixed-bottom .dropdown .dropdown-menu {  top: auto;  bottom: 100%;  margin-bottom: 2px;}@media (min-width: 541px) {  .navbar-right .dropdown-menu {    left: auto;    right: 0;  }  .navbar-right .dropdown-menu-left {    left: 0;    right: auto;  }}.btn-group,.btn-group-vertical {  position: relative;  display: inline-block;  vertical-align: middle;}.btn-group > .btn,.btn-group-vertical > .btn {  position: relative;  float: left;}.btn-group > .btn:hover,.btn-group-vertical > .btn:hover,.btn-group > .btn:focus,.btn-group-vertical > .btn:focus,.btn-group > .btn:active,.btn-group-vertical > .btn:active,.btn-group > .btn.active,.btn-group-vertical > .btn.active {  z-index: 2;}.btn-group .btn + .btn,.btn-group .btn + .btn-group,.btn-group .btn-group + .btn,.btn-group .btn-group + .btn-group {  margin-left: -1px;}.btn-toolbar {  margin-left: -5px;}.btn-toolbar .btn,.btn-toolbar .btn-group,.btn-toolbar .input-group {  float: left;}.btn-toolbar > .btn,.btn-toolbar > .btn-group,.btn-toolbar > .input-group {  margin-left: 5px;}.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {  border-radius: 0;}.btn-group > .btn:first-child {  margin-left: 0;}.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {  border-bottom-right-radius: 0;  border-top-right-radius: 0;}.btn-group > .btn:last-child:not(:first-child),.btn-group > .dropdown-toggle:not(:first-child) {  border-bottom-left-radius: 0;  border-top-left-radius: 0;}.btn-group > .btn-group {  float: left;}.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {  border-radius: 0;}.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {  border-bottom-right-radius: 0;  border-top-right-radius: 0;}.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {  border-bottom-left-radius: 0;  border-top-left-radius: 0;}.btn-group .dropdown-toggle:active,.btn-group.open .dropdown-toggle {  outline: 0;}.btn-group > .btn + .dropdown-toggle {  padding-left: 8px;  padding-right: 8px;}.btn-group > .btn-lg + .dropdown-toggle {  padding-left: 12px;  padding-right: 12px;}.btn-group.open .dropdown-toggle {  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);}.btn-group.open .dropdown-toggle.btn-link {  -webkit-box-shadow: none;  box-shadow: none;}.btn .caret {  margin-left: 0;}.btn-lg .caret {  border-width: 5px 5px 0;  border-bottom-width: 0;}.dropup .btn-lg .caret {  border-width: 0 5px 5px;}.btn-group-vertical > .btn,.btn-group-vertical > .btn-group,.btn-group-vertical > .btn-group > .btn {  display: block;  float: none;  width: 100%;  max-width: 100%;}.btn-group-vertical > .btn-group > .btn {  float: none;}.btn-group-vertical > .btn + .btn,.btn-group-vertical > .btn + .btn-group,.btn-group-vertical > .btn-group + .btn,.btn-group-vertical > .btn-group + .btn-group {  margin-top: -1px;  margin-left: 0;}.btn-group-vertical > .btn:not(:first-child):not(:last-child) {  border-radius: 0;}.btn-group-vertical > .btn:first-child:not(:last-child) {  border-top-right-radius: 2px;  border-top-left-radius: 2px;  border-bottom-right-radius: 0;  border-bottom-left-radius: 0;}.btn-group-vertical > .btn:last-child:not(:first-child) {  border-top-right-radius: 0;  border-top-left-radius: 0;  border-bottom-right-radius: 2px;  border-bottom-left-radius: 2px;}.btn-group-vertical > .btn-group:not(:first-child):not(:last-child) > .btn {  border-radius: 0;}.btn-group-vertical > .btn-group:first-child:not(:last-child) > .btn:last-child,.btn-group-vertical > .btn-group:first-child:not(:last-child) > .dropdown-toggle {  border-bottom-right-radius: 0;  border-bottom-left-radius: 0;}.btn-group-vertical > .btn-group:last-child:not(:first-child) > .btn:first-child {  border-top-right-radius: 0;  border-top-left-radius: 0;}.btn-group-justified {  display: table;  width: 100%;  table-layout: fixed;  border-collapse: separate;}.btn-group-justified > .btn,.btn-group-justified > .btn-group {  float: none;  display: table-cell;  width: 1%;}.btn-group-justified > .btn-group .btn {  width: 100%;}.btn-group-justified > .btn-group .dropdown-menu {  left: auto;}[data-toggle='buttons'] > .btn input[type='radio'],[data-toggle='buttons'] > .btn-group > .btn input[type='radio'],[data-toggle='buttons'] > .btn input[type='checkbox'],[data-toggle='buttons'] > .btn-group > .btn input[type='checkbox'] {  position: absolute;  clip: rect(0, 0, 0, 0);  pointer-events: none;}.input-group {  position: relative;  display: table;  border-collapse: separate;}.input-group[class*='col-'] {  float: none;  padding-left: 0;  padding-right: 0;}.input-group .form-control {  position: relative;  z-index: 2;  float: left;  width: 100%;  margin-bottom: 0;}.input-group .form-control:focus {  z-index: 3;}.input-group-lg > .form-control,.input-group-lg > .input-group-addon,.input-group-lg > .input-group-btn > .btn {  height: 45px;  padding: 10px 16px;  font-size: 17px;  line-height: 1.3333333;  border-radius: 3px;}select.input-group-lg > .form-control,select.input-group-lg > .input-group-addon,select.input-group-lg > .input-group-btn > .btn {  height: 45px;  line-height: 45px;}textarea.input-group-lg > .form-control,textarea.input-group-lg > .input-group-addon,textarea.input-group-lg > .input-group-btn > .btn,select[multiple].input-group-lg > .form-control,select[multiple].input-group-lg > .input-group-addon,select[multiple].input-group-lg > .input-group-btn > .btn {  height: auto;}.input-group-sm > .form-control,.input-group-sm > .input-group-addon,.input-group-sm > .input-group-btn > .btn {  height: 30px;  padding: 5px 10px;  font-size: 12px;  line-height: 1.5;  border-radius: 1px;}select.input-group-sm > .form-control,select.input-group-sm > .input-group-addon,select.input-group-sm > .input-group-btn > .btn {  height: 30px;  line-height: 30px;}textarea.input-group-sm > .form-control,textarea.input-group-sm > .input-group-addon,textarea.input-group-sm > .input-group-btn > .btn,select[multiple].input-group-sm > .form-control,select[multiple].input-group-sm > .input-group-addon,select[multiple].input-group-sm > .input-group-btn > .btn {  height: auto;}.input-group-addon,.input-group-btn,.input-group .form-control {  display: table-cell;}.input-group-addon:not(:first-child):not(:last-child),.input-group-btn:not(:first-child):not(:last-child),.input-group .form-control:not(:first-child):not(:last-child) {  border-radius: 0;}.input-group-addon,.input-group-btn {  width: 1%;  white-space: nowrap;  vertical-align: middle;}.input-group-addon {  padding: 6px 12px;  font-size: 13px;  font-weight: normal;  line-height: 1;  color: #555555;  text-align: center;  background-color: #eeeeee;  border: 1px solid #ccc;  border-radius: 2px;}.input-group-addon.input-sm {  padding: 5px 10px;  font-size: 12px;  border-radius: 1px;}.input-group-addon.input-lg {  padding: 10px 16px;  font-size: 17px;  border-radius: 3px;}.input-group-addon input[type='radio'],.input-group-addon input[type='checkbox'] {  margin-top: 0;}.input-group .form-control:first-child,.input-group-addon:first-child,.input-group-btn:first-child > .btn,.input-group-btn:first-child > .btn-group > .btn,.input-group-btn:first-child > .dropdown-toggle,.input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle),.input-group-btn:last-child > .btn-group:not(:last-child) > .btn {  border-bottom-right-radius: 0;  border-top-right-radius: 0;}.input-group-addon:first-child {  border-right: 0;}.input-group .form-control:last-child,.input-group-addon:last-child,.input-group-btn:last-child > .btn,.input-group-btn:last-child > .btn-group > .btn,.input-group-btn:last-child > .dropdown-toggle,.input-group-btn:first-child > .btn:not(:first-child),.input-group-btn:first-child > .btn-group:not(:first-child) > .btn {  border-bottom-left-radius: 0;  border-top-left-radius: 0;}.input-group-addon:last-child {  border-left: 0;}.input-group-btn {  position: relative;  font-size: 0;  white-space: nowrap;}.input-group-btn > .btn {  position: relative;}.input-group-btn > .btn + .btn {  margin-left: -1px;}.input-group-btn > .btn:hover,.input-group-btn > .btn:focus,.input-group-btn > .btn:active {  z-index: 2;}.input-group-btn:first-child > .btn,.input-group-btn:first-child > .btn-group {  margin-right: -1px;}.input-group-btn:last-child > .btn,.input-group-btn:last-child > .btn-group {  z-index: 2;  margin-left: -1px;}.nav {  margin-bottom: 0;  padding-left: 0;  list-style: none;}.nav > li {  position: relative;  display: block;}.nav > li > a {  position: relative;  display: block;  padding: 10px 15px;}.nav > li > a:hover,.nav > li > a:focus {  text-decoration: none;  background-color: #eeeeee;}.nav > li.disabled > a {  color: #777777;}.nav > li.disabled > a:hover,.nav > li.disabled > a:focus {  color: #777777;  text-decoration: none;  background-color: transparent;  cursor: not-allowed;}.nav .open > a,.nav .open > a:hover,.nav .open > a:focus {  background-color: #eeeeee;  border-color: #337ab7;}.nav .nav-divider {  height: 1px;  margin: 8px 0;  overflow: hidden;  background-color: #e5e5e5;}.nav > li > a > img {  max-width: none;}.nav-tabs {  border-bottom: 1px solid #ddd;}.nav-tabs > li {  float: left;  margin-bottom: -1px;}.nav-tabs > li > a {  margin-right: 2px;  line-height: 1.42857143;  border: 1px solid transparent;  border-radius: 2px 2px 0 0;}.nav-tabs > li > a:hover {  border-color: #eeeeee #eeeeee #ddd;}.nav-tabs > li.active > a,.nav-tabs > li.active > a:hover,.nav-tabs > li.active > a:focus {  color: #555555;  background-color: #fff;  border: 1px solid #ddd;  border-bottom-color: transparent;  cursor: default;}.nav-tabs.nav-justified {  width: 100%;  border-bottom: 0;}.nav-tabs.nav-justified > li {  float: none;}.nav-tabs.nav-justified > li > a {  text-align: center;  margin-bottom: 5px;}.nav-tabs.nav-justified > .dropdown .dropdown-menu {  top: auto;  left: auto;}@media (min-width: 768px) {  .nav-tabs.nav-justified > li {    display: table-cell;    width: 1%;  }  .nav-tabs.nav-justified > li > a {    margin-bottom: 0;  }}.nav-tabs.nav-justified > li > a {  margin-right: 0;  border-radius: 2px;}.nav-tabs.nav-justified > .active > a,.nav-tabs.nav-justified > .active > a:hover,.nav-tabs.nav-justified > .active > a:focus {  border: 1px solid #ddd;}@media (min-width: 768px) {  .nav-tabs.nav-justified > li > a {    border-bottom: 1px solid #ddd;    border-radius: 2px 2px 0 0;  }  .nav-tabs.nav-justified > .active > a,  .nav-tabs.nav-justified > .active > a:hover,  .nav-tabs.nav-justified > .active > a:focus {    border-bottom-color: #fff;  }}.nav-pills > li {  float: left;}.nav-pills > li > a {  border-radius: 2px;}.nav-pills > li + li {  margin-left: 2px;}.nav-pills > li.active > a,.nav-pills > li.active > a:hover,.nav-pills > li.active > a:focus {  color: #fff;  background-color: #337ab7;}.nav-stacked > li {  float: none;}.nav-stacked > li + li {  margin-top: 2px;  margin-left: 0;}.nav-justified {  width: 100%;}.nav-justified > li {  float: none;}.nav-justified > li > a {  text-align: center;  margin-bottom: 5px;}.nav-justified > .dropdown .dropdown-menu {  top: auto;  left: auto;}@media (min-width: 768px) {  .nav-justified > li {    display: table-cell;    width: 1%;  }  .nav-justified > li > a {    margin-bottom: 0;  }}.nav-tabs-justified {  border-bottom: 0;}.nav-tabs-justified > li > a {  margin-right: 0;  border-radius: 2px;}.nav-tabs-justified > .active > a,.nav-tabs-justified > .active > a:hover,.nav-tabs-justified > .active > a:focus {  border: 1px solid #ddd;}@media (min-width: 768px) {  .nav-tabs-justified > li > a {    border-bottom: 1px solid #ddd;    border-radius: 2px 2px 0 0;  }  .nav-tabs-justified > .active > a,  .nav-tabs-justified > .active > a:hover,  .nav-tabs-justified > .active > a:focus {    border-bottom-color: #fff;  }}.tab-content > .tab-pane {  display: none;}.tab-content > .active {  display: block;}.nav-tabs .dropdown-menu {  margin-top: -1px;  border-top-right-radius: 0;  border-top-left-radius: 0;}.navbar {  position: relative;  min-height: 30px;  margin-bottom: 18px;  border: 1px solid transparent;}@media (min-width: 541px) {  .navbar {    border-radius: 2px;  }}@media (min-width: 541px) {  .navbar-header {    float: left;  }}.navbar-collapse {  overflow-x: visible;  padding-right: 0px;  padding-left: 0px;  border-top: 1px solid transparent;  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);  -webkit-overflow-scrolling: touch;}.navbar-collapse.in {  overflow-y: auto;}@media (min-width: 541px) {  .navbar-collapse {    width: auto;    border-top: 0;    box-shadow: none;  }  .navbar-collapse.collapse {    display: block !important;    height: auto !important;    padding-bottom: 0;    overflow: visible !important;  }  .navbar-collapse.in {    overflow-y: visible;  }  .navbar-fixed-top .navbar-collapse,  .navbar-static-top .navbar-collapse,  .navbar-fixed-bottom .navbar-collapse {    padding-left: 0;    padding-right: 0;  }}.navbar-fixed-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse {  max-height: 340px;}@media (max-device-width: 540px) and (orientation: landscape) {  .navbar-fixed-top .navbar-collapse,  .navbar-fixed-bottom .navbar-collapse {    max-height: 200px;  }}.container > .navbar-header,.container-fluid > .navbar-header,.container > .navbar-collapse,.container-fluid > .navbar-collapse {  margin-right: 0px;  margin-left: 0px;}@media (min-width: 541px) {  .container > .navbar-header,  .container-fluid > .navbar-header,  .container > .navbar-collapse,  .container-fluid > .navbar-collapse {    margin-right: 0;    margin-left: 0;  }}.navbar-static-top {  z-index: 1000;  border-width: 0 0 1px;}@media (min-width: 541px) {  .navbar-static-top {    border-radius: 0;  }}.navbar-fixed-top,.navbar-fixed-bottom {  position: fixed;  right: 0;  left: 0;  z-index: 1030;}@media (min-width: 541px) {  .navbar-fixed-top,  .navbar-fixed-bottom {    border-radius: 0;  }}.navbar-fixed-top {  top: 0;  border-width: 0 0 1px;}.navbar-fixed-bottom {  bottom: 0;  margin-bottom: 0;  border-width: 1px 0 0;}.navbar-brand {  float: left;  padding: 6px 0px;  font-size: 17px;  line-height: 18px;  height: 30px;}.navbar-brand:hover,.navbar-brand:focus {  text-decoration: none;}.navbar-brand > img {  display: block;}@media (min-width: 541px) {  .navbar > .container .navbar-brand,  .navbar > .container-fluid .navbar-brand {    margin-left: 0px;  }}.navbar-toggle {  position: relative;  float: right;  margin-right: 0px;  padding: 9px 10px;  margin-top: -2px;  margin-bottom: -2px;  background-color: transparent;  background-image: none;  border: 1px solid transparent;  border-radius: 2px;}.navbar-toggle:focus {  outline: 0;}.navbar-toggle .icon-bar {  display: block;  width: 22px;  height: 2px;  border-radius: 1px;}.navbar-toggle .icon-bar + .icon-bar {  margin-top: 4px;}@media (min-width: 541px) {  .navbar-toggle {    display: none;  }}.navbar-nav {  margin: 3px 0px;}.navbar-nav > li > a {  padding-top: 10px;  padding-bottom: 10px;  line-height: 18px;}@media (max-width: 540px) {  .navbar-nav .open .dropdown-menu {    position: static;    float: none;    width: auto;    margin-top: 0;    background-color: transparent;    border: 0;    box-shadow: none;  }  .navbar-nav .open .dropdown-menu > li > a,  .navbar-nav .open .dropdown-menu .dropdown-header {    padding: 5px 15px 5px 25px;  }  .navbar-nav .open .dropdown-menu > li > a {    line-height: 18px;  }  .navbar-nav .open .dropdown-menu > li > a:hover,  .navbar-nav .open .dropdown-menu > li > a:focus {    background-image: none;  }}@media (min-width: 541px) {  .navbar-nav {    float: left;    margin: 0;  }  .navbar-nav > li {    float: left;  }  .navbar-nav > li > a {    padding-top: 6px;    padding-bottom: 6px;  }}.navbar-form {  margin-left: 0px;  margin-right: 0px;  padding: 10px 0px;  border-top: 1px solid transparent;  border-bottom: 1px solid transparent;  -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);  margin-top: -1px;  margin-bottom: -1px;}@media (min-width: 768px) {  .navbar-form .form-group {    display: inline-block;    margin-bottom: 0;    vertical-align: middle;  }  .navbar-form .form-control {    display: inline-block;    width: auto;    vertical-align: middle;  }  .navbar-form .form-control-static {    display: inline-block;  }  .navbar-form .input-group {    display: inline-table;    vertical-align: middle;  }  .navbar-form .input-group .input-group-addon,  .navbar-form .input-group .input-group-btn,  .navbar-form .input-group .form-control {    width: auto;  }  .navbar-form .input-group > .form-control {    width: 100%;  }  .navbar-form .control-label {    margin-bottom: 0;    vertical-align: middle;  }  .navbar-form .radio,  .navbar-form .checkbox {    display: inline-block;    margin-top: 0;    margin-bottom: 0;    vertical-align: middle;  }  .navbar-form .radio label,  .navbar-form .checkbox label {    padding-left: 0;  }  .navbar-form .radio input[type='radio'],  .navbar-form .checkbox input[type='checkbox'] {    position: relative;    margin-left: 0;  }  .navbar-form .has-feedback .form-control-feedback {    top: 0;  }}@media (max-width: 540px) {  .navbar-form .form-group {    margin-bottom: 5px;  }  .navbar-form .form-group:last-child {    margin-bottom: 0;  }}@media (min-width: 541px) {  .navbar-form {    width: auto;    border: 0;    margin-left: 0;    margin-right: 0;    padding-top: 0;    padding-bottom: 0;    -webkit-box-shadow: none;    box-shadow: none;  }}.navbar-nav > li > .dropdown-menu {  margin-top: 0;  border-top-right-radius: 0;  border-top-left-radius: 0;}.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu {  margin-bottom: 0;  border-top-right-radius: 2px;  border-top-left-radius: 2px;  border-bottom-right-radius: 0;  border-bottom-left-radius: 0;}.navbar-btn {  margin-top: -1px;  margin-bottom: -1px;}.navbar-btn.btn-sm {  margin-top: 0px;  margin-bottom: 0px;}.navbar-btn.btn-xs {  margin-top: 4px;  margin-bottom: 4px;}.navbar-text {  margin-top: 6px;  margin-bottom: 6px;}@media (min-width: 541px) {  .navbar-text {    float: left;    margin-left: 0px;    margin-right: 0px;  }}@media (min-width: 541px) {  .navbar-left {    float: left !important;    float: left;  }  .navbar-right {    float: right !important;    float: right;    margin-right: 0px;  }  .navbar-right ~ .navbar-right {    margin-right: 0;  }}.navbar-default {  background-color: #f8f8f8;  border-color: #e7e7e7;}.navbar-default .navbar-brand {  color: #777;}.navbar-default .navbar-brand:hover,.navbar-default .navbar-brand:focus {  color: #5e5e5e;  background-color: transparent;}.navbar-default .navbar-text {  color: #777;}.navbar-default .navbar-nav > li > a {  color: #777;}.navbar-default .navbar-nav > li > a:hover,.navbar-default .navbar-nav > li > a:focus {  color: #333;  background-color: transparent;}.navbar-default .navbar-nav > .active > a,.navbar-default .navbar-nav > .active > a:hover,.navbar-default .navbar-nav > .active > a:focus {  color: #555;  background-color: #e7e7e7;}.navbar-default .navbar-nav > .disabled > a,.navbar-default .navbar-nav > .disabled > a:hover,.navbar-default .navbar-nav > .disabled > a:focus {  color: #ccc;  background-color: transparent;}.navbar-default .navbar-toggle {  border-color: #ddd;}.navbar-default .navbar-toggle:hover,.navbar-default .navbar-toggle:focus {  background-color: #ddd;}.navbar-default .navbar-toggle .icon-bar {  background-color: #888;}.navbar-default .navbar-collapse,.navbar-default .navbar-form {  border-color: #e7e7e7;}.navbar-default .navbar-nav > .open > a,.navbar-default .navbar-nav > .open > a:hover,.navbar-default .navbar-nav > .open > a:focus {  background-color: #e7e7e7;  color: #555;}@media (max-width: 540px) {  .navbar-default .navbar-nav .open .dropdown-menu > li > a {    color: #777;  }  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {    color: #333;    background-color: transparent;  }  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {    color: #555;    background-color: #e7e7e7;  }  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus {    color: #ccc;    background-color: transparent;  }}.navbar-default .navbar-link {  color: #777;}.navbar-default .navbar-link:hover {  color: #333;}.navbar-default .btn-link {  color: #777;}.navbar-default .btn-link:hover,.navbar-default .btn-link:focus {  color: #333;}.navbar-default .btn-link[disabled]:hover,fieldset[disabled] .navbar-default .btn-link:hover,.navbar-default .btn-link[disabled]:focus,fieldset[disabled] .navbar-default .btn-link:focus {  color: #ccc;}.navbar-inverse {  background-color: #222;  border-color: #080808;}.navbar-inverse .navbar-brand {  color: #9d9d9d;}.navbar-inverse .navbar-brand:hover,.navbar-inverse .navbar-brand:focus {  color: #fff;  background-color: transparent;}.navbar-inverse .navbar-text {  color: #9d9d9d;}.navbar-inverse .navbar-nav > li > a {  color: #9d9d9d;}.navbar-inverse .navbar-nav > li > a:hover,.navbar-inverse .navbar-nav > li > a:focus {  color: #fff;  background-color: transparent;}.navbar-inverse .navbar-nav > .active > a,.navbar-inverse .navbar-nav > .active > a:hover,.navbar-inverse .navbar-nav > .active > a:focus {  color: #fff;  background-color: #080808;}.navbar-inverse .navbar-nav > .disabled > a,.navbar-inverse .navbar-nav > .disabled > a:hover,.navbar-inverse .navbar-nav > .disabled > a:focus {  color: #444;  background-color: transparent;}.navbar-inverse .navbar-toggle {  border-color: #333;}.navbar-inverse .navbar-toggle:hover,.navbar-inverse .navbar-toggle:focus {  background-color: #333;}.navbar-inverse .navbar-toggle .icon-bar {  background-color: #fff;}.navbar-inverse .navbar-collapse,.navbar-inverse .navbar-form {  border-color: #101010;}.navbar-inverse .navbar-nav > .open > a,.navbar-inverse .navbar-nav > .open > a:hover,.navbar-inverse .navbar-nav > .open > a:focus {  background-color: #080808;  color: #fff;}@media (max-width: 540px) {  .navbar-inverse .navbar-nav .open .dropdown-menu > .dropdown-header {    border-color: #080808;  }  .navbar-inverse .navbar-nav .open .dropdown-menu .divider {    background-color: #080808;  }  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a {    color: #9d9d9d;  }  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:hover,  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:focus {    color: #fff;    background-color: transparent;  }  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a,  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:hover,  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:focus {    color: #fff;    background-color: #080808;  }  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a,  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:hover,  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:focus {    color: #444;    background-color: transparent;  }}.navbar-inverse .navbar-link {  color: #9d9d9d;}.navbar-inverse .navbar-link:hover {  color: #fff;}.navbar-inverse .btn-link {  color: #9d9d9d;}.navbar-inverse .btn-link:hover,.navbar-inverse .btn-link:focus {  color: #fff;}.navbar-inverse .btn-link[disabled]:hover,fieldset[disabled] .navbar-inverse .btn-link:hover,.navbar-inverse .btn-link[disabled]:focus,fieldset[disabled] .navbar-inverse .btn-link:focus {  color: #444;}.breadcrumb {  padding: 8px 15px;  margin-bottom: 18px;  list-style: none;  background-color: #f5f5f5;  border-radius: 2px;}.breadcrumb > li {  display: inline-block;}.breadcrumb > li + li:before {  content: '/\00a0';  padding: 0 5px;  color: #5e5e5e;}.breadcrumb > .active {  color: #777777;}.pagination {  display: inline-block;  padding-left: 0;  margin: 18px 0;  border-radius: 2px;}.pagination > li {  display: inline;}.pagination > li > a,.pagination > li > span {  position: relative;  float: left;  padding: 6px 12px;  line-height: 1.42857143;  text-decoration: none;  color: #337ab7;  background-color: #fff;  border: 1px solid #ddd;  margin-left: -1px;}.pagination > li:first-child > a,.pagination > li:first-child > span {  margin-left: 0;  border-bottom-left-radius: 2px;  border-top-left-radius: 2px;}.pagination > li:last-child > a,.pagination > li:last-child > span {  border-bottom-right-radius: 2px;  border-top-right-radius: 2px;}.pagination > li > a:hover,.pagination > li > span:hover,.pagination > li > a:focus,.pagination > li > span:focus {  z-index: 2;  color: #23527c;  background-color: #eeeeee;  border-color: #ddd;}.pagination > .active > a,.pagination > .active > span,.pagination > .active > a:hover,.pagination > .active > span:hover,.pagination > .active > a:focus,.pagination > .active > span:focus {  z-index: 3;  color: #fff;  background-color: #337ab7;  border-color: #337ab7;  cursor: default;}.pagination > .disabled > span,.pagination > .disabled > span:hover,.pagination > .disabled > span:focus,.pagination > .disabled > a,.pagination > .disabled > a:hover,.pagination > .disabled > a:focus {  color: #777777;  background-color: #fff;  border-color: #ddd;  cursor: not-allowed;}.pagination-lg > li > a,.pagination-lg > li > span {  padding: 10px 16px;  font-size: 17px;  line-height: 1.3333333;}.pagination-lg > li:first-child > a,.pagination-lg > li:first-child > span {  border-bottom-left-radius: 3px;  border-top-left-radius: 3px;}.pagination-lg > li:last-child > a,.pagination-lg > li:last-child > span {  border-bottom-right-radius: 3px;  border-top-right-radius: 3px;}.pagination-sm > li > a,.pagination-sm > li > span {  padding: 5px 10px;  font-size: 12px;  line-height: 1.5;}.pagination-sm > li:first-child > a,.pagination-sm > li:first-child > span {  border-bottom-left-radius: 1px;  border-top-left-radius: 1px;}.pagination-sm > li:last-child > a,.pagination-sm > li:last-child > span {  border-bottom-right-radius: 1px;  border-top-right-radius: 1px;}.pager {  padding-left: 0;  margin: 18px 0;  list-style: none;  text-align: center;}.pager li {  display: inline;}.pager li > a,.pager li > span {  display: inline-block;  padding: 5px 14px;  background-color: #fff;  border: 1px solid #ddd;  border-radius: 15px;}.pager li > a:hover,.pager li > a:focus {  text-decoration: none;  background-color: #eeeeee;}.pager .next > a,.pager .next > span {  float: right;}.pager .previous > a,.pager .previous > span {  float: left;}.pager .disabled > a,.pager .disabled > a:hover,.pager .disabled > a:focus,.pager .disabled > span {  color: #777777;  background-color: #fff;  cursor: not-allowed;}.label {  display: inline;  padding: .2em .6em .3em;  font-size: 75%;  font-weight: bold;  line-height: 1;  color: #fff;  text-align: center;  white-space: nowrap;  vertical-align: baseline;  border-radius: .25em;}a.label:hover,a.label:focus {  color: #fff;  text-decoration: none;  cursor: pointer;}.label:empty {  display: none;}.btn .label {  position: relative;  top: -1px;}.label-default {  background-color: #777777;}.label-default[href]:hover,.label-default[href]:focus {  background-color: #5e5e5e;}.label-primary {  background-color: #337ab7;}.label-primary[href]:hover,.label-primary[href]:focus {  background-color: #286090;}.label-success {  background-color: #5cb85c;}.label-success[href]:hover,.label-success[href]:focus {  background-color: #449d44;}.label-info {  background-color: #5bc0de;}.label-info[href]:hover,.label-info[href]:focus {  background-color: #31b0d5;}.label-warning {  background-color: #f0ad4e;}.label-warning[href]:hover,.label-warning[href]:focus {  background-color: #ec971f;}.label-danger {  background-color: #d9534f;}.label-danger[href]:hover,.label-danger[href]:focus {  background-color: #c9302c;}.badge {  display: inline-block;  min-width: 10px;  padding: 3px 7px;  font-size: 12px;  font-weight: bold;  color: #fff;  line-height: 1;  vertical-align: middle;  white-space: nowrap;  text-align: center;  background-color: #777777;  border-radius: 10px;}.badge:empty {  display: none;}.btn .badge {  position: relative;  top: -1px;}.btn-xs .badge,.btn-group-xs > .btn .badge {  top: 0;  padding: 1px 5px;}a.badge:hover,a.badge:focus {  color: #fff;  text-decoration: none;  cursor: pointer;}.list-group-item.active > .badge,.nav-pills > .active > a > .badge {  color: #337ab7;  background-color: #fff;}.list-group-item > .badge {  float: right;}.list-group-item > .badge + .badge {  margin-right: 5px;}.nav-pills > li > a > .badge {  margin-left: 3px;}.jumbotron {  padding-top: 30px;  padding-bottom: 30px;  margin-bottom: 30px;  color: inherit;  background-color: #eeeeee;}.jumbotron h1,.jumbotron .h1 {  color: inherit;}.jumbotron p {  margin-bottom: 15px;  font-size: 20px;  font-weight: 200;}.jumbotron > hr {  border-top-color: #d5d5d5;}.container .jumbotron,.container-fluid .jumbotron {  border-radius: 3px;  padding-left: 0px;  padding-right: 0px;}.jumbotron .container {  max-width: 100%;}@media screen and (min-width: 768px) {  .jumbotron {    padding-top: 48px;    padding-bottom: 48px;  }  .container .jumbotron,  .container-fluid .jumbotron {    padding-left: 60px;    padding-right: 60px;  }  .jumbotron h1,  .jumbotron .h1 {    font-size: 59px;  }}.thumbnail {  display: block;  padding: 4px;  margin-bottom: 18px;  line-height: 1.42857143;  background-color: #fff;  border: 1px solid #ddd;  border-radius: 2px;  -webkit-transition: border 0.2s ease-in-out;  -o-transition: border 0.2s ease-in-out;  transition: border 0.2s ease-in-out;}.thumbnail > img,.thumbnail a > img {  margin-left: auto;  margin-right: auto;}a.thumbnail:hover,a.thumbnail:focus,a.thumbnail.active {  border-color: #337ab7;}.thumbnail .caption {  padding: 9px;  color: #000;}.alert {  padding: 15px;  margin-bottom: 18px;  border: 1px solid transparent;  border-radius: 2px;}.alert h4 {  margin-top: 0;  color: inherit;}.alert .alert-link {  font-weight: bold;}.alert > p,.alert > ul {  margin-bottom: 0;}.alert > p + p {  margin-top: 5px;}.alert-dismissable,.alert-dismissible {  padding-right: 35px;}.alert-dismissable .close,.alert-dismissible .close {  position: relative;  top: -2px;  right: -21px;  color: inherit;}.alert-success {  background-color: #dff0d8;  border-color: #d6e9c6;  color: #3c763d;}.alert-success hr {  border-top-color: #c9e2b3;}.alert-success .alert-link {  color: #2b542c;}.alert-info {  background-color: #d9edf7;  border-color: #bce8f1;  color: #31708f;}.alert-info hr {  border-top-color: #a6e1ec;}.alert-info .alert-link {  color: #245269;}.alert-warning {  background-color: #fcf8e3;  border-color: #faebcc;  color: #8a6d3b;}.alert-warning hr {  border-top-color: #f7e1b5;}.alert-warning .alert-link {  color: #66512c;}.alert-danger {  background-color: #f2dede;  border-color: #ebccd1;  color: #a94442;}.alert-danger hr {  border-top-color: #e4b9c0;}.alert-danger .alert-link {  color: #843534;}@-webkit-keyframes progress-bar-stripes {  from {    background-position: 40px 0;  }  to {    background-position: 0 0;  }}@keyframes progress-bar-stripes {  from {    background-position: 40px 0;  }  to {    background-position: 0 0;  }}.progress {  overflow: hidden;  height: 18px;  margin-bottom: 18px;  background-color: #f5f5f5;  border-radius: 2px;  -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);}.progress-bar {  float: left;  width: 0%;  height: 100%;  font-size: 12px;  line-height: 18px;  color: #fff;  text-align: center;  background-color: #337ab7;  -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);  -webkit-transition: width 0.6s ease;  -o-transition: width 0.6s ease;  transition: width 0.6s ease;}.progress-striped .progress-bar,.progress-bar-striped {  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);  background-size: 40px 40px;}.progress.active .progress-bar,.progress-bar.active {  -webkit-animation: progress-bar-stripes 2s linear infinite;  -o-animation: progress-bar-stripes 2s linear infinite;  animation: progress-bar-stripes 2s linear infinite;}.progress-bar-success {  background-color: #5cb85c;}.progress-striped .progress-bar-success {  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);}.progress-bar-info {  background-color: #5bc0de;}.progress-striped .progress-bar-info {  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);}.progress-bar-warning {  background-color: #f0ad4e;}.progress-striped .progress-bar-warning {  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);}.progress-bar-danger {  background-color: #d9534f;}.progress-striped .progress-bar-danger {  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);}.media {  margin-top: 15px;}.media:first-child {  margin-top: 0;}.media,.media-body {  zoom: 1;  overflow: hidden;}.media-body {  width: 10000px;}.media-object {  display: block;}.media-object.img-thumbnail {  max-width: none;}.media-right,.media > .pull-right {  padding-left: 10px;}.media-left,.media > .pull-left {  padding-right: 10px;}.media-left,.media-right,.media-body {  display: table-cell;  vertical-align: top;}.media-middle {  vertical-align: middle;}.media-bottom {  vertical-align: bottom;}.media-heading {  margin-top: 0;  margin-bottom: 5px;}.media-list {  padding-left: 0;  list-style: none;}.list-group {  margin-bottom: 20px;  padding-left: 0;}.list-group-item {  position: relative;  display: block;  padding: 10px 15px;  margin-bottom: -1px;  background-color: #fff;  border: 1px solid #ddd;}.list-group-item:first-child {  border-top-right-radius: 2px;  border-top-left-radius: 2px;}.list-group-item:last-child {  margin-bottom: 0;  border-bottom-right-radius: 2px;  border-bottom-left-radius: 2px;}a.list-group-item,button.list-group-item {  color: #555;}a.list-group-item .list-group-item-heading,button.list-group-item .list-group-item-heading {  color: #333;}a.list-group-item:hover,button.list-group-item:hover,a.list-group-item:focus,button.list-group-item:focus {  text-decoration: none;  color: #555;  background-color: #f5f5f5;}button.list-group-item {  width: 100%;  text-align: left;}.list-group-item.disabled,.list-group-item.disabled:hover,.list-group-item.disabled:focus {  background-color: #eeeeee;  color: #777777;  cursor: not-allowed;}.list-group-item.disabled .list-group-item-heading,.list-group-item.disabled:hover .list-group-item-heading,.list-group-item.disabled:focus .list-group-item-heading {  color: inherit;}.list-group-item.disabled .list-group-item-text,.list-group-item.disabled:hover .list-group-item-text,.list-group-item.disabled:focus .list-group-item-text {  color: #777777;}.list-group-item.active,.list-group-item.active:hover,.list-group-item.active:focus {  z-index: 2;  color: #fff;  background-color: #337ab7;  border-color: #337ab7;}.list-group-item.active .list-group-item-heading,.list-group-item.active:hover .list-group-item-heading,.list-group-item.active:focus .list-group-item-heading,.list-group-item.active .list-group-item-heading > small,.list-group-item.active:hover .list-group-item-heading > small,.list-group-item.active:focus .list-group-item-heading > small,.list-group-item.active .list-group-item-heading > .small,.list-group-item.active:hover .list-group-item-heading > .small,.list-group-item.active:focus .list-group-item-heading > .small {  color: inherit;}.list-group-item.active .list-group-item-text,.list-group-item.active:hover .list-group-item-text,.list-group-item.active:focus .list-group-item-text {  color: #c7ddef;}.list-group-item-success {  color: #3c763d;  background-color: #dff0d8;}a.list-group-item-success,button.list-group-item-success {  color: #3c763d;}a.list-group-item-success .list-group-item-heading,button.list-group-item-success .list-group-item-heading {  color: inherit;}a.list-group-item-success:hover,button.list-group-item-success:hover,a.list-group-item-success:focus,button.list-group-item-success:focus {  color: #3c763d;  background-color: #d0e9c6;}a.list-group-item-success.active,button.list-group-item-success.active,a.list-group-item-success.active:hover,button.list-group-item-success.active:hover,a.list-group-item-success.active:focus,button.list-group-item-success.active:focus {  color: #fff;  background-color: #3c763d;  border-color: #3c763d;}.list-group-item-info {  color: #31708f;  background-color: #d9edf7;}a.list-group-item-info,button.list-group-item-info {  color: #31708f;}a.list-group-item-info .list-group-item-heading,button.list-group-item-info .list-group-item-heading {  color: inherit;}a.list-group-item-info:hover,button.list-group-item-info:hover,a.list-group-item-info:focus,button.list-group-item-info:focus {  color: #31708f;  background-color: #c4e3f3;}a.list-group-item-info.active,button.list-group-item-info.active,a.list-group-item-info.active:hover,button.list-group-item-info.active:hover,a.list-group-item-info.active:focus,button.list-group-item-info.active:focus {  color: #fff;  background-color: #31708f;  border-color: #31708f;}.list-group-item-warning {  color: #8a6d3b;  background-color: #fcf8e3;}a.list-group-item-warning,button.list-group-item-warning {  color: #8a6d3b;}a.list-group-item-warning .list-group-item-heading,button.list-group-item-warning .list-group-item-heading {  color: inherit;}a.list-group-item-warning:hover,button.list-group-item-warning:hover,a.list-group-item-warning:focus,button.list-group-item-warning:focus {  color: #8a6d3b;  background-color: #faf2cc;}a.list-group-item-warning.active,button.list-group-item-warning.active,a.list-group-item-warning.active:hover,button.list-group-item-warning.active:hover,a.list-group-item-warning.active:focus,button.list-group-item-warning.active:focus {  color: #fff;  background-color: #8a6d3b;  border-color: #8a6d3b;}.list-group-item-danger {  color: #a94442;  background-color: #f2dede;}a.list-group-item-danger,button.list-group-item-danger {  color: #a94442;}a.list-group-item-danger .list-group-item-heading,button.list-group-item-danger .list-group-item-heading {  color: inherit;}a.list-group-item-danger:hover,button.list-group-item-danger:hover,a.list-group-item-danger:focus,button.list-group-item-danger:focus {  color: #a94442;  background-color: #ebcccc;}a.list-group-item-danger.active,button.list-group-item-danger.active,a.list-group-item-danger.active:hover,button.list-group-item-danger.active:hover,a.list-group-item-danger.active:focus,button.list-group-item-danger.active:focus {  color: #fff;  background-color: #a94442;  border-color: #a94442;}.list-group-item-heading {  margin-top: 0;  margin-bottom: 5px;}.list-group-item-text {  margin-bottom: 0;  line-height: 1.3;}.panel {  margin-bottom: 18px;  background-color: #fff;  border: 1px solid transparent;  border-radius: 2px;  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);}.panel-body {  padding: 15px;}.panel-heading {  padding: 10px 15px;  border-bottom: 1px solid transparent;  border-top-right-radius: 1px;  border-top-left-radius: 1px;}.panel-heading > .dropdown .dropdown-toggle {  color: inherit;}.panel-title {  margin-top: 0;  margin-bottom: 0;  font-size: 15px;  color: inherit;}.panel-title > a,.panel-title > small,.panel-title > .small,.panel-title > small > a,.panel-title > .small > a {  color: inherit;}.panel-footer {  padding: 10px 15px;  background-color: #f5f5f5;  border-top: 1px solid #ddd;  border-bottom-right-radius: 1px;  border-bottom-left-radius: 1px;}.panel > .list-group,.panel > .panel-collapse > .list-group {  margin-bottom: 0;}.panel > .list-group .list-group-item,.panel > .panel-collapse > .list-group .list-group-item {  border-width: 1px 0;  border-radius: 0;}.panel > .list-group:first-child .list-group-item:first-child,.panel > .panel-collapse > .list-group:first-child .list-group-item:first-child {  border-top: 0;  border-top-right-radius: 1px;  border-top-left-radius: 1px;}.panel > .list-group:last-child .list-group-item:last-child,.panel > .panel-collapse > .list-group:last-child .list-group-item:last-child {  border-bottom: 0;  border-bottom-right-radius: 1px;  border-bottom-left-radius: 1px;}.panel > .panel-heading + .panel-collapse > .list-group .list-group-item:first-child {  border-top-right-radius: 0;  border-top-left-radius: 0;}.panel-heading + .list-group .list-group-item:first-child {  border-top-width: 0;}.list-group + .panel-footer {  border-top-width: 0;}.panel > .table,.panel > .table-responsive > .table,.panel > .panel-collapse > .table {  margin-bottom: 0;}.panel > .table caption,.panel > .table-responsive > .table caption,.panel > .panel-collapse > .table caption {  padding-left: 15px;  padding-right: 15px;}.panel > .table:first-child,.panel > .table-responsive:first-child > .table:first-child {  border-top-right-radius: 1px;  border-top-left-radius: 1px;}.panel > .table:first-child > thead:first-child > tr:first-child,.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child,.panel > .table:first-child > tbody:first-child > tr:first-child,.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child {  border-top-left-radius: 1px;  border-top-right-radius: 1px;}.panel > .table:first-child > thead:first-child > tr:first-child td:first-child,.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:first-child,.panel > .table:first-child > tbody:first-child > tr:first-child td:first-child,.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:first-child,.panel > .table:first-child > thead:first-child > tr:first-child th:first-child,.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:first-child,.panel > .table:first-child > tbody:first-child > tr:first-child th:first-child,.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:first-child {  border-top-left-radius: 1px;}.panel > .table:first-child > thead:first-child > tr:first-child td:last-child,.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:last-child,.panel > .table:first-child > tbody:first-child > tr:first-child td:last-child,.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:last-child,.panel > .table:first-child > thead:first-child > tr:first-child th:last-child,.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:last-child,.panel > .table:first-child > tbody:first-child > tr:first-child th:last-child,.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:last-child {  border-top-right-radius: 1px;}.panel > .table:last-child,.panel > .table-responsive:last-child > .table:last-child {  border-bottom-right-radius: 1px;  border-bottom-left-radius: 1px;}.panel > .table:last-child > tbody:last-child > tr:last-child,.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child,.panel > .table:last-child > tfoot:last-child > tr:last-child,.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child {  border-bottom-left-radius: 1px;  border-bottom-right-radius: 1px;}.panel > .table:last-child > tbody:last-child > tr:last-child td:first-child,.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:first-child,.panel > .table:last-child > tfoot:last-child > tr:last-child td:first-child,.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:first-child,.panel > .table:last-child > tbody:last-child > tr:last-child th:first-child,.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:first-child,.panel > .table:last-child > tfoot:last-child > tr:last-child th:first-child,.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:first-child {  border-bottom-left-radius: 1px;}.panel > .table:last-child > tbody:last-child > tr:last-child td:last-child,.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:last-child,.panel > .table:last-child > tfoot:last-child > tr:last-child td:last-child,.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:last-child,.panel > .table:last-child > tbody:last-child > tr:last-child th:last-child,.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:last-child,.panel > .table:last-child > tfoot:last-child > tr:last-child th:last-child,.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:last-child {  border-bottom-right-radius: 1px;}.panel > .panel-body + .table,.panel > .panel-body + .table-responsive,.panel > .table + .panel-body,.panel > .table-responsive + .panel-body {  border-top: 1px solid #ddd;}.panel > .table > tbody:first-child > tr:first-child th,.panel > .table > tbody:first-child > tr:first-child td {  border-top: 0;}.panel > .table-bordered,.panel > .table-responsive > .table-bordered {  border: 0;}.panel > .table-bordered > thead > tr > th:first-child,.panel > .table-responsive > .table-bordered > thead > tr > th:first-child,.panel > .table-bordered > tbody > tr > th:first-child,.panel > .table-responsive > .table-bordered > tbody > tr > th:first-child,.panel > .table-bordered > tfoot > tr > th:first-child,.panel > .table-responsive > .table-bordered > tfoot > tr > th:first-child,.panel > .table-bordered > thead > tr > td:first-child,.panel > .table-responsive > .table-bordered > thead > tr > td:first-child,.panel > .table-bordered > tbody > tr > td:first-child,.panel > .table-responsive > .table-bordered > tbody > tr > td:first-child,.panel > .table-bordered > tfoot > tr > td:first-child,.panel > .table-responsive > .table-bordered > tfoot > tr > td:first-child {  border-left: 0;}.panel > .table-bordered > thead > tr > th:last-child,.panel > .table-responsive > .table-bordered > thead > tr > th:last-child,.panel > .table-bordered > tbody > tr > th:last-child,.panel > .table-responsive > .table-bordered > tbody > tr > th:last-child,.panel > .table-bordered > tfoot > tr > th:last-child,.panel > .table-responsive > .table-bordered > tfoot > tr > th:last-child,.panel > .table-bordered > thead > tr > td:last-child,.panel > .table-responsive > .table-bordered > thead > tr > td:last-child,.panel > .table-bordered > tbody > tr > td:last-child,.panel > .table-responsive > .table-bordered > tbody > tr > td:last-child,.panel > .table-bordered > tfoot > tr > td:last-child,.panel > .table-responsive > .table-bordered > tfoot > tr > td:last-child {  border-right: 0;}.panel > .table-bordered > thead > tr:first-child > td,.panel > .table-responsive > .table-bordered > thead > tr:first-child > td,.panel > .table-bordered > tbody > tr:first-child > td,.panel > .table-responsive > .table-bordered > tbody > tr:first-child > td,.panel > .table-bordered > thead > tr:first-child > th,.panel > .table-responsive > .table-bordered > thead > tr:first-child > th,.panel > .table-bordered > tbody > tr:first-child > th,.panel > .table-responsive > .table-bordered > tbody > tr:first-child > th {  border-bottom: 0;}.panel > .table-bordered > tbody > tr:last-child > td,.panel > .table-responsive > .table-bordered > tbody > tr:last-child > td,.panel > .table-bordered > tfoot > tr:last-child > td,.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > td,.panel > .table-bordered > tbody > tr:last-child > th,.panel > .table-responsive > .table-bordered > tbody > tr:last-child > th,.panel > .table-bordered > tfoot > tr:last-child > th,.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > th {  border-bottom: 0;}.panel > .table-responsive {  border: 0;  margin-bottom: 0;}.panel-group {  margin-bottom: 18px;}.panel-group .panel {  margin-bottom: 0;  border-radius: 2px;}.panel-group .panel + .panel {  margin-top: 5px;}.panel-group .panel-heading {  border-bottom: 0;}.panel-group .panel-heading + .panel-collapse > .panel-body,.panel-group .panel-heading + .panel-collapse > .list-group {  border-top: 1px solid #ddd;}.panel-group .panel-footer {  border-top: 0;}.panel-group .panel-footer + .panel-collapse .panel-body {  border-bottom: 1px solid #ddd;}.panel-default {  border-color: #ddd;}.panel-default > .panel-heading {  color: #333333;  background-color: #f5f5f5;  border-color: #ddd;}.panel-default > .panel-heading + .panel-collapse > .panel-body {  border-top-color: #ddd;}.panel-default > .panel-heading .badge {  color: #f5f5f5;  background-color: #333333;}.panel-default > .panel-footer + .panel-collapse > .panel-body {  border-bottom-color: #ddd;}.panel-primary {  border-color: #337ab7;}.panel-primary > .panel-heading {  color: #fff;  background-color: #337ab7;  border-color: #337ab7;}.panel-primary > .panel-heading + .panel-collapse > .panel-body {  border-top-color: #337ab7;}.panel-primary > .panel-heading .badge {  color: #337ab7;  background-color: #fff;}.panel-primary > .panel-footer + .panel-collapse > .panel-body {  border-bottom-color: #337ab7;}.panel-success {  border-color: #d6e9c6;}.panel-success > .panel-heading {  color: #3c763d;  background-color: #dff0d8;  border-color: #d6e9c6;}.panel-success > .panel-heading + .panel-collapse > .panel-body {  border-top-color: #d6e9c6;}.panel-success > .panel-heading .badge {  color: #dff0d8;  background-color: #3c763d;}.panel-success > .panel-footer + .panel-collapse > .panel-body {  border-bottom-color: #d6e9c6;}.panel-info {  border-color: #bce8f1;}.panel-info > .panel-heading {  color: #31708f;  background-color: #d9edf7;  border-color: #bce8f1;}.panel-info > .panel-heading + .panel-collapse > .panel-body {  border-top-color: #bce8f1;}.panel-info > .panel-heading .badge {  color: #d9edf7;  background-color: #31708f;}.panel-info > .panel-footer + .panel-collapse > .panel-body {  border-bottom-color: #bce8f1;}.panel-warning {  border-color: #faebcc;}.panel-warning > .panel-heading {  color: #8a6d3b;  background-color: #fcf8e3;  border-color: #faebcc;}.panel-warning > .panel-heading + .panel-collapse > .panel-body {  border-top-color: #faebcc;}.panel-warning > .panel-heading .badge {  color: #fcf8e3;  background-color: #8a6d3b;}.panel-warning > .panel-footer + .panel-collapse > .panel-body {  border-bottom-color: #faebcc;}.panel-danger {  border-color: #ebccd1;}.panel-danger > .panel-heading {  color: #a94442;  background-color: #f2dede;  border-color: #ebccd1;}.panel-danger > .panel-heading + .panel-collapse > .panel-body {  border-top-color: #ebccd1;}.panel-danger > .panel-heading .badge {  color: #f2dede;  background-color: #a94442;}.panel-danger > .panel-footer + .panel-collapse > .panel-body {  border-bottom-color: #ebccd1;}.embed-responsive {  position: relative;  display: block;  height: 0;  padding: 0;  overflow: hidden;}.embed-responsive .embed-responsive-item,.embed-responsive iframe,.embed-responsive embed,.embed-responsive object,.embed-responsive video {  position: absolute;  top: 0;  left: 0;  bottom: 0;  height: 100%;  width: 100%;  border: 0;}.embed-responsive-16by9 {  padding-bottom: 56.25%;}.embed-responsive-4by3 {  padding-bottom: 75%;}.well {  min-height: 20px;  padding: 19px;  margin-bottom: 20px;  background-color: #f5f5f5;  border: 1px solid #e3e3e3;  border-radius: 2px;  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);}.well blockquote {  border-color: #ddd;  border-color: rgba(0, 0, 0, 0.15);}.well-lg {  padding: 24px;  border-radius: 3px;}.well-sm {  padding: 9px;  border-radius: 1px;}.close {  float: right;  font-size: 19.5px;  font-weight: bold;  line-height: 1;  color: #000;  text-shadow: 0 1px 0 #fff;  opacity: 0.2;  filter: alpha(opacity=20);}.close:hover,.close:focus {  color: #000;  text-decoration: none;  cursor: pointer;  opacity: 0.5;  filter: alpha(opacity=50);}button.close {  padding: 0;  cursor: pointer;  background: transparent;  border: 0;  -webkit-appearance: none;}.modal-open {  overflow: hidden;}.modal {  display: none;  overflow: hidden;  position: fixed;  top: 0;  right: 0;  bottom: 0;  left: 0;  z-index: 1050;  -webkit-overflow-scrolling: touch;  outline: 0;}.modal.fade .modal-dialog {  -webkit-transform: translate(0, -25%);  -ms-transform: translate(0, -25%);  -o-transform: translate(0, -25%);  transform: translate(0, -25%);  -webkit-transition: -webkit-transform 0.3s ease-out;  -moz-transition: -moz-transform 0.3s ease-out;  -o-transition: -o-transform 0.3s ease-out;  transition: transform 0.3s ease-out;}.modal.in .modal-dialog {  -webkit-transform: translate(0, 0);  -ms-transform: translate(0, 0);  -o-transform: translate(0, 0);  transform: translate(0, 0);}.modal-open .modal {  overflow-x: hidden;  overflow-y: auto;}.modal-dialog {  position: relative;  width: auto;  margin: 10px;}.modal-content {  position: relative;  background-color: #fff;  border: 1px solid #999;  border: 1px solid rgba(0, 0, 0, 0.2);  border-radius: 3px;  -webkit-box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);  box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);  background-clip: padding-box;  outline: 0;}.modal-backdrop {  position: fixed;  top: 0;  right: 0;  bottom: 0;  left: 0;  z-index: 1040;  background-color: #000;}.modal-backdrop.fade {  opacity: 0;  filter: alpha(opacity=0);}.modal-backdrop.in {  opacity: 0.5;  filter: alpha(opacity=50);}.modal-header {  padding: 15px;  border-bottom: 1px solid #e5e5e5;}.modal-header .close {  margin-top: -2px;}.modal-title {  margin: 0;  line-height: 1.42857143;}.modal-body {  position: relative;  padding: 15px;}.modal-footer {  padding: 15px;  text-align: right;  border-top: 1px solid #e5e5e5;}.modal-footer .btn + .btn {  margin-left: 5px;  margin-bottom: 0;}.modal-footer .btn-group .btn + .btn {  margin-left: -1px;}.modal-footer .btn-block + .btn-block {  margin-left: 0;}.modal-scrollbar-measure {  position: absolute;  top: -9999px;  width: 50px;  height: 50px;  overflow: scroll;}@media (min-width: 768px) {  .modal-dialog {    width: 600px;    margin: 30px auto;  }  .modal-content {    -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);  }  .modal-sm {    width: 300px;  }}@media (min-width: 992px) {  .modal-lg {    width: 900px;  }}.tooltip {  position: absolute;  z-index: 1070;  display: block;  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;  font-style: normal;  font-weight: normal;  letter-spacing: normal;  line-break: auto;  line-height: 1.42857143;  text-align: left;  text-align: start;  text-decoration: none;  text-shadow: none;  text-transform: none;  white-space: normal;  word-break: normal;  word-spacing: normal;  word-wrap: normal;  font-size: 12px;  opacity: 0;  filter: alpha(opacity=0);}.tooltip.in {  opacity: 0.9;  filter: alpha(opacity=90);}.tooltip.top {  margin-top: -3px;  padding: 5px 0;}.tooltip.right {  margin-left: 3px;  padding: 0 5px;}.tooltip.bottom {  margin-top: 3px;  padding: 5px 0;}.tooltip.left {  margin-left: -3px;  padding: 0 5px;}.tooltip-inner {  max-width: 200px;  padding: 3px 8px;  color: #fff;  text-align: center;  background-color: #000;  border-radius: 2px;}.tooltip-arrow {  position: absolute;  width: 0;  height: 0;  border-color: transparent;  border-style: solid;}.tooltip.top .tooltip-arrow {  bottom: 0;  left: 50%;  margin-left: -5px;  border-width: 5px 5px 0;  border-top-color: #000;}.tooltip.top-left .tooltip-arrow {  bottom: 0;  right: 5px;  margin-bottom: -5px;  border-width: 5px 5px 0;  border-top-color: #000;}.tooltip.top-right .tooltip-arrow {  bottom: 0;  left: 5px;  margin-bottom: -5px;  border-width: 5px 5px 0;  border-top-color: #000;}.tooltip.right .tooltip-arrow {  top: 50%;  left: 0;  margin-top: -5px;  border-width: 5px 5px 5px 0;  border-right-color: #000;}.tooltip.left .tooltip-arrow {  top: 50%;  right: 0;  margin-top: -5px;  border-width: 5px 0 5px 5px;  border-left-color: #000;}.tooltip.bottom .tooltip-arrow {  top: 0;  left: 50%;  margin-left: -5px;  border-width: 0 5px 5px;  border-bottom-color: #000;}.tooltip.bottom-left .tooltip-arrow {  top: 0;  right: 5px;  margin-top: -5px;  border-width: 0 5px 5px;  border-bottom-color: #000;}.tooltip.bottom-right .tooltip-arrow {  top: 0;  left: 5px;  margin-top: -5px;  border-width: 0 5px 5px;  border-bottom-color: #000;}.popover {  position: absolute;  top: 0;  left: 0;  z-index: 1060;  display: none;  max-width: 276px;  padding: 1px;  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;  font-style: normal;  font-weight: normal;  letter-spacing: normal;  line-break: auto;  line-height: 1.42857143;  text-align: left;  text-align: start;  text-decoration: none;  text-shadow: none;  text-transform: none;  white-space: normal;  word-break: normal;  word-spacing: normal;  word-wrap: normal;  font-size: 13px;  background-color: #fff;  background-clip: padding-box;  border: 1px solid #ccc;  border: 1px solid rgba(0, 0, 0, 0.2);  border-radius: 3px;  -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);}.popover.top {  margin-top: -10px;}.popover.right {  margin-left: 10px;}.popover.bottom {  margin-top: 10px;}.popover.left {  margin-left: -10px;}.popover-title {  margin: 0;  padding: 8px 14px;  font-size: 13px;  background-color: #f7f7f7;  border-bottom: 1px solid #ebebeb;  border-radius: 2px 2px 0 0;}.popover-content {  padding: 9px 14px;}.popover > .arrow,.popover > .arrow:after {  position: absolute;  display: block;  width: 0;  height: 0;  border-color: transparent;  border-style: solid;}.popover > .arrow {  border-width: 11px;}.popover > .arrow:after {  border-width: 10px;  content: '';}.popover.top > .arrow {  left: 50%;  margin-left: -11px;  border-bottom-width: 0;  border-top-color: #999999;  border-top-color: rgba(0, 0, 0, 0.25);  bottom: -11px;}.popover.top > .arrow:after {  content: ' ';  bottom: 1px;  margin-left: -10px;  border-bottom-width: 0;  border-top-color: #fff;}.popover.right > .arrow {  top: 50%;  left: -11px;  margin-top: -11px;  border-left-width: 0;  border-right-color: #999999;  border-right-color: rgba(0, 0, 0, 0.25);}.popover.right > .arrow:after {  content: ' ';  left: 1px;  bottom: -10px;  border-left-width: 0;  border-right-color: #fff;}.popover.bottom > .arrow {  left: 50%;  margin-left: -11px;  border-top-width: 0;  border-bottom-color: #999999;  border-bottom-color: rgba(0, 0, 0, 0.25);  top: -11px;}.popover.bottom > .arrow:after {  content: ' ';  top: 1px;  margin-left: -10px;  border-top-width: 0;  border-bottom-color: #fff;}.popover.left > .arrow {  top: 50%;  right: -11px;  margin-top: -11px;  border-right-width: 0;  border-left-color: #999999;  border-left-color: rgba(0, 0, 0, 0.25);}.popover.left > .arrow:after {  content: ' ';  right: 1px;  border-right-width: 0;  border-left-color: #fff;  bottom: -10px;}.carousel {  position: relative;}.carousel-inner {  position: relative;  overflow: hidden;  width: 100%;}.carousel-inner > .item {  display: none;  position: relative;  -webkit-transition: 0.6s ease-in-out left;  -o-transition: 0.6s ease-in-out left;  transition: 0.6s ease-in-out left;}.carousel-inner > .item > img,.carousel-inner > .item > a > img {  line-height: 1;}@media all and (transform-3d), (-webkit-transform-3d) {  .carousel-inner > .item {    -webkit-transition: -webkit-transform 0.6s ease-in-out;    -moz-transition: -moz-transform 0.6s ease-in-out;    -o-transition: -o-transform 0.6s ease-in-out;    transition: transform 0.6s ease-in-out;    -webkit-backface-visibility: hidden;    -moz-backface-visibility: hidden;    backface-visibility: hidden;    -webkit-perspective: 1000px;    -moz-perspective: 1000px;    perspective: 1000px;  }  .carousel-inner > .item.next,  .carousel-inner > .item.active.right {    -webkit-transform: translate3d(100%, 0, 0);    transform: translate3d(100%, 0, 0);    left: 0;  }  .carousel-inner > .item.prev,  .carousel-inner > .item.active.left {    -webkit-transform: translate3d(-100%, 0, 0);    transform: translate3d(-100%, 0, 0);    left: 0;  }  .carousel-inner > .item.next.left,  .carousel-inner > .item.prev.right,  .carousel-inner > .item.active {    -webkit-transform: translate3d(0, 0, 0);    transform: translate3d(0, 0, 0);    left: 0;  }}.carousel-inner > .active,.carousel-inner > .next,.carousel-inner > .prev {  display: block;}.carousel-inner > .active {  left: 0;}.carousel-inner > .next,.carousel-inner > .prev {  position: absolute;  top: 0;  width: 100%;}.carousel-inner > .next {  left: 100%;}.carousel-inner > .prev {  left: -100%;}.carousel-inner > .next.left,.carousel-inner > .prev.right {  left: 0;}.carousel-inner > .active.left {  left: -100%;}.carousel-inner > .active.right {  left: 100%;}.carousel-control {  position: absolute;  top: 0;  left: 0;  bottom: 0;  width: 15%;  opacity: 0.5;  filter: alpha(opacity=50);  font-size: 20px;  color: #fff;  text-align: center;  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);  background-color: rgba(0, 0, 0, 0);}.carousel-control.left {  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);  background-repeat: repeat-x;  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);}.carousel-control.right {  left: auto;  right: 0;  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);  background-repeat: repeat-x;  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);}.carousel-control:hover,.carousel-control:focus {  outline: 0;  color: #fff;  text-decoration: none;  opacity: 0.9;  filter: alpha(opacity=90);}.carousel-control .icon-prev,.carousel-control .icon-next,.carousel-control .glyphicon-chevron-left,.carousel-control .glyphicon-chevron-right {  position: absolute;  top: 50%;  margin-top: -10px;  z-index: 5;  display: inline-block;}.carousel-control .icon-prev,.carousel-control .glyphicon-chevron-left {  left: 50%;  margin-left: -10px;}.carousel-control .icon-next,.carousel-control .glyphicon-chevron-right {  right: 50%;  margin-right: -10px;}.carousel-control .icon-prev,.carousel-control .icon-next {  width: 20px;  height: 20px;  line-height: 1;  font-family: serif;}.carousel-control .icon-prev:before {  content: '\2039';}.carousel-control .icon-next:before {  content: '\203a';}.carousel-indicators {  position: absolute;  bottom: 10px;  left: 50%;  z-index: 15;  width: 60%;  margin-left: -30%;  padding-left: 0;  list-style: none;  text-align: center;}.carousel-indicators li {  display: inline-block;  width: 10px;  height: 10px;  margin: 1px;  text-indent: -999px;  border: 1px solid #fff;  border-radius: 10px;  cursor: pointer;  background-color: #000 \9;  background-color: rgba(0, 0, 0, 0);}.carousel-indicators .active {  margin: 0;  width: 12px;  height: 12px;  background-color: #fff;}.carousel-caption {  position: absolute;  left: 15%;  right: 15%;  bottom: 20px;  z-index: 10;  padding-top: 20px;  padding-bottom: 20px;  color: #fff;  text-align: center;  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);}.carousel-caption .btn {  text-shadow: none;}@media screen and (min-width: 768px) {  .carousel-control .glyphicon-chevron-left,  .carousel-control .glyphicon-chevron-right,  .carousel-control .icon-prev,  .carousel-control .icon-next {    width: 30px;    height: 30px;    margin-top: -10px;    font-size: 30px;  }  .carousel-control .glyphicon-chevron-left,  .carousel-control .icon-prev {    margin-left: -10px;  }  .carousel-control .glyphicon-chevron-right,  .carousel-control .icon-next {    margin-right: -10px;  }  .carousel-caption {    left: 20%;    right: 20%;    padding-bottom: 30px;  }  .carousel-indicators {    bottom: 20px;  }}.clearfix:before,.clearfix:after,.dl-horizontal dd:before,.dl-horizontal dd:after,.container:before,.container:after,.container-fluid:before,.container-fluid:after,.row:before,.row:after,.form-horizontal .form-group:before,.form-horizontal .form-group:after,.btn-toolbar:before,.btn-toolbar:after,.btn-group-vertical > .btn-group:before,.btn-group-vertical > .btn-group:after,.nav:before,.nav:after,.navbar:before,.navbar:after,.navbar-header:before,.navbar-header:after,.navbar-collapse:before,.navbar-collapse:after,.pager:before,.pager:after,.panel-body:before,.panel-body:after,.modal-header:before,.modal-header:after,.modal-footer:before,.modal-footer:after,.item_buttons:before,.item_buttons:after {  content: ' ';  display: table;}.clearfix:after,.dl-horizontal dd:after,.container:after,.container-fluid:after,.row:after,.form-horizontal .form-group:after,.btn-toolbar:after,.btn-group-vertical > .btn-group:after,.nav:after,.navbar:after,.navbar-header:after,.navbar-collapse:after,.pager:after,.panel-body:after,.modal-header:after,.modal-footer:after,.item_buttons:after {  clear: both;}.center-block {  display: block;  margin-left: auto;  margin-right: auto;}.pull-right {  float: right !important;}.pull-left {  float: left !important;}.hide {  display: none !important;}.show {  display: block !important;}.invisible {  visibility: hidden;}.text-hide {  font: 0/0 a;  color: transparent;  text-shadow: none;  background-color: transparent;  border: 0;}.hidden {  display: none !important;}.affix {  position: fixed;}@-ms-viewport {  width: device-width;}.visible-xs,.visible-sm,.visible-md,.visible-lg {  display: none !important;}.visible-xs-block,.visible-xs-inline,.visible-xs-inline-block,.visible-sm-block,.visible-sm-inline,.visible-sm-inline-block,.visible-md-block,.visible-md-inline,.visible-md-inline-block,.visible-lg-block,.visible-lg-inline,.visible-lg-inline-block {  display: none !important;}@media (max-width: 767px) {  .visible-xs {    display: block !important;  }  table.visible-xs {    display: table !important;  }  tr.visible-xs {    display: table-row !important;  }  th.visible-xs,  td.visible-xs {    display: table-cell !important;  }}@media (max-width: 767px) {  .visible-xs-block {    display: block !important;  }}@media (max-width: 767px) {  .visible-xs-inline {    display: inline !important;  }}@media (max-width: 767px) {  .visible-xs-inline-block {    display: inline-block !important;  }}@media (min-width: 768px) and (max-width: 991px) {  .visible-sm {    display: block !important;  }  table.visible-sm {    display: table !important;  }  tr.visible-sm {    display: table-row !important;  }  th.visible-sm,  td.visible-sm {    display: table-cell !important;  }}@media (min-width: 768px) and (max-width: 991px) {  .visible-sm-block {    display: block !important;  }}@media (min-width: 768px) and (max-width: 991px) {  .visible-sm-inline {    display: inline !important;  }}@media (min-width: 768px) and (max-width: 991px) {  .visible-sm-inline-block {    display: inline-block !important;  }}@media (min-width: 992px) and (max-width: 1199px) {  .visible-md {    display: block !important;  }  table.visible-md {    display: table !important;  }  tr.visible-md {    display: table-row !important;  }  th.visible-md,  td.visible-md {    display: table-cell !important;  }}@media (min-width: 992px) and (max-width: 1199px) {  .visible-md-block {    display: block !important;  }}@media (min-width: 992px) and (max-width: 1199px) {  .visible-md-inline {    display: inline !important;  }}@media (min-width: 992px) and (max-width: 1199px) {  .visible-md-inline-block {    display: inline-block !important;  }}@media (min-width: 1200px) {  .visible-lg {    display: block !important;  }  table.visible-lg {    display: table !important;  }  tr.visible-lg {    display: table-row !important;  }  th.visible-lg,  td.visible-lg {    display: table-cell !important;  }}@media (min-width: 1200px) {  .visible-lg-block {    display: block !important;  }}@media (min-width: 1200px) {  .visible-lg-inline {    display: inline !important;  }}@media (min-width: 1200px) {  .visible-lg-inline-block {    display: inline-block !important;  }}@media (max-width: 767px) {  .hidden-xs {    display: none !important;  }}@media (min-width: 768px) and (max-width: 991px) {  .hidden-sm {    display: none !important;  }}@media (min-width: 992px) and (max-width: 1199px) {  .hidden-md {    display: none !important;  }}@media (min-width: 1200px) {  .hidden-lg {    display: none !important;  }}.visible-print {  display: none !important;}@media print {  .visible-print {    display: block !important;  }  table.visible-print {    display: table !important;  }  tr.visible-print {    display: table-row !important;  }  th.visible-print,  td.visible-print {    display: table-cell !important;  }}.visible-print-block {  display: none !important;}@media print {  .visible-print-block {    display: block !important;  }}.visible-print-inline {  display: none !important;}@media print {  .visible-print-inline {    display: inline !important;  }}.visible-print-inline-block {  display: none !important;}@media print {  .visible-print-inline-block {    display: inline-block !important;  }}@media print {  .hidden-print {    display: none !important;  }}/*!** Font Awesome**//*! *  Font Awesome 4.7.0 by @davegandy - http://fontawesome.io - @fontawesome *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License) *//* FONT PATH * -------------------------- */@font-face {  font-family: 'FontAwesome';  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?v=4.7.0');  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?#iefix&v=4.7.0') format('embedded-opentype'), url('../components/font-awesome/fonts/fontawesome-webfont.woff2?v=4.7.0') format('woff2'), url('../components/font-awesome/fonts/fontawesome-webfont.woff?v=4.7.0') format('woff'), url('../components/font-awesome/fonts/fontawesome-webfont.ttf?v=4.7.0') format('truetype'), url('../components/font-awesome/fonts/fontawesome-webfont.svg?v=4.7.0#fontawesomeregular') format('svg');  font-weight: normal;  font-style: normal;}.fa {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;}/* makes the font 33% larger relative to the icon container */.fa-lg {  font-size: 1.33333333em;  line-height: 0.75em;  vertical-align: -15%;}.fa-2x {  font-size: 2em;}.fa-3x {  font-size: 3em;}.fa-4x {  font-size: 4em;}.fa-5x {  font-size: 5em;}.fa-fw {  width: 1.28571429em;  text-align: center;}.fa-ul {  padding-left: 0;  margin-left: 2.14285714em;  list-style-type: none;}.fa-ul > li {  position: relative;}.fa-li {  position: absolute;  left: -2.14285714em;  width: 2.14285714em;  top: 0.14285714em;  text-align: center;}.fa-li.fa-lg {  left: -1.85714286em;}.fa-border {  padding: .2em .25em .15em;  border: solid 0.08em #eee;  border-radius: .1em;}.fa-pull-left {  float: left;}.fa-pull-right {  float: right;}.fa.fa-pull-left {  margin-right: .3em;}.fa.fa-pull-right {  margin-left: .3em;}/* Deprecated as of 4.4.0 */.pull-right {  float: right;}.pull-left {  float: left;}.fa.pull-left {  margin-right: .3em;}.fa.pull-right {  margin-left: .3em;}.fa-spin {  -webkit-animation: fa-spin 2s infinite linear;  animation: fa-spin 2s infinite linear;}.fa-pulse {  -webkit-animation: fa-spin 1s infinite steps(8);  animation: fa-spin 1s infinite steps(8);}@-webkit-keyframes fa-spin {  0% {    -webkit-transform: rotate(0deg);    transform: rotate(0deg);  }  100% {    -webkit-transform: rotate(359deg);    transform: rotate(359deg);  }}@keyframes fa-spin {  0% {    -webkit-transform: rotate(0deg);    transform: rotate(0deg);  }  100% {    -webkit-transform: rotate(359deg);    transform: rotate(359deg);  }}.fa-rotate-90 {  -ms-filter: 'progid:DXImageTransform.Microsoft.BasicImage(rotation=1)';  -webkit-transform: rotate(90deg);  -ms-transform: rotate(90deg);  transform: rotate(90deg);}.fa-rotate-180 {  -ms-filter: 'progid:DXImageTransform.Microsoft.BasicImage(rotation=2)';  -webkit-transform: rotate(180deg);  -ms-transform: rotate(180deg);  transform: rotate(180deg);}.fa-rotate-270 {  -ms-filter: 'progid:DXImageTransform.Microsoft.BasicImage(rotation=3)';  -webkit-transform: rotate(270deg);  -ms-transform: rotate(270deg);  transform: rotate(270deg);}.fa-flip-horizontal {  -ms-filter: 'progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)';  -webkit-transform: scale(-1, 1);  -ms-transform: scale(-1, 1);  transform: scale(-1, 1);}.fa-flip-vertical {  -ms-filter: 'progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)';  -webkit-transform: scale(1, -1);  -ms-transform: scale(1, -1);  transform: scale(1, -1);}:root .fa-rotate-90,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-flip-horizontal,:root .fa-flip-vertical {  filter: none;}.fa-stack {  position: relative;  display: inline-block;  width: 2em;  height: 2em;  line-height: 2em;  vertical-align: middle;}.fa-stack-1x,.fa-stack-2x {  position: absolute;  left: 0;  width: 100%;  text-align: center;}.fa-stack-1x {  line-height: inherit;}.fa-stack-2x {  font-size: 2em;}.fa-inverse {  color: #fff;}/* Font Awesome uses the Unicode Private Use Area (PUA) to ensure screen   readers do not read off random characters that represent icons */.fa-glass:before {  content: '\f000';}.fa-music:before {  content: '\f001';}.fa-search:before {  content: '\f002';}.fa-envelope-o:before {  content: '\f003';}.fa-heart:before {  content: '\f004';}.fa-star:before {  content: '\f005';}.fa-star-o:before {  content: '\f006';}.fa-user:before {  content: '\f007';}.fa-film:before {  content: '\f008';}.fa-th-large:before {  content: '\f009';}.fa-th:before {  content: '\f00a';}.fa-th-list:before {  content: '\f00b';}.fa-check:before {  content: '\f00c';}.fa-remove:before,.fa-close:before,.fa-times:before {  content: '\f00d';}.fa-search-plus:before {  content: '\f00e';}.fa-search-minus:before {  content: '\f010';}.fa-power-off:before {  content: '\f011';}.fa-signal:before {  content: '\f012';}.fa-gear:before,.fa-cog:before {  content: '\f013';}.fa-trash-o:before {  content: '\f014';}.fa-home:before {  content: '\f015';}.fa-file-o:before {  content: '\f016';}.fa-clock-o:before {  content: '\f017';}.fa-road:before {  content: '\f018';}.fa-download:before {  content: '\f019';}.fa-arrow-circle-o-down:before {  content: '\f01a';}.fa-arrow-circle-o-up:before {  content: '\f01b';}.fa-inbox:before {  content: '\f01c';}.fa-play-circle-o:before {  content: '\f01d';}.fa-rotate-right:before,.fa-repeat:before {  content: '\f01e';}.fa-refresh:before {  content: '\f021';}.fa-list-alt:before {  content: '\f022';}.fa-lock:before {  content: '\f023';}.fa-flag:before {  content: '\f024';}.fa-headphones:before {  content: '\f025';}.fa-volume-off:before {  content: '\f026';}.fa-volume-down:before {  content: '\f027';}.fa-volume-up:before {  content: '\f028';}.fa-qrcode:before {  content: '\f029';}.fa-barcode:before {  content: '\f02a';}.fa-tag:before {  content: '\f02b';}.fa-tags:before {  content: '\f02c';}.fa-book:before {  content: '\f02d';}.fa-bookmark:before {  content: '\f02e';}.fa-print:before {  content: '\f02f';}.fa-camera:before {  content: '\f030';}.fa-font:before {  content: '\f031';}.fa-bold:before {  content: '\f032';}.fa-italic:before {  content: '\f033';}.fa-text-height:before {  content: '\f034';}.fa-text-width:before {  content: '\f035';}.fa-align-left:before {  content: '\f036';}.fa-align-center:before {  content: '\f037';}.fa-align-right:before {  content: '\f038';}.fa-align-justify:before {  content: '\f039';}.fa-list:before {  content: '\f03a';}.fa-dedent:before,.fa-outdent:before {  content: '\f03b';}.fa-indent:before {  content: '\f03c';}.fa-video-camera:before {  content: '\f03d';}.fa-photo:before,.fa-image:before,.fa-picture-o:before {  content: '\f03e';}.fa-pencil:before {  content: '\f040';}.fa-map-marker:before {  content: '\f041';}.fa-adjust:before {  content: '\f042';}.fa-tint:before {  content: '\f043';}.fa-edit:before,.fa-pencil-square-o:before {  content: '\f044';}.fa-share-square-o:before {  content: '\f045';}.fa-check-square-o:before {  content: '\f046';}.fa-arrows:before {  content: '\f047';}.fa-step-backward:before {  content: '\f048';}.fa-fast-backward:before {  content: '\f049';}.fa-backward:before {  content: '\f04a';}.fa-play:before {  content: '\f04b';}.fa-pause:before {  content: '\f04c';}.fa-stop:before {  content: '\f04d';}.fa-forward:before {  content: '\f04e';}.fa-fast-forward:before {  content: '\f050';}.fa-step-forward:before {  content: '\f051';}.fa-eject:before {  content: '\f052';}.fa-chevron-left:before {  content: '\f053';}.fa-chevron-right:before {  content: '\f054';}.fa-plus-circle:before {  content: '\f055';}.fa-minus-circle:before {  content: '\f056';}.fa-times-circle:before {  content: '\f057';}.fa-check-circle:before {  content: '\f058';}.fa-question-circle:before {  content: '\f059';}.fa-info-circle:before {  content: '\f05a';}.fa-crosshairs:before {  content: '\f05b';}.fa-times-circle-o:before {  content: '\f05c';}.fa-check-circle-o:before {  content: '\f05d';}.fa-ban:before {  content: '\f05e';}.fa-arrow-left:before {  content: '\f060';}.fa-arrow-right:before {  content: '\f061';}.fa-arrow-up:before {  content: '\f062';}.fa-arrow-down:before {  content: '\f063';}.fa-mail-forward:before,.fa-share:before {  content: '\f064';}.fa-expand:before {  content: '\f065';}.fa-compress:before {  content: '\f066';}.fa-plus:before {  content: '\f067';}.fa-minus:before {  content: '\f068';}.fa-asterisk:before {  content: '\f069';}.fa-exclamation-circle:before {  content: '\f06a';}.fa-gift:before {  content: '\f06b';}.fa-leaf:before {  content: '\f06c';}.fa-fire:before {  content: '\f06d';}.fa-eye:before {  content: '\f06e';}.fa-eye-slash:before {  content: '\f070';}.fa-warning:before,.fa-exclamation-triangle:before {  content: '\f071';}.fa-plane:before {  content: '\f072';}.fa-calendar:before {  content: '\f073';}.fa-random:before {  content: '\f074';}.fa-comment:before {  content: '\f075';}.fa-magnet:before {  content: '\f076';}.fa-chevron-up:before {  content: '\f077';}.fa-chevron-down:before {  content: '\f078';}.fa-retweet:before {  content: '\f079';}.fa-shopping-cart:before {  content: '\f07a';}.fa-folder:before {  content: '\f07b';}.fa-folder-open:before {  content: '\f07c';}.fa-arrows-v:before {  content: '\f07d';}.fa-arrows-h:before {  content: '\f07e';}.fa-bar-chart-o:before,.fa-bar-chart:before {  content: '\f080';}.fa-twitter-square:before {  content: '\f081';}.fa-facebook-square:before {  content: '\f082';}.fa-camera-retro:before {  content: '\f083';}.fa-key:before {  content: '\f084';}.fa-gears:before,.fa-cogs:before {  content: '\f085';}.fa-comments:before {  content: '\f086';}.fa-thumbs-o-up:before {  content: '\f087';}.fa-thumbs-o-down:before {  content: '\f088';}.fa-star-half:before {  content: '\f089';}.fa-heart-o:before {  content: '\f08a';}.fa-sign-out:before {  content: '\f08b';}.fa-linkedin-square:before {  content: '\f08c';}.fa-thumb-tack:before {  content: '\f08d';}.fa-external-link:before {  content: '\f08e';}.fa-sign-in:before {  content: '\f090';}.fa-trophy:before {  content: '\f091';}.fa-github-square:before {  content: '\f092';}.fa-upload:before {  content: '\f093';}.fa-lemon-o:before {  content: '\f094';}.fa-phone:before {  content: '\f095';}.fa-square-o:before {  content: '\f096';}.fa-bookmark-o:before {  content: '\f097';}.fa-phone-square:before {  content: '\f098';}.fa-twitter:before {  content: '\f099';}.fa-facebook-f:before,.fa-facebook:before {  content: '\f09a';}.fa-github:before {  content: '\f09b';}.fa-unlock:before {  content: '\f09c';}.fa-credit-card:before {  content: '\f09d';}.fa-feed:before,.fa-rss:before {  content: '\f09e';}.fa-hdd-o:before {  content: '\f0a0';}.fa-bullhorn:before {  content: '\f0a1';}.fa-bell:before {  content: '\f0f3';}.fa-certificate:before {  content: '\f0a3';}.fa-hand-o-right:before {  content: '\f0a4';}.fa-hand-o-left:before {  content: '\f0a5';}.fa-hand-o-up:before {  content: '\f0a6';}.fa-hand-o-down:before {  content: '\f0a7';}.fa-arrow-circle-left:before {  content: '\f0a8';}.fa-arrow-circle-right:before {  content: '\f0a9';}.fa-arrow-circle-up:before {  content: '\f0aa';}.fa-arrow-circle-down:before {  content: '\f0ab';}.fa-globe:before {  content: '\f0ac';}.fa-wrench:before {  content: '\f0ad';}.fa-tasks:before {  content: '\f0ae';}.fa-filter:before {  content: '\f0b0';}.fa-briefcase:before {  content: '\f0b1';}.fa-arrows-alt:before {  content: '\f0b2';}.fa-group:before,.fa-users:before {  content: '\f0c0';}.fa-chain:before,.fa-link:before {  content: '\f0c1';}.fa-cloud:before {  content: '\f0c2';}.fa-flask:before {  content: '\f0c3';}.fa-cut:before,.fa-scissors:before {  content: '\f0c4';}.fa-copy:before,.fa-files-o:before {  content: '\f0c5';}.fa-paperclip:before {  content: '\f0c6';}.fa-save:before,.fa-floppy-o:before {  content: '\f0c7';}.fa-square:before {  content: '\f0c8';}.fa-navicon:before,.fa-reorder:before,.fa-bars:before {  content: '\f0c9';}.fa-list-ul:before {  content: '\f0ca';}.fa-list-ol:before {  content: '\f0cb';}.fa-strikethrough:before {  content: '\f0cc';}.fa-underline:before {  content: '\f0cd';}.fa-table:before {  content: '\f0ce';}.fa-magic:before {  content: '\f0d0';}.fa-truck:before {  content: '\f0d1';}.fa-pinterest:before {  content: '\f0d2';}.fa-pinterest-square:before {  content: '\f0d3';}.fa-google-plus-square:before {  content: '\f0d4';}.fa-google-plus:before {  content: '\f0d5';}.fa-money:before {  content: '\f0d6';}.fa-caret-down:before {  content: '\f0d7';}.fa-caret-up:before {  content: '\f0d8';}.fa-caret-left:before {  content: '\f0d9';}.fa-caret-right:before {  content: '\f0da';}.fa-columns:before {  content: '\f0db';}.fa-unsorted:before,.fa-sort:before {  content: '\f0dc';}.fa-sort-down:before,.fa-sort-desc:before {  content: '\f0dd';}.fa-sort-up:before,.fa-sort-asc:before {  content: '\f0de';}.fa-envelope:before {  content: '\f0e0';}.fa-linkedin:before {  content: '\f0e1';}.fa-rotate-left:before,.fa-undo:before {  content: '\f0e2';}.fa-legal:before,.fa-gavel:before {  content: '\f0e3';}.fa-dashboard:before,.fa-tachometer:before {  content: '\f0e4';}.fa-comment-o:before {  content: '\f0e5';}.fa-comments-o:before {  content: '\f0e6';}.fa-flash:before,.fa-bolt:before {  content: '\f0e7';}.fa-sitemap:before {  content: '\f0e8';}.fa-umbrella:before {  content: '\f0e9';}.fa-paste:before,.fa-clipboard:before {  content: '\f0ea';}.fa-lightbulb-o:before {  content: '\f0eb';}.fa-exchange:before {  content: '\f0ec';}.fa-cloud-download:before {  content: '\f0ed';}.fa-cloud-upload:before {  content: '\f0ee';}.fa-user-md:before {  content: '\f0f0';}.fa-stethoscope:before {  content: '\f0f1';}.fa-suitcase:before {  content: '\f0f2';}.fa-bell-o:before {  content: '\f0a2';}.fa-coffee:before {  content: '\f0f4';}.fa-cutlery:before {  content: '\f0f5';}.fa-file-text-o:before {  content: '\f0f6';}.fa-building-o:before {  content: '\f0f7';}.fa-hospital-o:before {  content: '\f0f8';}.fa-ambulance:before {  content: '\f0f9';}.fa-medkit:before {  content: '\f0fa';}.fa-fighter-jet:before {  content: '\f0fb';}.fa-beer:before {  content: '\f0fc';}.fa-h-square:before {  content: '\f0fd';}.fa-plus-square:before {  content: '\f0fe';}.fa-angle-double-left:before {  content: '\f100';}.fa-angle-double-right:before {  content: '\f101';}.fa-angle-double-up:before {  content: '\f102';}.fa-angle-double-down:before {  content: '\f103';}.fa-angle-left:before {  content: '\f104';}.fa-angle-right:before {  content: '\f105';}.fa-angle-up:before {  content: '\f106';}.fa-angle-down:before {  content: '\f107';}.fa-desktop:before {  content: '\f108';}.fa-laptop:before {  content: '\f109';}.fa-tablet:before {  content: '\f10a';}.fa-mobile-phone:before,.fa-mobile:before {  content: '\f10b';}.fa-circle-o:before {  content: '\f10c';}.fa-quote-left:before {  content: '\f10d';}.fa-quote-right:before {  content: '\f10e';}.fa-spinner:before {  content: '\f110';}.fa-circle:before {  content: '\f111';}.fa-mail-reply:before,.fa-reply:before {  content: '\f112';}.fa-github-alt:before {  content: '\f113';}.fa-folder-o:before {  content: '\f114';}.fa-folder-open-o:before {  content: '\f115';}.fa-smile-o:before {  content: '\f118';}.fa-frown-o:before {  content: '\f119';}.fa-meh-o:before {  content: '\f11a';}.fa-gamepad:before {  content: '\f11b';}.fa-keyboard-o:before {  content: '\f11c';}.fa-flag-o:before {  content: '\f11d';}.fa-flag-checkered:before {  content: '\f11e';}.fa-terminal:before {  content: '\f120';}.fa-code:before {  content: '\f121';}.fa-mail-reply-all:before,.fa-reply-all:before {  content: '\f122';}.fa-star-half-empty:before,.fa-star-half-full:before,.fa-star-half-o:before {  content: '\f123';}.fa-location-arrow:before {  content: '\f124';}.fa-crop:before {  content: '\f125';}.fa-code-fork:before {  content: '\f126';}.fa-unlink:before,.fa-chain-broken:before {  content: '\f127';}.fa-question:before {  content: '\f128';}.fa-info:before {  content: '\f129';}.fa-exclamation:before {  content: '\f12a';}.fa-superscript:before {  content: '\f12b';}.fa-subscript:before {  content: '\f12c';}.fa-eraser:before {  content: '\f12d';}.fa-puzzle-piece:before {  content: '\f12e';}.fa-microphone:before {  content: '\f130';}.fa-microphone-slash:before {  content: '\f131';}.fa-shield:before {  content: '\f132';}.fa-calendar-o:before {  content: '\f133';}.fa-fire-extinguisher:before {  content: '\f134';}.fa-rocket:before {  content: '\f135';}.fa-maxcdn:before {  content: '\f136';}.fa-chevron-circle-left:before {  content: '\f137';}.fa-chevron-circle-right:before {  content: '\f138';}.fa-chevron-circle-up:before {  content: '\f139';}.fa-chevron-circle-down:before {  content: '\f13a';}.fa-html5:before {  content: '\f13b';}.fa-css3:before {  content: '\f13c';}.fa-anchor:before {  content: '\f13d';}.fa-unlock-alt:before {  content: '\f13e';}.fa-bullseye:before {  content: '\f140';}.fa-ellipsis-h:before {  content: '\f141';}.fa-ellipsis-v:before {  content: '\f142';}.fa-rss-square:before {  content: '\f143';}.fa-play-circle:before {  content: '\f144';}.fa-ticket:before {  content: '\f145';}.fa-minus-square:before {  content: '\f146';}.fa-minus-square-o:before {  content: '\f147';}.fa-level-up:before {  content: '\f148';}.fa-level-down:before {  content: '\f149';}.fa-check-square:before {  content: '\f14a';}.fa-pencil-square:before {  content: '\f14b';}.fa-external-link-square:before {  content: '\f14c';}.fa-share-square:before {  content: '\f14d';}.fa-compass:before {  content: '\f14e';}.fa-toggle-down:before,.fa-caret-square-o-down:before {  content: '\f150';}.fa-toggle-up:before,.fa-caret-square-o-up:before {  content: '\f151';}.fa-toggle-right:before,.fa-caret-square-o-right:before {  content: '\f152';}.fa-euro:before,.fa-eur:before {  content: '\f153';}.fa-gbp:before {  content: '\f154';}.fa-dollar:before,.fa-usd:before {  content: '\f155';}.fa-rupee:before,.fa-inr:before {  content: '\f156';}.fa-cny:before,.fa-rmb:before,.fa-yen:before,.fa-jpy:before {  content: '\f157';}.fa-ruble:before,.fa-rouble:before,.fa-rub:before {  content: '\f158';}.fa-won:before,.fa-krw:before {  content: '\f159';}.fa-bitcoin:before,.fa-btc:before {  content: '\f15a';}.fa-file:before {  content: '\f15b';}.fa-file-text:before {  content: '\f15c';}.fa-sort-alpha-asc:before {  content: '\f15d';}.fa-sort-alpha-desc:before {  content: '\f15e';}.fa-sort-amount-asc:before {  content: '\f160';}.fa-sort-amount-desc:before {  content: '\f161';}.fa-sort-numeric-asc:before {  content: '\f162';}.fa-sort-numeric-desc:before {  content: '\f163';}.fa-thumbs-up:before {  content: '\f164';}.fa-thumbs-down:before {  content: '\f165';}.fa-youtube-square:before {  content: '\f166';}.fa-youtube:before {  content: '\f167';}.fa-xing:before {  content: '\f168';}.fa-xing-square:before {  content: '\f169';}.fa-youtube-play:before {  content: '\f16a';}.fa-dropbox:before {  content: '\f16b';}.fa-stack-overflow:before {  content: '\f16c';}.fa-instagram:before {  content: '\f16d';}.fa-flickr:before {  content: '\f16e';}.fa-adn:before {  content: '\f170';}.fa-bitbucket:before {  content: '\f171';}.fa-bitbucket-square:before {  content: '\f172';}.fa-tumblr:before {  content: '\f173';}.fa-tumblr-square:before {  content: '\f174';}.fa-long-arrow-down:before {  content: '\f175';}.fa-long-arrow-up:before {  content: '\f176';}.fa-long-arrow-left:before {  content: '\f177';}.fa-long-arrow-right:before {  content: '\f178';}.fa-apple:before {  content: '\f179';}.fa-windows:before {  content: '\f17a';}.fa-android:before {  content: '\f17b';}.fa-linux:before {  content: '\f17c';}.fa-dribbble:before {  content: '\f17d';}.fa-skype:before {  content: '\f17e';}.fa-foursquare:before {  content: '\f180';}.fa-trello:before {  content: '\f181';}.fa-female:before {  content: '\f182';}.fa-male:before {  content: '\f183';}.fa-gittip:before,.fa-gratipay:before {  content: '\f184';}.fa-sun-o:before {  content: '\f185';}.fa-moon-o:before {  content: '\f186';}.fa-archive:before {  content: '\f187';}.fa-bug:before {  content: '\f188';}.fa-vk:before {  content: '\f189';}.fa-weibo:before {  content: '\f18a';}.fa-renren:before {  content: '\f18b';}.fa-pagelines:before {  content: '\f18c';}.fa-stack-exchange:before {  content: '\f18d';}.fa-arrow-circle-o-right:before {  content: '\f18e';}.fa-arrow-circle-o-left:before {  content: '\f190';}.fa-toggle-left:before,.fa-caret-square-o-left:before {  content: '\f191';}.fa-dot-circle-o:before {  content: '\f192';}.fa-wheelchair:before {  content: '\f193';}.fa-vimeo-square:before {  content: '\f194';}.fa-turkish-lira:before,.fa-try:before {  content: '\f195';}.fa-plus-square-o:before {  content: '\f196';}.fa-space-shuttle:before {  content: '\f197';}.fa-slack:before {  content: '\f198';}.fa-envelope-square:before {  content: '\f199';}.fa-wordpress:before {  content: '\f19a';}.fa-openid:before {  content: '\f19b';}.fa-institution:before,.fa-bank:before,.fa-university:before {  content: '\f19c';}.fa-mortar-board:before,.fa-graduation-cap:before {  content: '\f19d';}.fa-yahoo:before {  content: '\f19e';}.fa-google:before {  content: '\f1a0';}.fa-reddit:before {  content: '\f1a1';}.fa-reddit-square:before {  content: '\f1a2';}.fa-stumbleupon-circle:before {  content: '\f1a3';}.fa-stumbleupon:before {  content: '\f1a4';}.fa-delicious:before {  content: '\f1a5';}.fa-digg:before {  content: '\f1a6';}.fa-pied-piper-pp:before {  content: '\f1a7';}.fa-pied-piper-alt:before {  content: '\f1a8';}.fa-drupal:before {  content: '\f1a9';}.fa-joomla:before {  content: '\f1aa';}.fa-language:before {  content: '\f1ab';}.fa-fax:before {  content: '\f1ac';}.fa-building:before {  content: '\f1ad';}.fa-child:before {  content: '\f1ae';}.fa-paw:before {  content: '\f1b0';}.fa-spoon:before {  content: '\f1b1';}.fa-cube:before {  content: '\f1b2';}.fa-cubes:before {  content: '\f1b3';}.fa-behance:before {  content: '\f1b4';}.fa-behance-square:before {  content: '\f1b5';}.fa-steam:before {  content: '\f1b6';}.fa-steam-square:before {  content: '\f1b7';}.fa-recycle:before {  content: '\f1b8';}.fa-automobile:before,.fa-car:before {  content: '\f1b9';}.fa-cab:before,.fa-taxi:before {  content: '\f1ba';}.fa-tree:before {  content: '\f1bb';}.fa-spotify:before {  content: '\f1bc';}.fa-deviantart:before {  content: '\f1bd';}.fa-soundcloud:before {  content: '\f1be';}.fa-database:before {  content: '\f1c0';}.fa-file-pdf-o:before {  content: '\f1c1';}.fa-file-word-o:before {  content: '\f1c2';}.fa-file-excel-o:before {  content: '\f1c3';}.fa-file-powerpoint-o:before {  content: '\f1c4';}.fa-file-photo-o:before,.fa-file-picture-o:before,.fa-file-image-o:before {  content: '\f1c5';}.fa-file-zip-o:before,.fa-file-archive-o:before {  content: '\f1c6';}.fa-file-sound-o:before,.fa-file-audio-o:before {  content: '\f1c7';}.fa-file-movie-o:before,.fa-file-video-o:before {  content: '\f1c8';}.fa-file-code-o:before {  content: '\f1c9';}.fa-vine:before {  content: '\f1ca';}.fa-codepen:before {  content: '\f1cb';}.fa-jsfiddle:before {  content: '\f1cc';}.fa-life-bouy:before,.fa-life-buoy:before,.fa-life-saver:before,.fa-support:before,.fa-life-ring:before {  content: '\f1cd';}.fa-circle-o-notch:before {  content: '\f1ce';}.fa-ra:before,.fa-resistance:before,.fa-rebel:before {  content: '\f1d0';}.fa-ge:before,.fa-empire:before {  content: '\f1d1';}.fa-git-square:before {  content: '\f1d2';}.fa-git:before {  content: '\f1d3';}.fa-y-combinator-square:before,.fa-yc-square:before,.fa-hacker-news:before {  content: '\f1d4';}.fa-tencent-weibo:before {  content: '\f1d5';}.fa-qq:before {  content: '\f1d6';}.fa-wechat:before,.fa-weixin:before {  content: '\f1d7';}.fa-send:before,.fa-paper-plane:before {  content: '\f1d8';}.fa-send-o:before,.fa-paper-plane-o:before {  content: '\f1d9';}.fa-history:before {  content: '\f1da';}.fa-circle-thin:before {  content: '\f1db';}.fa-header:before {  content: '\f1dc';}.fa-paragraph:before {  content: '\f1dd';}.fa-sliders:before {  content: '\f1de';}.fa-share-alt:before {  content: '\f1e0';}.fa-share-alt-square:before {  content: '\f1e1';}.fa-bomb:before {  content: '\f1e2';}.fa-soccer-ball-o:before,.fa-futbol-o:before {  content: '\f1e3';}.fa-tty:before {  content: '\f1e4';}.fa-binoculars:before {  content: '\f1e5';}.fa-plug:before {  content: '\f1e6';}.fa-slideshare:before {  content: '\f1e7';}.fa-twitch:before {  content: '\f1e8';}.fa-yelp:before {  content: '\f1e9';}.fa-newspaper-o:before {  content: '\f1ea';}.fa-wifi:before {  content: '\f1eb';}.fa-calculator:before {  content: '\f1ec';}.fa-paypal:before {  content: '\f1ed';}.fa-google-wallet:before {  content: '\f1ee';}.fa-cc-visa:before {  content: '\f1f0';}.fa-cc-mastercard:before {  content: '\f1f1';}.fa-cc-discover:before {  content: '\f1f2';}.fa-cc-amex:before {  content: '\f1f3';}.fa-cc-paypal:before {  content: '\f1f4';}.fa-cc-stripe:before {  content: '\f1f5';}.fa-bell-slash:before {  content: '\f1f6';}.fa-bell-slash-o:before {  content: '\f1f7';}.fa-trash:before {  content: '\f1f8';}.fa-copyright:before {  content: '\f1f9';}.fa-at:before {  content: '\f1fa';}.fa-eyedropper:before {  content: '\f1fb';}.fa-paint-brush:before {  content: '\f1fc';}.fa-birthday-cake:before {  content: '\f1fd';}.fa-area-chart:before {  content: '\f1fe';}.fa-pie-chart:before {  content: '\f200';}.fa-line-chart:before {  content: '\f201';}.fa-lastfm:before {  content: '\f202';}.fa-lastfm-square:before {  content: '\f203';}.fa-toggle-off:before {  content: '\f204';}.fa-toggle-on:before {  content: '\f205';}.fa-bicycle:before {  content: '\f206';}.fa-bus:before {  content: '\f207';}.fa-ioxhost:before {  content: '\f208';}.fa-angellist:before {  content: '\f209';}.fa-cc:before {  content: '\f20a';}.fa-shekel:before,.fa-sheqel:before,.fa-ils:before {  content: '\f20b';}.fa-meanpath:before {  content: '\f20c';}.fa-buysellads:before {  content: '\f20d';}.fa-connectdevelop:before {  content: '\f20e';}.fa-dashcube:before {  content: '\f210';}.fa-forumbee:before {  content: '\f211';}.fa-leanpub:before {  content: '\f212';}.fa-sellsy:before {  content: '\f213';}.fa-shirtsinbulk:before {  content: '\f214';}.fa-simplybuilt:before {  content: '\f215';}.fa-skyatlas:before {  content: '\f216';}.fa-cart-plus:before {  content: '\f217';}.fa-cart-arrow-down:before {  content: '\f218';}.fa-diamond:before {  content: '\f219';}.fa-ship:before {  content: '\f21a';}.fa-user-secret:before {  content: '\f21b';}.fa-motorcycle:before {  content: '\f21c';}.fa-street-view:before {  content: '\f21d';}.fa-heartbeat:before {  content: '\f21e';}.fa-venus:before {  content: '\f221';}.fa-mars:before {  content: '\f222';}.fa-mercury:before {  content: '\f223';}.fa-intersex:before,.fa-transgender:before {  content: '\f224';}.fa-transgender-alt:before {  content: '\f225';}.fa-venus-double:before {  content: '\f226';}.fa-mars-double:before {  content: '\f227';}.fa-venus-mars:before {  content: '\f228';}.fa-mars-stroke:before {  content: '\f229';}.fa-mars-stroke-v:before {  content: '\f22a';}.fa-mars-stroke-h:before {  content: '\f22b';}.fa-neuter:before {  content: '\f22c';}.fa-genderless:before {  content: '\f22d';}.fa-facebook-official:before {  content: '\f230';}.fa-pinterest-p:before {  content: '\f231';}.fa-whatsapp:before {  content: '\f232';}.fa-server:before {  content: '\f233';}.fa-user-plus:before {  content: '\f234';}.fa-user-times:before {  content: '\f235';}.fa-hotel:before,.fa-bed:before {  content: '\f236';}.fa-viacoin:before {  content: '\f237';}.fa-train:before {  content: '\f238';}.fa-subway:before {  content: '\f239';}.fa-medium:before {  content: '\f23a';}.fa-yc:before,.fa-y-combinator:before {  content: '\f23b';}.fa-optin-monster:before {  content: '\f23c';}.fa-opencart:before {  content: '\f23d';}.fa-expeditedssl:before {  content: '\f23e';}.fa-battery-4:before,.fa-battery:before,.fa-battery-full:before {  content: '\f240';}.fa-battery-3:before,.fa-battery-three-quarters:before {  content: '\f241';}.fa-battery-2:before,.fa-battery-half:before {  content: '\f242';}.fa-battery-1:before,.fa-battery-quarter:before {  content: '\f243';}.fa-battery-0:before,.fa-battery-empty:before {  content: '\f244';}.fa-mouse-pointer:before {  content: '\f245';}.fa-i-cursor:before {  content: '\f246';}.fa-object-group:before {  content: '\f247';}.fa-object-ungroup:before {  content: '\f248';}.fa-sticky-note:before {  content: '\f249';}.fa-sticky-note-o:before {  content: '\f24a';}.fa-cc-jcb:before {  content: '\f24b';}.fa-cc-diners-club:before {  content: '\f24c';}.fa-clone:before {  content: '\f24d';}.fa-balance-scale:before {  content: '\f24e';}.fa-hourglass-o:before {  content: '\f250';}.fa-hourglass-1:before,.fa-hourglass-start:before {  content: '\f251';}.fa-hourglass-2:before,.fa-hourglass-half:before {  content: '\f252';}.fa-hourglass-3:before,.fa-hourglass-end:before {  content: '\f253';}.fa-hourglass:before {  content: '\f254';}.fa-hand-grab-o:before,.fa-hand-rock-o:before {  content: '\f255';}.fa-hand-stop-o:before,.fa-hand-paper-o:before {  content: '\f256';}.fa-hand-scissors-o:before {  content: '\f257';}.fa-hand-lizard-o:before {  content: '\f258';}.fa-hand-spock-o:before {  content: '\f259';}.fa-hand-pointer-o:before {  content: '\f25a';}.fa-hand-peace-o:before {  content: '\f25b';}.fa-trademark:before {  content: '\f25c';}.fa-registered:before {  content: '\f25d';}.fa-creative-commons:before {  content: '\f25e';}.fa-gg:before {  content: '\f260';}.fa-gg-circle:before {  content: '\f261';}.fa-tripadvisor:before {  content: '\f262';}.fa-odnoklassniki:before {  content: '\f263';}.fa-odnoklassniki-square:before {  content: '\f264';}.fa-get-pocket:before {  content: '\f265';}.fa-wikipedia-w:before {  content: '\f266';}.fa-safari:before {  content: '\f267';}.fa-chrome:before {  content: '\f268';}.fa-firefox:before {  content: '\f269';}.fa-opera:before {  content: '\f26a';}.fa-internet-explorer:before {  content: '\f26b';}.fa-tv:before,.fa-television:before {  content: '\f26c';}.fa-contao:before {  content: '\f26d';}.fa-500px:before {  content: '\f26e';}.fa-amazon:before {  content: '\f270';}.fa-calendar-plus-o:before {  content: '\f271';}.fa-calendar-minus-o:before {  content: '\f272';}.fa-calendar-times-o:before {  content: '\f273';}.fa-calendar-check-o:before {  content: '\f274';}.fa-industry:before {  content: '\f275';}.fa-map-pin:before {  content: '\f276';}.fa-map-signs:before {  content: '\f277';}.fa-map-o:before {  content: '\f278';}.fa-map:before {  content: '\f279';}.fa-commenting:before {  content: '\f27a';}.fa-commenting-o:before {  content: '\f27b';}.fa-houzz:before {  content: '\f27c';}.fa-vimeo:before {  content: '\f27d';}.fa-black-tie:before {  content: '\f27e';}.fa-fonticons:before {  content: '\f280';}.fa-reddit-alien:before {  content: '\f281';}.fa-edge:before {  content: '\f282';}.fa-credit-card-alt:before {  content: '\f283';}.fa-codiepie:before {  content: '\f284';}.fa-modx:before {  content: '\f285';}.fa-fort-awesome:before {  content: '\f286';}.fa-usb:before {  content: '\f287';}.fa-product-hunt:before {  content: '\f288';}.fa-mixcloud:before {  content: '\f289';}.fa-scribd:before {  content: '\f28a';}.fa-pause-circle:before {  content: '\f28b';}.fa-pause-circle-o:before {  content: '\f28c';}.fa-stop-circle:before {  content: '\f28d';}.fa-stop-circle-o:before {  content: '\f28e';}.fa-shopping-bag:before {  content: '\f290';}.fa-shopping-basket:before {  content: '\f291';}.fa-hashtag:before {  content: '\f292';}.fa-bluetooth:before {  content: '\f293';}.fa-bluetooth-b:before {  content: '\f294';}.fa-percent:before {  content: '\f295';}.fa-gitlab:before {  content: '\f296';}.fa-wpbeginner:before {  content: '\f297';}.fa-wpforms:before {  content: '\f298';}.fa-envira:before {  content: '\f299';}.fa-universal-access:before {  content: '\f29a';}.fa-wheelchair-alt:before {  content: '\f29b';}.fa-question-circle-o:before {  content: '\f29c';}.fa-blind:before {  content: '\f29d';}.fa-audio-description:before {  content: '\f29e';}.fa-volume-control-phone:before {  content: '\f2a0';}.fa-braille:before {  content: '\f2a1';}.fa-assistive-listening-systems:before {  content: '\f2a2';}.fa-asl-interpreting:before,.fa-american-sign-language-interpreting:before {  content: '\f2a3';}.fa-deafness:before,.fa-hard-of-hearing:before,.fa-deaf:before {  content: '\f2a4';}.fa-glide:before {  content: '\f2a5';}.fa-glide-g:before {  content: '\f2a6';}.fa-signing:before,.fa-sign-language:before {  content: '\f2a7';}.fa-low-vision:before {  content: '\f2a8';}.fa-viadeo:before {  content: '\f2a9';}.fa-viadeo-square:before {  content: '\f2aa';}.fa-snapchat:before {  content: '\f2ab';}.fa-snapchat-ghost:before {  content: '\f2ac';}.fa-snapchat-square:before {  content: '\f2ad';}.fa-pied-piper:before {  content: '\f2ae';}.fa-first-order:before {  content: '\f2b0';}.fa-yoast:before {  content: '\f2b1';}.fa-themeisle:before {  content: '\f2b2';}.fa-google-plus-circle:before,.fa-google-plus-official:before {  content: '\f2b3';}.fa-fa:before,.fa-font-awesome:before {  content: '\f2b4';}.fa-handshake-o:before {  content: '\f2b5';}.fa-envelope-open:before {  content: '\f2b6';}.fa-envelope-open-o:before {  content: '\f2b7';}.fa-linode:before {  content: '\f2b8';}.fa-address-book:before {  content: '\f2b9';}.fa-address-book-o:before {  content: '\f2ba';}.fa-vcard:before,.fa-address-card:before {  content: '\f2bb';}.fa-vcard-o:before,.fa-address-card-o:before {  content: '\f2bc';}.fa-user-circle:before {  content: '\f2bd';}.fa-user-circle-o:before {  content: '\f2be';}.fa-user-o:before {  content: '\f2c0';}.fa-id-badge:before {  content: '\f2c1';}.fa-drivers-license:before,.fa-id-card:before {  content: '\f2c2';}.fa-drivers-license-o:before,.fa-id-card-o:before {  content: '\f2c3';}.fa-quora:before {  content: '\f2c4';}.fa-free-code-camp:before {  content: '\f2c5';}.fa-telegram:before {  content: '\f2c6';}.fa-thermometer-4:before,.fa-thermometer:before,.fa-thermometer-full:before {  content: '\f2c7';}.fa-thermometer-3:before,.fa-thermometer-three-quarters:before {  content: '\f2c8';}.fa-thermometer-2:before,.fa-thermometer-half:before {  content: '\f2c9';}.fa-thermometer-1:before,.fa-thermometer-quarter:before {  content: '\f2ca';}.fa-thermometer-0:before,.fa-thermometer-empty:before {  content: '\f2cb';}.fa-shower:before {  content: '\f2cc';}.fa-bathtub:before,.fa-s15:before,.fa-bath:before {  content: '\f2cd';}.fa-podcast:before {  content: '\f2ce';}.fa-window-maximize:before {  content: '\f2d0';}.fa-window-minimize:before {  content: '\f2d1';}.fa-window-restore:before {  content: '\f2d2';}.fa-times-rectangle:before,.fa-window-close:before {  content: '\f2d3';}.fa-times-rectangle-o:before,.fa-window-close-o:before {  content: '\f2d4';}.fa-bandcamp:before {  content: '\f2d5';}.fa-grav:before {  content: '\f2d6';}.fa-etsy:before {  content: '\f2d7';}.fa-imdb:before {  content: '\f2d8';}.fa-ravelry:before {  content: '\f2d9';}.fa-eercast:before {  content: '\f2da';}.fa-microchip:before {  content: '\f2db';}.fa-snowflake-o:before {  content: '\f2dc';}.fa-superpowers:before {  content: '\f2dd';}.fa-wpexplorer:before {  content: '\f2de';}.fa-meetup:before {  content: '\f2e0';}.sr-only {  position: absolute;  width: 1px;  height: 1px;  padding: 0;  margin: -1px;  overflow: hidden;  clip: rect(0, 0, 0, 0);  border: 0;}.sr-only-focusable:active,.sr-only-focusable:focus {  position: static;  width: auto;  height: auto;  margin: 0;  overflow: visible;  clip: auto;}.sr-only-focusable:active,.sr-only-focusable:focus {  position: static;  width: auto;  height: auto;  margin: 0;  overflow: visible;  clip: auto;}/*!** IPython base**/.modal.fade .modal-dialog {  -webkit-transform: translate(0, 0);  -ms-transform: translate(0, 0);  -o-transform: translate(0, 0);  transform: translate(0, 0);}code {  color: #000;}pre {  font-size: inherit;  line-height: inherit;}label {  font-weight: normal;}/* Make the page background atleast 100% the height of the view port *//* Make the page itself atleast 70% the height of the view port */.border-box-sizing {  box-sizing: border-box;  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;}.corner-all {  border-radius: 2px;}.no-padding {  padding: 0px;}/* Flexible box model classes *//* Taken from Alex Russell http://infrequently.org/2009/08/css-3-progress/ *//* This file is a compatability layer.  It allows the usage of flexible box model layouts accross multiple browsers, including older browsers.  The newest,universal implementation of the flexible box model is used when available (see`Modern browsers` comments below).  Browsers that are known to implement this new spec completely include:    Firefox 28.0+    Chrome 29.0+    Internet Explorer 11+     Opera 17.0+Browsers not listed, including Safari, are supported via the styling under the`Old browsers` comments below.*/.hbox {  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: horizontal;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: horizontal;  -moz-box-align: stretch;  display: box;  box-orient: horizontal;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: row;  align-items: stretch;}.hbox > * {  /* Old browsers */  -webkit-box-flex: 0;  -moz-box-flex: 0;  box-flex: 0;  /* Modern browsers */  flex: none;}.vbox {  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: vertical;  -moz-box-align: stretch;  display: box;  box-orient: vertical;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: column;  align-items: stretch;}.vbox > * {  /* Old browsers */  -webkit-box-flex: 0;  -moz-box-flex: 0;  box-flex: 0;  /* Modern browsers */  flex: none;}.hbox.reverse,.vbox.reverse,.reverse {  /* Old browsers */  -webkit-box-direction: reverse;  -moz-box-direction: reverse;  box-direction: reverse;  /* Modern browsers */  flex-direction: row-reverse;}.hbox.box-flex0,.vbox.box-flex0,.box-flex0 {  /* Old browsers */  -webkit-box-flex: 0;  -moz-box-flex: 0;  box-flex: 0;  /* Modern browsers */  flex: none;  width: auto;}.hbox.box-flex1,.vbox.box-flex1,.box-flex1 {  /* Old browsers */  -webkit-box-flex: 1;  -moz-box-flex: 1;  box-flex: 1;  /* Modern browsers */  flex: 1;}.hbox.box-flex,.vbox.box-flex,.box-flex {  /* Old browsers */  /* Old browsers */  -webkit-box-flex: 1;  -moz-box-flex: 1;  box-flex: 1;  /* Modern browsers */  flex: 1;}.hbox.box-flex2,.vbox.box-flex2,.box-flex2 {  /* Old browsers */  -webkit-box-flex: 2;  -moz-box-flex: 2;  box-flex: 2;  /* Modern browsers */  flex: 2;}.box-group1 {  /*  Deprecated */  -webkit-box-flex-group: 1;  -moz-box-flex-group: 1;  box-flex-group: 1;}.box-group2 {  /* Deprecated */  -webkit-box-flex-group: 2;  -moz-box-flex-group: 2;  box-flex-group: 2;}.hbox.start,.vbox.start,.start {  /* Old browsers */  -webkit-box-pack: start;  -moz-box-pack: start;  box-pack: start;  /* Modern browsers */  justify-content: flex-start;}.hbox.end,.vbox.end,.end {  /* Old browsers */  -webkit-box-pack: end;  -moz-box-pack: end;  box-pack: end;  /* Modern browsers */  justify-content: flex-end;}.hbox.center,.vbox.center,.center {  /* Old browsers */  -webkit-box-pack: center;  -moz-box-pack: center;  box-pack: center;  /* Modern browsers */  justify-content: center;}.hbox.baseline,.vbox.baseline,.baseline {  /* Old browsers */  -webkit-box-pack: baseline;  -moz-box-pack: baseline;  box-pack: baseline;  /* Modern browsers */  justify-content: baseline;}.hbox.stretch,.vbox.stretch,.stretch {  /* Old browsers */  -webkit-box-pack: stretch;  -moz-box-pack: stretch;  box-pack: stretch;  /* Modern browsers */  justify-content: stretch;}.hbox.align-start,.vbox.align-start,.align-start {  /* Old browsers */  -webkit-box-align: start;  -moz-box-align: start;  box-align: start;  /* Modern browsers */  align-items: flex-start;}.hbox.align-end,.vbox.align-end,.align-end {  /* Old browsers */  -webkit-box-align: end;  -moz-box-align: end;  box-align: end;  /* Modern browsers */  align-items: flex-end;}.hbox.align-center,.vbox.align-center,.align-center {  /* Old browsers */  -webkit-box-align: center;  -moz-box-align: center;  box-align: center;  /* Modern browsers */  align-items: center;}.hbox.align-baseline,.vbox.align-baseline,.align-baseline {  /* Old browsers */  -webkit-box-align: baseline;  -moz-box-align: baseline;  box-align: baseline;  /* Modern browsers */  align-items: baseline;}.hbox.align-stretch,.vbox.align-stretch,.align-stretch {  /* Old browsers */  -webkit-box-align: stretch;  -moz-box-align: stretch;  box-align: stretch;  /* Modern browsers */  align-items: stretch;}div.error {  margin: 2em;  text-align: center;}div.error > h1 {  font-size: 500%;  line-height: normal;}div.error > p {  font-size: 200%;  line-height: normal;}div.traceback-wrapper {  text-align: left;  max-width: 800px;  margin: auto;}div.traceback-wrapper pre.traceback {  max-height: 600px;  overflow: auto;}/** * Primary styles * * Author: Jupyter Development Team */body {  background-color: #fff;  /* This makes sure that the body covers the entire window and needs to       be in a different element than the display: box in wrapper below */  position: absolute;  left: 0px;  right: 0px;  top: 0px;  bottom: 0px;  overflow: visible;}body > #header {  /* Initially hidden to prevent FLOUC */  display: none;  background-color: #fff;  /* Display over codemirror */  position: relative;  z-index: 100;}body > #header #header-container {  display: flex;  flex-direction: row;  justify-content: space-between;  padding: 5px;  padding-bottom: 5px;  padding-top: 5px;  box-sizing: border-box;  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;}body > #header .header-bar {  width: 100%;  height: 1px;  background: #e7e7e7;  margin-bottom: -1px;}@media print {  body > #header {    display: none !important;  }}#header-spacer {  width: 100%;  visibility: hidden;}@media print {  #header-spacer {    display: none;  }}#ipython_notebook {  padding-left: 0px;  padding-top: 1px;  padding-bottom: 1px;}[dir='rtl'] #ipython_notebook {  margin-right: 10px;  margin-left: 0;}[dir='rtl'] #ipython_notebook.pull-left {  float: right !important;  float: right;}.flex-spacer {  flex: 1;}#noscript {  width: auto;  padding-top: 16px;  padding-bottom: 16px;  text-align: center;  font-size: 22px;  color: red;  font-weight: bold;}#ipython_notebook img {  height: 28px;}#site {  width: 100%;  display: none;  box-sizing: border-box;  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;  overflow: auto;}@media print {  #site {    height: auto !important;  }}/* Smaller buttons */.ui-button .ui-button-text {  padding: 0.2em 0.8em;  font-size: 77%;}input.ui-button {  padding: 0.3em 0.9em;}span#kernel_logo_widget {  margin: 0 10px;}span#login_widget {  float: right;}[dir='rtl'] span#login_widget {  float: left;}span#login_widget > .button,#logout {  color: #333;  background-color: #fff;  border-color: #ccc;}span#login_widget > .button:focus,#logout:focus,span#login_widget > .button.focus,#logout.focus {  color: #333;  background-color: #e6e6e6;  border-color: #8c8c8c;}span#login_widget > .button:hover,#logout:hover {  color: #333;  background-color: #e6e6e6;  border-color: #adadad;}span#login_widget > .button:active,#logout:active,span#login_widget > .button.active,#logout.active,.open > .dropdown-togglespan#login_widget > .button,.open > .dropdown-toggle#logout {  color: #333;  background-color: #e6e6e6;  border-color: #adadad;}span#login_widget > .button:active:hover,#logout:active:hover,span#login_widget > .button.active:hover,#logout.active:hover,.open > .dropdown-togglespan#login_widget > .button:hover,.open > .dropdown-toggle#logout:hover,span#login_widget > .button:active:focus,#logout:active:focus,span#login_widget > .button.active:focus,#logout.active:focus,.open > .dropdown-togglespan#login_widget > .button:focus,.open > .dropdown-toggle#logout:focus,span#login_widget > .button:active.focus,#logout:active.focus,span#login_widget > .button.active.focus,#logout.active.focus,.open > .dropdown-togglespan#login_widget > .button.focus,.open > .dropdown-toggle#logout.focus {  color: #333;  background-color: #d4d4d4;  border-color: #8c8c8c;}span#login_widget > .button:active,#logout:active,span#login_widget > .button.active,#logout.active,.open > .dropdown-togglespan#login_widget > .button,.open > .dropdown-toggle#logout {  background-image: none;}span#login_widget > .button.disabled:hover,#logout.disabled:hover,span#login_widget > .button[disabled]:hover,#logout[disabled]:hover,fieldset[disabled] span#login_widget > .button:hover,fieldset[disabled] #logout:hover,span#login_widget > .button.disabled:focus,#logout.disabled:focus,span#login_widget > .button[disabled]:focus,#logout[disabled]:focus,fieldset[disabled] span#login_widget > .button:focus,fieldset[disabled] #logout:focus,span#login_widget > .button.disabled.focus,#logout.disabled.focus,span#login_widget > .button[disabled].focus,#logout[disabled].focus,fieldset[disabled] span#login_widget > .button.focus,fieldset[disabled] #logout.focus {  background-color: #fff;  border-color: #ccc;}span#login_widget > .button .badge,#logout .badge {  color: #fff;  background-color: #333;}.nav-header {  text-transform: none;}#header > span {  margin-top: 10px;}.modal_stretch .modal-dialog {  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: vertical;  -moz-box-align: stretch;  display: box;  box-orient: vertical;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: column;  align-items: stretch;  min-height: 80vh;}.modal_stretch .modal-dialog .modal-body {  max-height: calc(100vh - 200px);  overflow: auto;  flex: 1;}.modal-header {  cursor: move;}@media (min-width: 768px) {  .modal .modal-dialog {    width: 700px;  }}@media (min-width: 768px) {  select.form-control {    margin-left: 12px;    margin-right: 12px;  }}/*!** IPython auth**/.center-nav {  display: inline-block;  margin-bottom: -4px;}[dir='rtl'] .center-nav form.pull-left {  float: right !important;  float: right;}[dir='rtl'] .center-nav .navbar-text {  float: right;}[dir='rtl'] .navbar-inner {  text-align: right;}[dir='rtl'] div.text-left {  text-align: right;}/*!** IPython tree view**//* We need an invisible input field on top of the sentense*//* 'Drag file onto the list ...' */.alternate_upload {  background-color: none;  display: inline;}.alternate_upload.form {  padding: 0;  margin: 0;}.alternate_upload input.fileinput {  position: absolute;  display: block;  width: 100%;  height: 100%;  overflow: hidden;  cursor: pointer;  opacity: 0;  z-index: 2;}.alternate_upload .btn-xs > input.fileinput {  margin: -1px -5px;}.alternate_upload .btn-upload {  position: relative;  height: 22px;}::-webkit-file-upload-button {  cursor: pointer;}/** * Primary styles * * Author: Jupyter Development Team */ul#tabs {  margin-bottom: 4px;}ul#tabs a {  padding-top: 6px;  padding-bottom: 4px;}[dir='rtl'] ul#tabs.nav-tabs > li {  float: right;}[dir='rtl'] ul#tabs.nav.nav-tabs {  padding-right: 0;}ul.breadcrumb a:focus,ul.breadcrumb a:hover {  text-decoration: none;}ul.breadcrumb i.icon-home {  font-size: 16px;  margin-right: 4px;}ul.breadcrumb span {  color: #5e5e5e;}.list_toolbar {  padding: 4px 0 4px 0;  vertical-align: middle;}.list_toolbar .tree-buttons {  padding-top: 1px;}[dir='rtl'] .list_toolbar .tree-buttons .pull-right {  float: left !important;  float: left;}[dir='rtl'] .list_toolbar .col-sm-4,[dir='rtl'] .list_toolbar .col-sm-8 {  float: right;}.dynamic-buttons {  padding-top: 3px;  display: inline-block;}.list_toolbar [class*='span'] {  min-height: 24px;}.list_header {  font-weight: bold;  background-color: #EEE;}.list_placeholder {  font-weight: bold;  padding-top: 4px;  padding-bottom: 4px;  padding-left: 7px;  padding-right: 7px;}.list_container {  margin-top: 4px;  margin-bottom: 20px;  border: 1px solid #ddd;  border-radius: 2px;}.list_container > div {  border-bottom: 1px solid #ddd;}.list_container > div:hover .list-item {  background-color: red;}.list_container > div:last-child {  border: none;}.list_item:hover .list_item {  background-color: #ddd;}.list_item a {  text-decoration: none;}.list_item:hover {  background-color: #fafafa;}.list_header > div,.list_item > div {  padding-top: 4px;  padding-bottom: 4px;  padding-left: 7px;  padding-right: 7px;  line-height: 22px;}.list_header > div input,.list_item > div input {  margin-right: 7px;  margin-left: 14px;  vertical-align: text-bottom;  line-height: 22px;  position: relative;  top: -1px;}.list_header > div .item_link,.list_item > div .item_link {  margin-left: -1px;  vertical-align: baseline;  line-height: 22px;}[dir='rtl'] .list_item > div input {  margin-right: 0;}.new-file input[type=checkbox] {  visibility: hidden;}.item_name {  line-height: 22px;  height: 24px;}.item_icon {  font-size: 14px;  color: #5e5e5e;  margin-right: 7px;  margin-left: 7px;  line-height: 22px;  vertical-align: baseline;}.item_modified {  margin-right: 7px;  margin-left: 7px;}[dir='rtl'] .item_modified.pull-right {  float: left !important;  float: left;}.item_buttons {  line-height: 1em;  margin-left: -5px;}.item_buttons .btn,.item_buttons .btn-group,.item_buttons .input-group {  float: left;}.item_buttons > .btn,.item_buttons > .btn-group,.item_buttons > .input-group {  margin-left: 5px;}.item_buttons .btn {  min-width: 13ex;}.item_buttons .running-indicator {  padding-top: 4px;  color: #5cb85c;}.item_buttons .kernel-name {  padding-top: 4px;  color: #5bc0de;  margin-right: 7px;  float: left;}[dir='rtl'] .item_buttons.pull-right {  float: left !important;  float: left;}[dir='rtl'] .item_buttons .kernel-name {  margin-left: 7px;  float: right;}.toolbar_info {  height: 24px;  line-height: 24px;}.list_item input:not([type=checkbox]) {  padding-top: 3px;  padding-bottom: 3px;  height: 22px;  line-height: 14px;  margin: 0px;}.highlight_text {  color: blue;}#project_name {  display: inline-block;  padding-left: 7px;  margin-left: -2px;}#project_name > .breadcrumb {  padding: 0px;  margin-bottom: 0px;  background-color: transparent;  font-weight: bold;}.sort_button {  display: inline-block;  padding-left: 7px;}[dir='rtl'] .sort_button.pull-right {  float: left !important;  float: left;}#tree-selector {  padding-right: 0px;}#button-select-all {  min-width: 50px;}[dir='rtl'] #button-select-all.btn {  float: right ;}#select-all {  margin-left: 7px;  margin-right: 2px;  margin-top: 2px;  height: 16px;}[dir='rtl'] #select-all.pull-left {  float: right !important;  float: right;}.menu_icon {  margin-right: 2px;}.tab-content .row {  margin-left: 0px;  margin-right: 0px;}.folder_icon:before {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  content: '\f114';}.folder_icon:before.fa-pull-left {  margin-right: .3em;}.folder_icon:before.fa-pull-right {  margin-left: .3em;}.folder_icon:before.pull-left {  margin-right: .3em;}.folder_icon:before.pull-right {  margin-left: .3em;}.notebook_icon:before {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  content: '\f02d';  position: relative;  top: -1px;}.notebook_icon:before.fa-pull-left {  margin-right: .3em;}.notebook_icon:before.fa-pull-right {  margin-left: .3em;}.notebook_icon:before.pull-left {  margin-right: .3em;}.notebook_icon:before.pull-right {  margin-left: .3em;}.running_notebook_icon:before {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  content: '\f02d';  position: relative;  top: -1px;  color: #5cb85c;}.running_notebook_icon:before.fa-pull-left {  margin-right: .3em;}.running_notebook_icon:before.fa-pull-right {  margin-left: .3em;}.running_notebook_icon:before.pull-left {  margin-right: .3em;}.running_notebook_icon:before.pull-right {  margin-left: .3em;}.file_icon:before {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  content: '\f016';  position: relative;  top: -2px;}.file_icon:before.fa-pull-left {  margin-right: .3em;}.file_icon:before.fa-pull-right {  margin-left: .3em;}.file_icon:before.pull-left {  margin-right: .3em;}.file_icon:before.pull-right {  margin-left: .3em;}#notebook_toolbar .pull-right {  padding-top: 0px;  margin-right: -1px;}ul#new-menu {  left: auto;  right: 0;}#new-menu .dropdown-header {  font-size: 10px;  border-bottom: 1px solid #e5e5e5;  padding: 0 0 3px;  margin: -3px 20px 0;}.kernel-menu-icon {  padding-right: 12px;  width: 24px;  content: '\f096';}.kernel-menu-icon:before {  content: '\f096';}.kernel-menu-icon-current:before {  content: '\f00c';}#tab_content {  padding-top: 20px;}#running .panel-group .panel {  margin-top: 3px;  margin-bottom: 1em;}#running .panel-group .panel .panel-heading {  background-color: #EEE;  padding-top: 4px;  padding-bottom: 4px;  padding-left: 7px;  padding-right: 7px;  line-height: 22px;}#running .panel-group .panel .panel-heading a:focus,#running .panel-group .panel .panel-heading a:hover {  text-decoration: none;}#running .panel-group .panel .panel-body {  padding: 0px;}#running .panel-group .panel .panel-body .list_container {  margin-top: 0px;  margin-bottom: 0px;  border: 0px;  border-radius: 0px;}#running .panel-group .panel .panel-body .list_container .list_item {  border-bottom: 1px solid #ddd;}#running .panel-group .panel .panel-body .list_container .list_item:last-child {  border-bottom: 0px;}.delete-button {  display: none;}.duplicate-button {  display: none;}.rename-button {  display: none;}.move-button {  display: none;}.download-button {  display: none;}.shutdown-button {  display: none;}.dynamic-instructions {  display: inline-block;  padding-top: 4px;}/*!** IPython text editor webapp**/.selected-keymap i.fa {  padding: 0px 5px;}.selected-keymap i.fa:before {  content: '\f00c';}#mode-menu {  overflow: auto;  max-height: 20em;}.edit_app #header {  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);}.edit_app #menubar .navbar {  /* Use a negative 1 bottom margin, so the border overlaps the border of the    header */  margin-bottom: -1px;}.dirty-indicator {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  width: 20px;}.dirty-indicator.fa-pull-left {  margin-right: .3em;}.dirty-indicator.fa-pull-right {  margin-left: .3em;}.dirty-indicator.pull-left {  margin-right: .3em;}.dirty-indicator.pull-right {  margin-left: .3em;}.dirty-indicator-dirty {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  width: 20px;}.dirty-indicator-dirty.fa-pull-left {  margin-right: .3em;}.dirty-indicator-dirty.fa-pull-right {  margin-left: .3em;}.dirty-indicator-dirty.pull-left {  margin-right: .3em;}.dirty-indicator-dirty.pull-right {  margin-left: .3em;}.dirty-indicator-clean {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  width: 20px;}.dirty-indicator-clean.fa-pull-left {  margin-right: .3em;}.dirty-indicator-clean.fa-pull-right {  margin-left: .3em;}.dirty-indicator-clean.pull-left {  margin-right: .3em;}.dirty-indicator-clean.pull-right {  margin-left: .3em;}.dirty-indicator-clean:before {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  content: '\f00c';}.dirty-indicator-clean:before.fa-pull-left {  margin-right: .3em;}.dirty-indicator-clean:before.fa-pull-right {  margin-left: .3em;}.dirty-indicator-clean:before.pull-left {  margin-right: .3em;}.dirty-indicator-clean:before.pull-right {  margin-left: .3em;}#filename {  font-size: 16pt;  display: table;  padding: 0px 5px;}#current-mode {  padding-left: 5px;  padding-right: 5px;}#texteditor-backdrop {  padding-top: 20px;  padding-bottom: 20px;}@media not print {  #texteditor-backdrop {    background-color: #EEE;  }}@media print {  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {    background-color: #fff;  }}@media not print {  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {    background-color: #fff;  }}@media not print {  #texteditor-backdrop #texteditor-container {    padding: 0px;    background-color: #fff;    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);  }}.CodeMirror-dialog {  background-color: #fff;}/*!** IPython notebook**//* CSS font colors for translated ANSI escape sequences *//* The color values are a mix of   http://www.xcolors.net/dl/baskerville-ivorylight and   http://www.xcolors.net/dl/euphrasia */.ansi-black-fg {  color: #3E424D;}.ansi-black-bg {  background-color: #3E424D;}.ansi-black-intense-fg {  color: #282C36;}.ansi-black-intense-bg {  background-color: #282C36;}.ansi-red-fg {  color: #E75C58;}.ansi-red-bg {  background-color: #E75C58;}.ansi-red-intense-fg {  color: #B22B31;}.ansi-red-intense-bg {  background-color: #B22B31;}.ansi-green-fg {  color: #00A250;}.ansi-green-bg {  background-color: #00A250;}.ansi-green-intense-fg {  color: #007427;}.ansi-green-intense-bg {  background-color: #007427;}.ansi-yellow-fg {  color: #DDB62B;}.ansi-yellow-bg {  background-color: #DDB62B;}.ansi-yellow-intense-fg {  color: #B27D12;}.ansi-yellow-intense-bg {  background-color: #B27D12;}.ansi-blue-fg {  color: #208FFB;}.ansi-blue-bg {  background-color: #208FFB;}.ansi-blue-intense-fg {  color: #0065CA;}.ansi-blue-intense-bg {  background-color: #0065CA;}.ansi-magenta-fg {  color: #D160C4;}.ansi-magenta-bg {  background-color: #D160C4;}.ansi-magenta-intense-fg {  color: #A03196;}.ansi-magenta-intense-bg {  background-color: #A03196;}.ansi-cyan-fg {  color: #60C6C8;}.ansi-cyan-bg {  background-color: #60C6C8;}.ansi-cyan-intense-fg {  color: #258F8F;}.ansi-cyan-intense-bg {  background-color: #258F8F;}.ansi-white-fg {  color: #C5C1B4;}.ansi-white-bg {  background-color: #C5C1B4;}.ansi-white-intense-fg {  color: #A1A6B2;}.ansi-white-intense-bg {  background-color: #A1A6B2;}.ansi-default-inverse-fg {  color: #FFFFFF;}.ansi-default-inverse-bg {  background-color: #000000;}.ansi-bold {  font-weight: bold;}.ansi-underline {  text-decoration: underline;}/* The following styles are deprecated an will be removed in a future version */.ansibold {  font-weight: bold;}.ansi-inverse {  outline: 0.5px dotted;}/* use dark versions for foreground, to improve visibility */.ansiblack {  color: black;}.ansired {  color: darkred;}.ansigreen {  color: darkgreen;}.ansiyellow {  color: #c4a000;}.ansiblue {  color: darkblue;}.ansipurple {  color: darkviolet;}.ansicyan {  color: steelblue;}.ansigray {  color: gray;}/* and light for background, for the same reason */.ansibgblack {  background-color: black;}.ansibgred {  background-color: red;}.ansibggreen {  background-color: green;}.ansibgyellow {  background-color: yellow;}.ansibgblue {  background-color: blue;}.ansibgpurple {  background-color: magenta;}.ansibgcyan {  background-color: cyan;}.ansibggray {  background-color: gray;}div.cell {  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: vertical;  -moz-box-align: stretch;  display: box;  box-orient: vertical;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: column;  align-items: stretch;  border-radius: 2px;  box-sizing: border-box;  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;  border-width: 1px;  border-style: solid;  border-color: transparent;  width: 100%;  padding: 5px;  /* This acts as a spacer between cells, that is outside the border */  margin: 0px;  outline: none;  position: relative;  overflow: visible;}div.cell:before {  position: absolute;  display: block;  top: -1px;  left: -1px;  width: 5px;  height: calc(100% +  2px);  content: '';  background: transparent;}div.cell.jupyter-soft-selected {  border-left-color: #E3F2FD;  border-left-width: 1px;  padding-left: 5px;  border-right-color: #E3F2FD;  border-right-width: 1px;  background: #E3F2FD;}@media print {  div.cell.jupyter-soft-selected {    border-color: transparent;  }}div.cell.selected,div.cell.selected.jupyter-soft-selected {  border-color: #ababab;}div.cell.selected:before,div.cell.selected.jupyter-soft-selected:before {  position: absolute;  display: block;  top: -1px;  left: -1px;  width: 5px;  height: calc(100% +  2px);  content: '';  background: #42A5F5;}@media print {  div.cell.selected,  div.cell.selected.jupyter-soft-selected {    border-color: transparent;  }}.edit_mode div.cell.selected {  border-color: #66BB6A;}.edit_mode div.cell.selected:before {  position: absolute;  display: block;  top: -1px;  left: -1px;  width: 5px;  height: calc(100% +  2px);  content: '';  background: #66BB6A;}@media print {  .edit_mode div.cell.selected {    border-color: transparent;  }}.prompt {  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */  min-width: 14ex;  /* This padding is tuned to match the padding on the CodeMirror editor. */  padding: 0.4em;  margin: 0px;  font-family: monospace;  text-align: right;  /* This has to match that of the the CodeMirror class line-height below */  line-height: 1.21429em;  /* Don't highlight prompt number selection */  -webkit-touch-callout: none;  -webkit-user-select: none;  -khtml-user-select: none;  -moz-user-select: none;  -ms-user-select: none;  user-select: none;  /* Use default cursor */  cursor: default;}@media (max-width: 540px) {  .prompt {    text-align: left;  }}div.inner_cell {  min-width: 0;  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: vertical;  -moz-box-align: stretch;  display: box;  box-orient: vertical;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: column;  align-items: stretch;  /* Old browsers */  -webkit-box-flex: 1;  -moz-box-flex: 1;  box-flex: 1;  /* Modern browsers */  flex: 1;}/* input_area and input_prompt must match in top border and margin for alignment */div.input_area {  border: 1px solid #cfcfcf;  border-radius: 2px;  background: #f7f7f7;  line-height: 1.21429em;}/* This is needed so that empty prompt areas can collapse to zero height when there   is no content in the output_subarea and the prompt. The main purpose of this is   to make sure that empty JavaScript output_subareas have no height. */div.prompt:empty {  padding-top: 0;  padding-bottom: 0;}div.unrecognized_cell {  padding: 5px 5px 5px 0px;  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: horizontal;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: horizontal;  -moz-box-align: stretch;  display: box;  box-orient: horizontal;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: row;  align-items: stretch;}div.unrecognized_cell .inner_cell {  border-radius: 2px;  padding: 5px;  font-weight: bold;  color: red;  border: 1px solid #cfcfcf;  background: #eaeaea;}div.unrecognized_cell .inner_cell a {  color: inherit;  text-decoration: none;}div.unrecognized_cell .inner_cell a:hover {  color: inherit;  text-decoration: none;}@media (max-width: 540px) {  div.unrecognized_cell > div.prompt {    display: none;  }}div.code_cell {  /* avoid page breaking on code cells when printing */}@media print {  div.code_cell {    page-break-inside: avoid;  }}/* any special styling for code cells that are currently running goes here */div.input {  page-break-inside: avoid;  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: horizontal;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: horizontal;  -moz-box-align: stretch;  display: box;  box-orient: horizontal;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: row;  align-items: stretch;}@media (max-width: 540px) {  div.input {    /* Old browsers */    display: -webkit-box;    -webkit-box-orient: vertical;    -webkit-box-align: stretch;    display: -moz-box;    -moz-box-orient: vertical;    -moz-box-align: stretch;    display: box;    box-orient: vertical;    box-align: stretch;    /* Modern browsers */    display: flex;    flex-direction: column;    align-items: stretch;  }}/* input_area and input_prompt must match in top border and margin for alignment */div.input_prompt {  color: #303F9F;  border-top: 1px solid transparent;}div.input_area > div.highlight {  margin: 0.4em;  border: none;  padding: 0px;  background-color: transparent;}div.input_area > div.highlight > pre {  margin: 0px;  border: none;  padding: 0px;  background-color: transparent;}/* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height.  See * notebookmain.js.  Such fonts will have keywords vertically offset with * respect to the rest of the text.  The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { *      vertical-align: bottom; * } */.CodeMirror {  line-height: 1.21429em;  /* Changed from 1em to our global default */  font-size: 14px;  height: auto;  /* Changed to auto to autogrow */  background: none;  /* Changed from white to allow our bg to show through */}.CodeMirror-scroll {  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/  overflow-y: hidden;  overflow-x: auto;}.CodeMirror-lines {  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */  /* we have set a different line-height and want this to scale with that. */  /* Note that this should set vertical padding only, since CodeMirror assumes       that horizontal padding will be set on CodeMirror pre */  padding: 0.4em 0;}.CodeMirror-linenumber {  padding: 0 8px 0 4px;}.CodeMirror-gutters {  border-bottom-left-radius: 2px;  border-top-left-radius: 2px;}.CodeMirror pre {  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,    use .CodeMirror-lines for vertical */  padding: 0 0.4em;  border: 0;  border-radius: 0;}.CodeMirror-cursor {  border-left: 1.4px solid black;}@media screen and (min-width: 2138px) and (max-width: 4319px) {  .CodeMirror-cursor {    border-left: 2px solid black;  }}@media screen and (min-width: 4320px) {  .CodeMirror-cursor {    border-left: 4px solid black;  }}/*Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>Adapted from GitHub theme*/.highlight-base {  color: #000;}.highlight-variable {  color: #000;}.highlight-variable-2 {  color: #1a1a1a;}.highlight-variable-3 {  color: #333333;}.highlight-string {  color: #BA2121;}.highlight-comment {  color: #408080;  font-style: italic;}.highlight-number {  color: #080;}.highlight-atom {  color: #88F;}.highlight-keyword {  color: #008000;  font-weight: bold;}.highlight-builtin {  color: #008000;}.highlight-error {  color: #f00;}.highlight-operator {  color: #AA22FF;  font-weight: bold;}.highlight-meta {  color: #AA22FF;}/* previously not defined, copying from default codemirror */.highlight-def {  color: #00f;}.highlight-string-2 {  color: #f50;}.highlight-qualifier {  color: #555;}.highlight-bracket {  color: #997;}.highlight-tag {  color: #170;}.highlight-attribute {  color: #00c;}.highlight-header {  color: blue;}.highlight-quote {  color: #090;}.highlight-link {  color: #00c;}/* apply the same style to codemirror */.cm-s-ipython span.cm-keyword {  color: #008000;  font-weight: bold;}.cm-s-ipython span.cm-atom {  color: #88F;}.cm-s-ipython span.cm-number {  color: #080;}.cm-s-ipython span.cm-def {  color: #00f;}.cm-s-ipython span.cm-variable {  color: #000;}.cm-s-ipython span.cm-operator {  color: #AA22FF;  font-weight: bold;}.cm-s-ipython span.cm-variable-2 {  color: #1a1a1a;}.cm-s-ipython span.cm-variable-3 {  color: #333333;}.cm-s-ipython span.cm-comment {  color: #408080;  font-style: italic;}.cm-s-ipython span.cm-string {  color: #BA2121;}.cm-s-ipython span.cm-string-2 {  color: #f50;}.cm-s-ipython span.cm-meta {  color: #AA22FF;}.cm-s-ipython span.cm-qualifier {  color: #555;}.cm-s-ipython span.cm-builtin {  color: #008000;}.cm-s-ipython span.cm-bracket {  color: #997;}.cm-s-ipython span.cm-tag {  color: #170;}.cm-s-ipython span.cm-attribute {  color: #00c;}.cm-s-ipython span.cm-header {  color: blue;}.cm-s-ipython span.cm-quote {  color: #090;}.cm-s-ipython span.cm-link {  color: #00c;}.cm-s-ipython span.cm-error {  color: #f00;}.cm-s-ipython span.cm-tab {  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);  background-position: right;  background-repeat: no-repeat;}div.output_wrapper {  /* this position must be relative to enable descendents to be absolute within it */  position: relative;  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: vertical;  -moz-box-align: stretch;  display: box;  box-orient: vertical;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: column;  align-items: stretch;  z-index: 1;}/* class for the output area when it should be height-limited */div.output_scroll {  /* ideally, this would be max-height, but FF barfs all over that */  height: 24em;  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */  width: 100%;  overflow: auto;  border-radius: 2px;  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);  display: block;}/* output div while it is collapsed */div.output_collapsed {  margin: 0px;  padding: 0px;  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: vertical;  -moz-box-align: stretch;  display: box;  box-orient: vertical;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: column;  align-items: stretch;}div.out_prompt_overlay {  height: 100%;  padding: 0px 0.4em;  position: absolute;  border-radius: 2px;}div.out_prompt_overlay:hover {  /* use inner shadow to get border that is computed the same on WebKit/FF */  -webkit-box-shadow: inset 0 0 1px #000;  box-shadow: inset 0 0 1px #000;  background: rgba(240, 240, 240, 0.5);}div.output_prompt {  color: #D84315;}/* This class is the outer container of all output sections. */div.output_area {  padding: 0px;  page-break-inside: avoid;  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: horizontal;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: horizontal;  -moz-box-align: stretch;  display: box;  box-orient: horizontal;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: row;  align-items: stretch;}div.output_area .MathJax_Display {  text-align: left !important;}div.output_area .rendered_html table {  margin-left: 0;  margin-right: 0;}div.output_area .rendered_html img {  margin-left: 0;  margin-right: 0;}div.output_area img,div.output_area svg {  max-width: 100%;  height: auto;}div.output_area img.unconfined,div.output_area svg.unconfined {  max-width: none;}div.output_area .mglyph > img {  max-width: none;}/* This is needed to protect the pre formating from global settings such   as that of bootstrap */.output {  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: vertical;  -moz-box-align: stretch;  display: box;  box-orient: vertical;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: column;  align-items: stretch;}@media (max-width: 540px) {  div.output_area {    /* Old browsers */    display: -webkit-box;    -webkit-box-orient: vertical;    -webkit-box-align: stretch;    display: -moz-box;    -moz-box-orient: vertical;    -moz-box-align: stretch;    display: box;    box-orient: vertical;    box-align: stretch;    /* Modern browsers */    display: flex;    flex-direction: column;    align-items: stretch;  }}div.output_area pre {  margin: 0;  padding: 1px 0 1px 0;  border: 0;  vertical-align: baseline;  color: black;  background-color: transparent;  border-radius: 0;}/* This class is for the output subarea inside the output_area and after   the prompt div. */div.output_subarea {  overflow-x: auto;  padding: 0.4em;  /* Old browsers */  -webkit-box-flex: 1;  -moz-box-flex: 1;  box-flex: 1;  /* Modern browsers */  flex: 1;  max-width: calc(100% - 14ex);}div.output_scroll div.output_subarea {  overflow-x: visible;}/* The rest of the output_* classes are for special styling of the different   output types *//* all text output has this class: */div.output_text {  text-align: left;  color: #000;  /* This has to match that of the the CodeMirror class line-height below */  line-height: 1.21429em;}/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */div.output_stderr {  background: #fdd;  /* very light red background for stderr */}div.output_latex {  text-align: left;}/* Empty output_javascript divs should have no height */div.output_javascript:empty {  padding: 0;}.js-error {  color: darkred;}/* raw_input styles */div.raw_input_container {  line-height: 1.21429em;  padding-top: 5px;}pre.raw_input_prompt {  /* nothing needed here. */}input.raw_input {  font-family: monospace;  font-size: inherit;  color: inherit;  width: auto;  /* make sure input baseline aligns with prompt */  vertical-align: baseline;  /* padding + margin = 0.5em between prompt and cursor */  padding: 0em 0.25em;  margin: 0em 0.25em;}input.raw_input:focus {  box-shadow: none;}p.p-space {  margin-bottom: 10px;}div.output_unrecognized {  padding: 5px;  font-weight: bold;  color: red;}div.output_unrecognized a {  color: inherit;  text-decoration: none;}div.output_unrecognized a:hover {  color: inherit;  text-decoration: none;}.rendered_html {  color: #000;  /* any extras will just be numbers: */}.rendered_html em {  font-style: italic;}.rendered_html strong {  font-weight: bold;}.rendered_html u {  text-decoration: underline;}.rendered_html :link {  text-decoration: underline;}.rendered_html :visited {  text-decoration: underline;}.rendered_html h1 {  font-size: 185.7%;  margin: 1.08em 0 0 0;  font-weight: bold;  line-height: 1.0;}.rendered_html h2 {  font-size: 157.1%;  margin: 1.27em 0 0 0;  font-weight: bold;  line-height: 1.0;}.rendered_html h3 {  font-size: 128.6%;  margin: 1.55em 0 0 0;  font-weight: bold;  line-height: 1.0;}.rendered_html h4 {  font-size: 100%;  margin: 2em 0 0 0;  font-weight: bold;  line-height: 1.0;}.rendered_html h5 {  font-size: 100%;  margin: 2em 0 0 0;  font-weight: bold;  line-height: 1.0;  font-style: italic;}.rendered_html h6 {  font-size: 100%;  margin: 2em 0 0 0;  font-weight: bold;  line-height: 1.0;  font-style: italic;}.rendered_html h1:first-child {  margin-top: 0.538em;}.rendered_html h2:first-child {  margin-top: 0.636em;}.rendered_html h3:first-child {  margin-top: 0.777em;}.rendered_html h4:first-child {  margin-top: 1em;}.rendered_html h5:first-child {  margin-top: 1em;}.rendered_html h6:first-child {  margin-top: 1em;}.rendered_html ul:not(.list-inline),.rendered_html ol:not(.list-inline) {  padding-left: 2em;}.rendered_html ul {  list-style: disc;}.rendered_html ul ul {  list-style: square;  margin-top: 0;}.rendered_html ul ul ul {  list-style: circle;}.rendered_html ol {  list-style: decimal;}.rendered_html ol ol {  list-style: upper-alpha;  margin-top: 0;}.rendered_html ol ol ol {  list-style: lower-alpha;}.rendered_html ol ol ol ol {  list-style: lower-roman;}.rendered_html ol ol ol ol ol {  list-style: decimal;}.rendered_html * + ul {  margin-top: 1em;}.rendered_html * + ol {  margin-top: 1em;}.rendered_html hr {  color: black;  background-color: black;}.rendered_html pre {  margin: 1em 2em;  padding: 0px;  background-color: #fff;}.rendered_html code {  background-color: #eff0f1;}.rendered_html p code {  padding: 1px 5px;}.rendered_html pre code {  background-color: #fff;}.rendered_html pre,.rendered_html code {  border: 0;  color: #000;  font-size: 100%;}.rendered_html blockquote {  margin: 1em 2em;}.rendered_html table {  margin-left: auto;  margin-right: auto;  border: none;  border-collapse: collapse;  border-spacing: 0;  color: black;  font-size: 12px;  table-layout: fixed;}.rendered_html thead {  border-bottom: 1px solid black;  vertical-align: bottom;}.rendered_html tr,.rendered_html th,.rendered_html td {  text-align: right;  vertical-align: middle;  padding: 0.5em 0.5em;  line-height: normal;  white-space: normal;  max-width: none;  border: none;}.rendered_html th {  font-weight: bold;}.rendered_html tbody tr:nth-child(odd) {  background: #f5f5f5;}.rendered_html tbody tr:hover {  background: rgba(66, 165, 245, 0.2);}.rendered_html * + table {  margin-top: 1em;}.rendered_html p {  text-align: left;}.rendered_html * + p {  margin-top: 1em;}.rendered_html img {  display: block;  margin-left: auto;  margin-right: auto;}.rendered_html * + img {  margin-top: 1em;}.rendered_html img,.rendered_html svg {  max-width: 100%;  height: auto;}.rendered_html img.unconfined,.rendered_html svg.unconfined {  max-width: none;}.rendered_html .alert {  margin-bottom: initial;}.rendered_html * + .alert {  margin-top: 1em;}[dir='rtl'] .rendered_html p {  text-align: right;}div.text_cell {  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: horizontal;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: horizontal;  -moz-box-align: stretch;  display: box;  box-orient: horizontal;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: row;  align-items: stretch;}@media (max-width: 540px) {  div.text_cell > div.prompt {    display: none;  }}div.text_cell_render {  /*font-family: 'Helvetica Neue', Arial, Helvetica, Geneva, sans-serif;*/  outline: none;  resize: none;  width: inherit;  border-style: none;  padding: 0.5em 0.5em 0.5em 0.4em;  color: #000;  box-sizing: border-box;  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;}a.anchor-link:link {  text-decoration: none;  padding: 0px 20px;  visibility: hidden;}h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link {  visibility: visible;}.text_cell.rendered .input_area {  display: none;}.text_cell.rendered .rendered_html {  overflow-x: auto;  overflow-y: hidden;}.text_cell.rendered .rendered_html tr,.text_cell.rendered .rendered_html th,.text_cell.rendered .rendered_html td {  max-width: none;}.text_cell.unrendered .text_cell_render {  display: none;}.text_cell .dropzone .input_area {  border: 2px dashed #bababa;  margin: -1px;}.cm-header-1,.cm-header-2,.cm-header-3,.cm-header-4,.cm-header-5,.cm-header-6 {  font-weight: bold;  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;}.cm-header-1 {  font-size: 185.7%;}.cm-header-2 {  font-size: 157.1%;}.cm-header-3 {  font-size: 128.6%;}.cm-header-4 {  font-size: 110%;}.cm-header-5 {  font-size: 100%;  font-style: italic;}.cm-header-6 {  font-size: 100%;  font-style: italic;}/*!** IPython notebook webapp**/@media (max-width: 767px) {  .notebook_app {    padding-left: 0px;    padding-right: 0px;  }}#ipython-main-app {  box-sizing: border-box;  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;  height: 100%;}div#notebook_panel {  margin: 0px;  padding: 0px;  box-sizing: border-box;  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;  height: 100%;}div#notebook {  font-size: 14px;  line-height: 20px;  overflow-y: hidden;  overflow-x: auto;  width: 100%;  /* This spaces the page away from the edge of the notebook area */  padding-top: 20px;  margin: 0px;  outline: none;  box-sizing: border-box;  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;  min-height: 100%;}@media not print {  #notebook-container {    padding: 15px;    background-color: #fff;    min-height: 0;    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);  }}@media print {  #notebook-container {    width: 100%;  }}div.ui-widget-content {  border: 1px solid #ababab;  outline: none;}pre.dialog {  background-color: #f7f7f7;  border: 1px solid #ddd;  border-radius: 2px;  padding: 0.4em;  padding-left: 2em;}p.dialog {  padding: 0.2em;}/* Word-wrap output correctly.  This is the CSS3 spelling, though Firefox seems   to not honor it correctly.  Webkit browsers (Chrome, rekonq, Safari) do. */pre,code,kbd,samp {  white-space: pre-wrap;}#fonttest {  font-family: monospace;}p {  margin-bottom: 0;}.end_space {  min-height: 100px;  transition: height .2s ease;}.notebook_app > #header {  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);}@media not print {  .notebook_app {    background-color: #EEE;  }}kbd {  border-style: solid;  border-width: 1px;  box-shadow: none;  margin: 2px;  padding-left: 2px;  padding-right: 2px;  padding-top: 1px;  padding-bottom: 1px;}.jupyter-keybindings {  padding: 1px;  line-height: 24px;  border-bottom: 1px solid gray;}.jupyter-keybindings input {  margin: 0;  padding: 0;  border: none;}.jupyter-keybindings i {  padding: 6px;}.well code {  background-color: #ffffff;  border-color: #ababab;  border-width: 1px;  border-style: solid;  padding: 2px;  padding-top: 1px;  padding-bottom: 1px;}/* CSS for the cell toolbar */.celltoolbar {  border: thin solid #CFCFCF;  border-bottom: none;  background: #EEE;  border-radius: 2px 2px 0px 0px;  width: 100%;  height: 29px;  padding-right: 4px;  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: horizontal;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: horizontal;  -moz-box-align: stretch;  display: box;  box-orient: horizontal;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: row;  align-items: stretch;  /* Old browsers */  -webkit-box-pack: end;  -moz-box-pack: end;  box-pack: end;  /* Modern browsers */  justify-content: flex-end;  display: -webkit-flex;}@media print {  .celltoolbar {    display: none;  }}.ctb_hideshow {  display: none;  vertical-align: bottom;}/* ctb_show is added to the ctb_hideshow div to show the cell toolbar.   Cell toolbars are only shown when the ctb_global_show class is also set.*/.ctb_global_show .ctb_show.ctb_hideshow {  display: block;}.ctb_global_show .ctb_show + .input_area,.ctb_global_show .ctb_show + div.text_cell_input,.ctb_global_show .ctb_show ~ div.text_cell_render {  border-top-right-radius: 0px;  border-top-left-radius: 0px;}.ctb_global_show .ctb_show ~ div.text_cell_render {  border: 1px solid #cfcfcf;}.celltoolbar {  font-size: 87%;  padding-top: 3px;}.celltoolbar select {  display: block;  width: 100%;  height: 32px;  padding: 6px 12px;  font-size: 13px;  line-height: 1.42857143;  color: #555555;  background-color: #fff;  background-image: none;  border: 1px solid #ccc;  border-radius: 2px;  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;  height: 30px;  padding: 5px 10px;  font-size: 12px;  line-height: 1.5;  border-radius: 1px;  width: inherit;  font-size: inherit;  height: 22px;  padding: 0px;  display: inline-block;}.celltoolbar select:focus {  border-color: #66afe9;  outline: 0;  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);}.celltoolbar select::-moz-placeholder {  color: #999;  opacity: 1;}.celltoolbar select:-ms-input-placeholder {  color: #999;}.celltoolbar select::-webkit-input-placeholder {  color: #999;}.celltoolbar select::-ms-expand {  border: 0;  background-color: transparent;}.celltoolbar select[disabled],.celltoolbar select[readonly],fieldset[disabled] .celltoolbar select {  background-color: #eeeeee;  opacity: 1;}.celltoolbar select[disabled],fieldset[disabled] .celltoolbar select {  cursor: not-allowed;}textarea.celltoolbar select {  height: auto;}select.celltoolbar select {  height: 30px;  line-height: 30px;}textarea.celltoolbar select,select[multiple].celltoolbar select {  height: auto;}.celltoolbar label {  margin-left: 5px;  margin-right: 5px;}.tags_button_container {  width: 100%;  display: flex;}.tag-container {  display: flex;  flex-direction: row;  flex-grow: 1;  overflow: hidden;  position: relative;}.tag-container > * {  margin: 0 4px;}.remove-tag-btn {  margin-left: 4px;}.tags-input {  display: flex;}.cell-tag:last-child:after {  content: '';  position: absolute;  right: 0;  width: 40px;  height: 100%;  /* Fade to background color of cell toolbar */  background: linear-gradient(to right, rgba(0, 0, 0, 0), #EEE);}.tags-input > * {  margin-left: 4px;}.cell-tag,.tags-input input,.tags-input button {  display: block;  width: 100%;  height: 32px;  padding: 6px 12px;  font-size: 13px;  line-height: 1.42857143;  color: #555555;  background-color: #fff;  background-image: none;  border: 1px solid #ccc;  border-radius: 2px;  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;  height: 30px;  padding: 5px 10px;  font-size: 12px;  line-height: 1.5;  border-radius: 1px;  box-shadow: none;  width: inherit;  font-size: inherit;  height: 22px;  line-height: 22px;  padding: 0px 4px;  display: inline-block;}.cell-tag:focus,.tags-input input:focus,.tags-input button:focus {  border-color: #66afe9;  outline: 0;  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);}.cell-tag::-moz-placeholder,.tags-input input::-moz-placeholder,.tags-input button::-moz-placeholder {  color: #999;  opacity: 1;}.cell-tag:-ms-input-placeholder,.tags-input input:-ms-input-placeholder,.tags-input button:-ms-input-placeholder {  color: #999;}.cell-tag::-webkit-input-placeholder,.tags-input input::-webkit-input-placeholder,.tags-input button::-webkit-input-placeholder {  color: #999;}.cell-tag::-ms-expand,.tags-input input::-ms-expand,.tags-input button::-ms-expand {  border: 0;  background-color: transparent;}.cell-tag[disabled],.tags-input input[disabled],.tags-input button[disabled],.cell-tag[readonly],.tags-input input[readonly],.tags-input button[readonly],fieldset[disabled] .cell-tag,fieldset[disabled] .tags-input input,fieldset[disabled] .tags-input button {  background-color: #eeeeee;  opacity: 1;}.cell-tag[disabled],.tags-input input[disabled],.tags-input button[disabled],fieldset[disabled] .cell-tag,fieldset[disabled] .tags-input input,fieldset[disabled] .tags-input button {  cursor: not-allowed;}textarea.cell-tag,textarea.tags-input input,textarea.tags-input button {  height: auto;}select.cell-tag,select.tags-input input,select.tags-input button {  height: 30px;  line-height: 30px;}textarea.cell-tag,textarea.tags-input input,textarea.tags-input button,select[multiple].cell-tag,select[multiple].tags-input input,select[multiple].tags-input button {  height: auto;}.cell-tag,.tags-input button {  padding: 0px 4px;}.cell-tag {  background-color: #fff;  white-space: nowrap;}.tags-input input[type=text]:focus {  outline: none;  box-shadow: none;  border-color: #ccc;}.completions {  position: absolute;  z-index: 110;  overflow: hidden;  border: 1px solid #ababab;  border-radius: 2px;  -webkit-box-shadow: 0px 6px 10px -1px #adadad;  box-shadow: 0px 6px 10px -1px #adadad;  line-height: 1;}.completions select {  background: white;  outline: none;  border: none;  padding: 0px;  margin: 0px;  overflow: auto;  font-family: monospace;  font-size: 110%;  color: #000;  width: auto;}.completions select option.context {  color: #286090;}#kernel_logo_widget .current_kernel_logo {  display: none;  margin-top: -1px;  margin-bottom: -1px;  width: 32px;  height: 32px;}[dir='rtl'] #kernel_logo_widget {  float: left !important;  float: left;}.modal .modal-body .move-path {  display: flex;  flex-direction: row;  justify-content: space;  align-items: center;}.modal .modal-body .move-path .server-root {  padding-right: 20px;}.modal .modal-body .move-path .path-input {  flex: 1;}#menubar {  box-sizing: border-box;  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;  margin-top: 1px;}#menubar .navbar {  border-top: 1px;  border-radius: 0px 0px 2px 2px;  margin-bottom: 0px;}#menubar .navbar-toggle {  float: left;  padding-top: 7px;  padding-bottom: 7px;  border: none;}#menubar .navbar-collapse {  clear: left;}[dir='rtl'] #menubar .navbar-toggle {  float: right;}[dir='rtl'] #menubar .navbar-collapse {  clear: right;}[dir='rtl'] #menubar .navbar-nav {  float: right;}[dir='rtl'] #menubar .nav {  padding-right: 0px;}[dir='rtl'] #menubar .navbar-nav > li {  float: right;}[dir='rtl'] #menubar .navbar-right {  float: left !important;}[dir='rtl'] ul.dropdown-menu {  text-align: right;  left: auto;}[dir='rtl'] ul#new-menu.dropdown-menu {  right: auto;  left: 0;}.nav-wrapper {  border-bottom: 1px solid #e7e7e7;}i.menu-icon {  padding-top: 4px;}[dir='rtl'] i.menu-icon.pull-right {  float: left !important;  float: left;}ul#help_menu li a {  overflow: hidden;  padding-right: 2.2em;}ul#help_menu li a i {  margin-right: -1.2em;}[dir='rtl'] ul#help_menu li a {  padding-left: 2.2em;}[dir='rtl'] ul#help_menu li a i {  margin-right: 0;  margin-left: -1.2em;}[dir='rtl'] ul#help_menu li a i.pull-right {  float: left !important;  float: left;}.dropdown-submenu {  position: relative;}.dropdown-submenu > .dropdown-menu {  top: 0;  left: 100%;  margin-top: -6px;  margin-left: -1px;}[dir='rtl'] .dropdown-submenu > .dropdown-menu {  right: 100%;  margin-right: -1px;}.dropdown-submenu:hover > .dropdown-menu {  display: block;}.dropdown-submenu > a:after {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  display: block;  content: '\f0da';  float: right;  color: #333333;  margin-top: 2px;  margin-right: -10px;}.dropdown-submenu > a:after.fa-pull-left {  margin-right: .3em;}.dropdown-submenu > a:after.fa-pull-right {  margin-left: .3em;}.dropdown-submenu > a:after.pull-left {  margin-right: .3em;}.dropdown-submenu > a:after.pull-right {  margin-left: .3em;}[dir='rtl'] .dropdown-submenu > a:after {  float: left;  content: '\f0d9';  margin-right: 0;  margin-left: -10px;}.dropdown-submenu:hover > a:after {  color: #262626;}.dropdown-submenu.pull-left {  float: none;}.dropdown-submenu.pull-left > .dropdown-menu {  left: -100%;  margin-left: 10px;}#notification_area {  float: right !important;  float: right;  z-index: 10;}[dir='rtl'] #notification_area {  float: left !important;  float: left;}.indicator_area {  float: right !important;  float: right;  color: #777;  margin-left: 5px;  margin-right: 5px;  width: 11px;  z-index: 10;  text-align: center;  width: auto;}[dir='rtl'] .indicator_area {  float: left !important;  float: left;}#kernel_indicator {  float: right !important;  float: right;  color: #777;  margin-left: 5px;  margin-right: 5px;  width: 11px;  z-index: 10;  text-align: center;  width: auto;  border-left: 1px solid;}#kernel_indicator .kernel_indicator_name {  padding-left: 5px;  padding-right: 5px;}[dir='rtl'] #kernel_indicator {  float: left !important;  float: left;  border-left: 0;  border-right: 1px solid;}#modal_indicator {  float: right !important;  float: right;  color: #777;  margin-left: 5px;  margin-right: 5px;  width: 11px;  z-index: 10;  text-align: center;  width: auto;}[dir='rtl'] #modal_indicator {  float: left !important;  float: left;}#readonly-indicator {  float: right !important;  float: right;  color: #777;  margin-left: 5px;  margin-right: 5px;  width: 11px;  z-index: 10;  text-align: center;  width: auto;  margin-top: 2px;  margin-bottom: 0px;  margin-left: 0px;  margin-right: 0px;  display: none;}.modal_indicator:before {  width: 1.28571429em;  text-align: center;}.edit_mode .modal_indicator:before {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  content: '\f040';}.edit_mode .modal_indicator:before.fa-pull-left {  margin-right: .3em;}.edit_mode .modal_indicator:before.fa-pull-right {  margin-left: .3em;}.edit_mode .modal_indicator:before.pull-left {  margin-right: .3em;}.edit_mode .modal_indicator:before.pull-right {  margin-left: .3em;}.command_mode .modal_indicator:before {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  content: ' ';}.command_mode .modal_indicator:before.fa-pull-left {  margin-right: .3em;}.command_mode .modal_indicator:before.fa-pull-right {  margin-left: .3em;}.command_mode .modal_indicator:before.pull-left {  margin-right: .3em;}.command_mode .modal_indicator:before.pull-right {  margin-left: .3em;}.kernel_idle_icon:before {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  content: '\f10c';}.kernel_idle_icon:before.fa-pull-left {  margin-right: .3em;}.kernel_idle_icon:before.fa-pull-right {  margin-left: .3em;}.kernel_idle_icon:before.pull-left {  margin-right: .3em;}.kernel_idle_icon:before.pull-right {  margin-left: .3em;}.kernel_busy_icon:before {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  content: '\f111';}.kernel_busy_icon:before.fa-pull-left {  margin-right: .3em;}.kernel_busy_icon:before.fa-pull-right {  margin-left: .3em;}.kernel_busy_icon:before.pull-left {  margin-right: .3em;}.kernel_busy_icon:before.pull-right {  margin-left: .3em;}.kernel_dead_icon:before {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  content: '\f1e2';}.kernel_dead_icon:before.fa-pull-left {  margin-right: .3em;}.kernel_dead_icon:before.fa-pull-right {  margin-left: .3em;}.kernel_dead_icon:before.pull-left {  margin-right: .3em;}.kernel_dead_icon:before.pull-right {  margin-left: .3em;}.kernel_disconnected_icon:before {  display: inline-block;  font: normal normal normal 14px/1 FontAwesome;  font-size: inherit;  text-rendering: auto;  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;  content: '\f127';}.kernel_disconnected_icon:before.fa-pull-left {  margin-right: .3em;}.kernel_disconnected_icon:before.fa-pull-right {  margin-left: .3em;}.kernel_disconnected_icon:before.pull-left {  margin-right: .3em;}.kernel_disconnected_icon:before.pull-right {  margin-left: .3em;}.notification_widget {  color: #777;  z-index: 10;  background: rgba(240, 240, 240, 0.5);  margin-right: 4px;  color: #333;  background-color: #fff;  border-color: #ccc;}.notification_widget:focus,.notification_widget.focus {  color: #333;  background-color: #e6e6e6;  border-color: #8c8c8c;}.notification_widget:hover {  color: #333;  background-color: #e6e6e6;  border-color: #adadad;}.notification_widget:active,.notification_widget.active,.open > .dropdown-toggle.notification_widget {  color: #333;  background-color: #e6e6e6;  border-color: #adadad;}.notification_widget:active:hover,.notification_widget.active:hover,.open > .dropdown-toggle.notification_widget:hover,.notification_widget:active:focus,.notification_widget.active:focus,.open > .dropdown-toggle.notification_widget:focus,.notification_widget:active.focus,.notification_widget.active.focus,.open > .dropdown-toggle.notification_widget.focus {  color: #333;  background-color: #d4d4d4;  border-color: #8c8c8c;}.notification_widget:active,.notification_widget.active,.open > .dropdown-toggle.notification_widget {  background-image: none;}.notification_widget.disabled:hover,.notification_widget[disabled]:hover,fieldset[disabled] .notification_widget:hover,.notification_widget.disabled:focus,.notification_widget[disabled]:focus,fieldset[disabled] .notification_widget:focus,.notification_widget.disabled.focus,.notification_widget[disabled].focus,fieldset[disabled] .notification_widget.focus {  background-color: #fff;  border-color: #ccc;}.notification_widget .badge {  color: #fff;  background-color: #333;}.notification_widget.warning {  color: #fff;  background-color: #f0ad4e;  border-color: #eea236;}.notification_widget.warning:focus,.notification_widget.warning.focus {  color: #fff;  background-color: #ec971f;  border-color: #985f0d;}.notification_widget.warning:hover {  color: #fff;  background-color: #ec971f;  border-color: #d58512;}.notification_widget.warning:active,.notification_widget.warning.active,.open > .dropdown-toggle.notification_widget.warning {  color: #fff;  background-color: #ec971f;  border-color: #d58512;}.notification_widget.warning:active:hover,.notification_widget.warning.active:hover,.open > .dropdown-toggle.notification_widget.warning:hover,.notification_widget.warning:active:focus,.notification_widget.warning.active:focus,.open > .dropdown-toggle.notification_widget.warning:focus,.notification_widget.warning:active.focus,.notification_widget.warning.active.focus,.open > .dropdown-toggle.notification_widget.warning.focus {  color: #fff;  background-color: #d58512;  border-color: #985f0d;}.notification_widget.warning:active,.notification_widget.warning.active,.open > .dropdown-toggle.notification_widget.warning {  background-image: none;}.notification_widget.warning.disabled:hover,.notification_widget.warning[disabled]:hover,fieldset[disabled] .notification_widget.warning:hover,.notification_widget.warning.disabled:focus,.notification_widget.warning[disabled]:focus,fieldset[disabled] .notification_widget.warning:focus,.notification_widget.warning.disabled.focus,.notification_widget.warning[disabled].focus,fieldset[disabled] .notification_widget.warning.focus {  background-color: #f0ad4e;  border-color: #eea236;}.notification_widget.warning .badge {  color: #f0ad4e;  background-color: #fff;}.notification_widget.success {  color: #fff;  background-color: #5cb85c;  border-color: #4cae4c;}.notification_widget.success:focus,.notification_widget.success.focus {  color: #fff;  background-color: #449d44;  border-color: #255625;}.notification_widget.success:hover {  color: #fff;  background-color: #449d44;  border-color: #398439;}.notification_widget.success:active,.notification_widget.success.active,.open > .dropdown-toggle.notification_widget.success {  color: #fff;  background-color: #449d44;  border-color: #398439;}.notification_widget.success:active:hover,.notification_widget.success.active:hover,.open > .dropdown-toggle.notification_widget.success:hover,.notification_widget.success:active:focus,.notification_widget.success.active:focus,.open > .dropdown-toggle.notification_widget.success:focus,.notification_widget.success:active.focus,.notification_widget.success.active.focus,.open > .dropdown-toggle.notification_widget.success.focus {  color: #fff;  background-color: #398439;  border-color: #255625;}.notification_widget.success:active,.notification_widget.success.active,.open > .dropdown-toggle.notification_widget.success {  background-image: none;}.notification_widget.success.disabled:hover,.notification_widget.success[disabled]:hover,fieldset[disabled] .notification_widget.success:hover,.notification_widget.success.disabled:focus,.notification_widget.success[disabled]:focus,fieldset[disabled] .notification_widget.success:focus,.notification_widget.success.disabled.focus,.notification_widget.success[disabled].focus,fieldset[disabled] .notification_widget.success.focus {  background-color: #5cb85c;  border-color: #4cae4c;}.notification_widget.success .badge {  color: #5cb85c;  background-color: #fff;}.notification_widget.info {  color: #fff;  background-color: #5bc0de;  border-color: #46b8da;}.notification_widget.info:focus,.notification_widget.info.focus {  color: #fff;  background-color: #31b0d5;  border-color: #1b6d85;}.notification_widget.info:hover {  color: #fff;  background-color: #31b0d5;  border-color: #269abc;}.notification_widget.info:active,.notification_widget.info.active,.open > .dropdown-toggle.notification_widget.info {  color: #fff;  background-color: #31b0d5;  border-color: #269abc;}.notification_widget.info:active:hover,.notification_widget.info.active:hover,.open > .dropdown-toggle.notification_widget.info:hover,.notification_widget.info:active:focus,.notification_widget.info.active:focus,.open > .dropdown-toggle.notification_widget.info:focus,.notification_widget.info:active.focus,.notification_widget.info.active.focus,.open > .dropdown-toggle.notification_widget.info.focus {  color: #fff;  background-color: #269abc;  border-color: #1b6d85;}.notification_widget.info:active,.notification_widget.info.active,.open > .dropdown-toggle.notification_widget.info {  background-image: none;}.notification_widget.info.disabled:hover,.notification_widget.info[disabled]:hover,fieldset[disabled] .notification_widget.info:hover,.notification_widget.info.disabled:focus,.notification_widget.info[disabled]:focus,fieldset[disabled] .notification_widget.info:focus,.notification_widget.info.disabled.focus,.notification_widget.info[disabled].focus,fieldset[disabled] .notification_widget.info.focus {  background-color: #5bc0de;  border-color: #46b8da;}.notification_widget.info .badge {  color: #5bc0de;  background-color: #fff;}.notification_widget.danger {  color: #fff;  background-color: #d9534f;  border-color: #d43f3a;}.notification_widget.danger:focus,.notification_widget.danger.focus {  color: #fff;  background-color: #c9302c;  border-color: #761c19;}.notification_widget.danger:hover {  color: #fff;  background-color: #c9302c;  border-color: #ac2925;}.notification_widget.danger:active,.notification_widget.danger.active,.open > .dropdown-toggle.notification_widget.danger {  color: #fff;  background-color: #c9302c;  border-color: #ac2925;}.notification_widget.danger:active:hover,.notification_widget.danger.active:hover,.open > .dropdown-toggle.notification_widget.danger:hover,.notification_widget.danger:active:focus,.notification_widget.danger.active:focus,.open > .dropdown-toggle.notification_widget.danger:focus,.notification_widget.danger:active.focus,.notification_widget.danger.active.focus,.open > .dropdown-toggle.notification_widget.danger.focus {  color: #fff;  background-color: #ac2925;  border-color: #761c19;}.notification_widget.danger:active,.notification_widget.danger.active,.open > .dropdown-toggle.notification_widget.danger {  background-image: none;}.notification_widget.danger.disabled:hover,.notification_widget.danger[disabled]:hover,fieldset[disabled] .notification_widget.danger:hover,.notification_widget.danger.disabled:focus,.notification_widget.danger[disabled]:focus,fieldset[disabled] .notification_widget.danger:focus,.notification_widget.danger.disabled.focus,.notification_widget.danger[disabled].focus,fieldset[disabled] .notification_widget.danger.focus {  background-color: #d9534f;  border-color: #d43f3a;}.notification_widget.danger .badge {  color: #d9534f;  background-color: #fff;}div#pager {  background-color: #fff;  font-size: 14px;  line-height: 20px;  overflow: hidden;  display: none;  position: fixed;  bottom: 0px;  width: 100%;  max-height: 50%;  padding-top: 8px;  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);  /* Display over codemirror */  z-index: 100;  /* Hack which prevents jquery ui resizable from changing top. */  top: auto !important;}div#pager pre {  line-height: 1.21429em;  color: #000;  background-color: #f7f7f7;  padding: 0.4em;}div#pager #pager-button-area {  position: absolute;  top: 8px;  right: 20px;}div#pager #pager-contents {  position: relative;  overflow: auto;  width: 100%;  height: 100%;}div#pager #pager-contents #pager-container {  position: relative;  padding: 15px 0px;  box-sizing: border-box;  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;}div#pager .ui-resizable-handle {  top: 0px;  height: 8px;  background: #f7f7f7;  border-top: 1px solid #cfcfcf;  border-bottom: 1px solid #cfcfcf;  /* This injects handle bars (a short, wide = symbol) for         the resize handle. */}div#pager .ui-resizable-handle::after {  content: '';  top: 2px;  left: 50%;  height: 3px;  width: 30px;  margin-left: -15px;  position: absolute;  border-top: 1px solid #cfcfcf;}.quickhelp {  /* Old browsers */  display: -webkit-box;  -webkit-box-orient: horizontal;  -webkit-box-align: stretch;  display: -moz-box;  -moz-box-orient: horizontal;  -moz-box-align: stretch;  display: box;  box-orient: horizontal;  box-align: stretch;  /* Modern browsers */  display: flex;  flex-direction: row;  align-items: stretch;  line-height: 1.8em;}.shortcut_key {  display: inline-block;  width: 21ex;  text-align: right;  font-family: monospace;}.shortcut_descr {  display: inline-block;  /* Old browsers */  -webkit-box-flex: 1;  -moz-box-flex: 1;  box-flex: 1;  /* Modern browsers */  flex: 1;}span.save_widget {  height: 30px;  margin-top: 4px;  display: flex;  justify-content: flex-start;  align-items: baseline;  width: 50%;  flex: 1;}span.save_widget span.filename {  height: 100%;  line-height: 1em;  margin-left: 16px;  border: none;  font-size: 146.5%;  text-overflow: ellipsis;  overflow: hidden;  white-space: nowrap;  border-radius: 2px;}span.save_widget span.filename:hover {  background-color: #e6e6e6;}[dir='rtl'] span.save_widget.pull-left {  float: right !important;  float: right;}[dir='rtl'] span.save_widget span.filename {  margin-left: 0;  margin-right: 16px;}span.checkpoint_status,span.autosave_status {  font-size: small;  white-space: nowrap;  padding: 0 5px;}@media (max-width: 767px) {  span.save_widget {    font-size: small;    padding: 0 0 0 5px;  }  span.checkpoint_status,  span.autosave_status {    display: none;  }}@media (min-width: 768px) and (max-width: 991px) {  span.checkpoint_status {    display: none;  }  span.autosave_status {    font-size: x-small;  }}.toolbar {  padding: 0px;  margin-left: -5px;  margin-top: 2px;  margin-bottom: 5px;  box-sizing: border-box;  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;}.toolbar select,.toolbar label {  width: auto;  vertical-align: middle;  margin-right: 2px;  margin-bottom: 0px;  display: inline;  font-size: 92%;  margin-left: 0.3em;  margin-right: 0.3em;  padding: 0px;  padding-top: 3px;}.toolbar .btn {  padding: 2px 8px;}.toolbar .btn-group {  margin-top: 0px;  margin-left: 5px;}.toolbar-btn-label {  margin-left: 6px;}#maintoolbar {  margin-bottom: -3px;  margin-top: -8px;  border: 0px;  min-height: 27px;  margin-left: 0px;  padding-top: 11px;  padding-bottom: 3px;}#maintoolbar .navbar-text {  float: none;  vertical-align: middle;  text-align: right;  margin-left: 5px;  margin-right: 0px;  margin-top: 0px;}.select-xs {  height: 24px;}[dir='rtl'] .btn-group > .btn,.btn-group-vertical > .btn {  float: right;}.pulse,.dropdown-menu > li > a.pulse,li.pulse > a.dropdown-toggle,li.pulse.open > a.dropdown-toggle {  background-color: #F37626;  color: white;}/** * Primary styles * * Author: Jupyter Development Team *//** WARNING IF YOU ARE EDITTING THIS FILE, if this is a .css file, It has a lot * of chance of beeing generated from the ../less/[samename].less file, you can * try to get back the less file by reverting somme commit in history **//* * We'll try to get something pretty, so we * have some strange css to have the scroll bar on * the left with fix button on the top right of the tooltip */@-moz-keyframes fadeOut {  from {    opacity: 1;  }  to {    opacity: 0;  }}@-webkit-keyframes fadeOut {  from {    opacity: 1;  }  to {    opacity: 0;  }}@-moz-keyframes fadeIn {  from {    opacity: 0;  }  to {    opacity: 1;  }}@-webkit-keyframes fadeIn {  from {    opacity: 0;  }  to {    opacity: 1;  }}/*properties of tooltip after 'expand'*/.bigtooltip {  overflow: auto;  height: 200px;  -webkit-transition-property: height;  -webkit-transition-duration: 500ms;  -moz-transition-property: height;  -moz-transition-duration: 500ms;  transition-property: height;  transition-duration: 500ms;}/*properties of tooltip before 'expand'*/.smalltooltip {  -webkit-transition-property: height;  -webkit-transition-duration: 500ms;  -moz-transition-property: height;  -moz-transition-duration: 500ms;  transition-property: height;  transition-duration: 500ms;  text-overflow: ellipsis;  overflow: hidden;  height: 80px;}.tooltipbuttons {  position: absolute;  padding-right: 15px;  top: 0px;  right: 0px;}.tooltiptext {  /*avoid the button to overlap on some docstring*/  padding-right: 30px;}.ipython_tooltip {  max-width: 700px;  /*fade-in animation when inserted*/  -webkit-animation: fadeOut 400ms;  -moz-animation: fadeOut 400ms;  animation: fadeOut 400ms;  -webkit-animation: fadeIn 400ms;  -moz-animation: fadeIn 400ms;  animation: fadeIn 400ms;  vertical-align: middle;  background-color: #f7f7f7;  overflow: visible;  border: #ababab 1px solid;  outline: none;  padding: 3px;  margin: 0px;  padding-left: 7px;  font-family: monospace;  min-height: 50px;  -moz-box-shadow: 0px 6px 10px -1px #adadad;  -webkit-box-shadow: 0px 6px 10px -1px #adadad;  box-shadow: 0px 6px 10px -1px #adadad;  border-radius: 2px;  position: absolute;  z-index: 1000;}.ipython_tooltip a {  float: right;}.ipython_tooltip .tooltiptext pre {  border: 0;  border-radius: 0;  font-size: 100%;  background-color: #f7f7f7;}.pretooltiparrow {  left: 0px;  margin: 0px;  top: -16px;  width: 40px;  height: 16px;  overflow: hidden;  position: absolute;}.pretooltiparrow:before {  background-color: #f7f7f7;  border: 1px #ababab solid;  z-index: 11;  content: '';  position: absolute;  left: 15px;  top: 10px;  width: 25px;  height: 25px;  -webkit-transform: rotate(45deg);  -moz-transform: rotate(45deg);  -ms-transform: rotate(45deg);  -o-transform: rotate(45deg);}ul.typeahead-list i {  margin-left: -10px;  width: 18px;}[dir='rtl'] ul.typeahead-list i {  margin-left: 0;  margin-right: -10px;}ul.typeahead-list {  max-height: 80vh;  overflow: auto;}ul.typeahead-list > li > a {  /** Firefox bug **/  /* see https://github.com/jupyter/notebook/issues/559 */  white-space: normal;}ul.typeahead-list  > li > a.pull-right {  float: left !important;  float: left;}[dir='rtl'] .typeahead-list {  text-align: right;}.cmd-palette .modal-body {  padding: 7px;}.cmd-palette form {  background: white;}.cmd-palette input {  outline: none;}.no-shortcut {  min-width: 20px;  color: transparent;}[dir='rtl'] .no-shortcut.pull-right {  float: left !important;  float: left;}[dir='rtl'] .command-shortcut.pull-right {  float: left !important;  float: left;}.command-shortcut:before {  content: '(command mode)';  padding-right: 3px;  color: #777777;}.edit-shortcut:before {  content: '(edit)';  padding-right: 3px;  color: #777777;}[dir='rtl'] .edit-shortcut.pull-right {  float: left !important;  float: left;}#find-and-replace #replace-preview .match,#find-and-replace #replace-preview .insert {  background-color: #BBDEFB;  border-color: #90CAF9;  border-style: solid;  border-width: 1px;  border-radius: 0px;}[dir='ltr'] #find-and-replace .input-group-btn + .form-control {  border-left: none;}[dir='rtl'] #find-and-replace .input-group-btn + .form-control {  border-right: none;}#find-and-replace #replace-preview .replace .match {  background-color: #FFCDD2;  border-color: #EF9A9A;  border-radius: 0px;}#find-and-replace #replace-preview .replace .insert {  background-color: #C8E6C9;  border-color: #A5D6A7;  border-radius: 0px;}#find-and-replace #replace-preview {  max-height: 60vh;  overflow: auto;}#find-and-replace #replace-preview pre {  padding: 5px 10px;}.terminal-app {  background: #EEE;}.terminal-app #header {  background: #fff;  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);}.terminal-app .terminal {  width: 100%;  float: left;  font-family: monospace;  color: white;  background: black;  padding: 0.4em;  border-radius: 2px;  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);}.terminal-app .terminal,.terminal-app .terminal dummy-screen {  line-height: 1em;  font-size: 14px;}.terminal-app .terminal .xterm-rows {  padding: 10px;}.terminal-app .terminal-cursor {  color: black;  background: white;}.terminal-app #terminado-container {  margin-top: 20px;}/*# sourceMappingURL=style.min.css.map */    </style><style type='text/css'>    .highlight .hll { background-color: #ffffcc }.highlight  { background: #f8f8f8; }.highlight .c { color: #408080; font-style: italic } /* Comment */.highlight .err { border: 1px solid #FF0000 } /* Error */.highlight .k { color: #008000; font-weight: bold } /* Keyword */.highlight .o { color: #666666 } /* Operator */.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */.highlight .cp { color: #BC7A00 } /* Comment.Preproc */.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */.highlight .gd { color: #A00000 } /* Generic.Deleted */.highlight .ge { font-style: italic } /* Generic.Emph */.highlight .gr { color: #FF0000 } /* Generic.Error */.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */.highlight .gi { color: #00A000 } /* Generic.Inserted */.highlight .go { color: #888888 } /* Generic.Output */.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */.highlight .gs { font-weight: bold } /* Generic.Strong */.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */.highlight .gt { color: #0044DD } /* Generic.Traceback */.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */.highlight .kp { color: #008000 } /* Keyword.Pseudo */.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */.highlight .kt { color: #B00040 } /* Keyword.Type */.highlight .m { color: #666666 } /* Literal.Number */.highlight .s { color: #BA2121 } /* Literal.String */.highlight .na { color: #7D9029 } /* Name.Attribute */.highlight .nb { color: #008000 } /* Name.Builtin */.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */.highlight .no { color: #880000 } /* Name.Constant */.highlight .nd { color: #AA22FF } /* Name.Decorator */.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */.highlight .nf { color: #0000FF } /* Name.Function */.highlight .nl { color: #A0A000 } /* Name.Label */.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */.highlight .nv { color: #19177C } /* Name.Variable */.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */.highlight .w { color: #bbbbbb } /* Text.Whitespace */.highlight .mb { color: #666666 } /* Literal.Number.Bin */.highlight .mf { color: #666666 } /* Literal.Number.Float */.highlight .mh { color: #666666 } /* Literal.Number.Hex */.highlight .mi { color: #666666 } /* Literal.Number.Integer */.highlight .mo { color: #666666 } /* Literal.Number.Oct */.highlight .sa { color: #BA2121 } /* Literal.String.Affix */.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */.highlight .sc { color: #BA2121 } /* Literal.String.Char */.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */.highlight .s2 { color: #BA2121 } /* Literal.String.Double */.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */.highlight .sx { color: #008000 } /* Literal.String.Other */.highlight .sr { color: #BB6688 } /* Literal.String.Regex */.highlight .s1 { color: #BA2121 } /* Literal.String.Single */.highlight .ss { color: #19177C } /* Literal.String.Symbol */.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */.highlight .fm { color: #0000FF } /* Name.Function.Magic */.highlight .vc { color: #19177C } /* Name.Variable.Class */.highlight .vg { color: #19177C } /* Name.Variable.Global */.highlight .vi { color: #19177C } /* Name.Variable.Instance */.highlight .vm { color: #19177C } /* Name.Variable.Magic */.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */    </style><style type='text/css'>    /* Temporary definitions which will become obsolete with Notebook release 5.0 */.ansi-black-fg { color: #3E424D; }.ansi-black-bg { background-color: #3E424D; }.ansi-black-intense-fg { color: #282C36; }.ansi-black-intense-bg { background-color: #282C36; }.ansi-red-fg { color: #E75C58; }.ansi-red-bg { background-color: #E75C58; }.ansi-red-intense-fg { color: #B22B31; }.ansi-red-intense-bg { background-color: #B22B31; }.ansi-green-fg { color: #00A250; }.ansi-green-bg { background-color: #00A250; }.ansi-green-intense-fg { color: #007427; }.ansi-green-intense-bg { background-color: #007427; }.ansi-yellow-fg { color: #DDB62B; }.ansi-yellow-bg { background-color: #DDB62B; }.ansi-yellow-intense-fg { color: #B27D12; }.ansi-yellow-intense-bg { background-color: #B27D12; }.ansi-blue-fg { color: #208FFB; }.ansi-blue-bg { background-color: #208FFB; }.ansi-blue-intense-fg { color: #0065CA; }.ansi-blue-intense-bg { background-color: #0065CA; }.ansi-magenta-fg { color: #D160C4; }.ansi-magenta-bg { background-color: #D160C4; }.ansi-magenta-intense-fg { color: #A03196; }.ansi-magenta-intense-bg { background-color: #A03196; }.ansi-cyan-fg { color: #60C6C8; }.ansi-cyan-bg { background-color: #60C6C8; }.ansi-cyan-intense-fg { color: #258F8F; }.ansi-cyan-intense-bg { background-color: #258F8F; }.ansi-white-fg { color: #C5C1B4; }.ansi-white-bg { background-color: #C5C1B4; }.ansi-white-intense-fg { color: #A1A6B2; }.ansi-white-intense-bg { background-color: #A1A6B2; }.ansi-bold { font-weight: bold; }    </style><style type='text/css'>/* Overrides of notebook CSS for static HTML export */body {  overflow: visible;  padding: 8px;}div#notebook {  overflow: visible;  border-top: none;}@media print {  div.cell {    display: block;    page-break-inside: avoid;  }   div.output_wrapper {     display: block;    page-break-inside: avoid;   }  div.output {     display: block;    page-break-inside: avoid;   }}</style><!-- Custom stylesheet, it must be in the same directory as the html file --><link rel='stylesheet' href='custom.css'><!-- Loading mathjax macro --><!-- Load mathjax -->    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML'></script>    <!-- MathJax configuration -->    <script type='text/x-mathjax-config'>    MathJax.Hub.Config({        tex2jax: {            inlineMath: [ ['$','$'], ['\\(','\\)'] ],            displayMath: [ ['$$','$$'], ['\\[','\\]'] ],            processEscapes: true,            processEnvironments: true        },        // Center justify equations in code and markdown cells. Elsewhere        // we use CSS to left justify single line equations in code cells.        displayAlign: 'center',        'HTML-CSS': {            styles: {'.MathJax_Display': {'margin': 0}},            linebreaks: { automatic: true }        }    });    </script>    <!-- End of mathjax configuration --><!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body>  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div tabindex='-1' id='notebook' class='border-box-sizing'>    <div class='container' id='notebook-container'><div class='cell border-box-sizing code_cell rendered'><div class='input'><div class='prompt input_prompt'>In&nbsp;[1]:</div><div class='inner_cell'>    <div class='input_area'><div class=' highlight hl-ipython3'><pre><span></span><span class='kn'>import</span> <span class='nn'>numpy</span> <span class='k'>as</span> <span class='nn'>np</span><span class='c1'># 对应状态集合Q</span><span class='n'>states</span> <span class='o'>=</span> <span class='p'>(</span><span class='s1'>&#39;Box1&#39;</span><span class='p'>,</span> <span class='s1'>&#39;Box2&#39;</span><span class='p'>,</span> <span class='s1'>&#39;Box3&#39;</span><span class='p'>)</span><span class='c1'># 对应观测集合V</span><span class='n'>observations</span> <span class='o'>=</span> <span class='p'>(</span><span class='s1'>&#39;red&#39;</span><span class='p'>,</span> <span class='s1'>&#39;white&#39;</span><span class='p'>)</span><span class='c1'># 初始状态概率向量π</span><span class='n'>start_probability</span> <span class='o'>=</span> <span class='p'>{</span><span class='s1'>&#39;Box1&#39;</span><span class='p'>:</span> <span class='mf'>0.2</span><span class='p'>,</span> <span class='s1'>&#39;Box2&#39;</span><span class='p'>:</span> <span class='mf'>0.4</span><span class='p'>,</span><span class='s1'>&#39;Box3&#39;</span><span class='p'>:</span><span class='mf'>0.4</span><span class='p'>}</span><span class='c1'># 状态转移矩阵A</span><span class='n'>transition_probability</span> <span class='o'>=</span> <span class='p'>{</span>    <span class='s1'>&#39;Box1&#39;</span><span class='p'>:</span> <span class='p'>{</span><span class='s1'>&#39;Box1&#39;</span><span class='p'>:</span> <span class='mf'>0.5</span><span class='p'>,</span> <span class='s1'>&#39;Box2&#39;</span><span class='p'>:</span> <span class='mf'>0.2</span><span class='p'>,</span><span class='s1'>&#39;Box3&#39;</span><span class='p'>:</span><span class='mf'>0.3</span><span class='p'>},</span>    <span class='s1'>&#39;Box2&#39;</span><span class='p'>:</span> <span class='p'>{</span><span class='s1'>&#39;Box1&#39;</span><span class='p'>:</span> <span class='mf'>0.3</span><span class='p'>,</span> <span class='s1'>&#39;Box2&#39;</span><span class='p'>:</span> <span class='mf'>0.5</span><span class='p'>,</span><span class='s1'>&#39;Box3&#39;</span><span class='p'>:</span><span class='mf'>0.2</span><span class='p'>},</span>    <span class='s1'>&#39;Box3&#39;</span><span class='p'>:</span> <span class='p'>{</span><span class='s1'>&#39;Box1&#39;</span><span class='p'>:</span> <span class='mf'>0.2</span><span class='p'>,</span> <span class='s1'>&#39;Box2&#39;</span><span class='p'>:</span> <span class='mf'>0.3</span><span class='p'>,</span><span class='s1'>&#39;Box3&#39;</span><span class='p'>:</span><span class='mf'>0.5</span><span class='p'>},</span><span class='p'>}</span><span class='c1'># 观测概率矩阵B</span><span class='n'>emission_probability</span> <span class='o'>=</span> <span class='p'>{</span>    <span class='s1'>&#39;Box1&#39;</span><span class='p'>:</span> <span class='p'>{</span><span class='s1'>&#39;red&#39;</span><span class='p'>:</span> <span class='mf'>0.5</span><span class='p'>,</span> <span class='s1'>&#39;white&#39;</span><span class='p'>:</span> <span class='mf'>0.5</span><span class='p'>},</span>    <span class='s1'>&#39;Box2&#39;</span><span class='p'>:</span> <span class='p'>{</span><span class='s1'>&#39;red&#39;</span><span class='p'>:</span> <span class='mf'>0.4</span><span class='p'>,</span> <span class='s1'>&#39;white&#39;</span><span class='p'>:</span> <span class='mf'>0.6</span><span class='p'>},</span>    <span class='s1'>&#39;Box3&#39;</span><span class='p'>:</span> <span class='p'>{</span><span class='s1'>&#39;red&#39;</span><span class='p'>:</span> <span class='mf'>0.7</span><span class='p'>,</span> <span class='s1'>&#39;white&#39;</span><span class='p'>:</span> <span class='mf'>0.3</span><span class='p'>},</span><span class='p'>}</span></pre></div>    </div></div></div></div><div class='cell border-box-sizing code_cell rendered'><div class='input'><div class='prompt input_prompt'>In&nbsp;[2]:</div><div class='inner_cell'>    <div class='input_area'><div class=' highlight hl-ipython3'><pre><span></span><span class='c1'># 随机生成观测序列和状态序列    </span><span class='k'>def</span> <span class='nf'>simulate</span><span class='p'>(</span><span class='n'>T</span><span class='p'>):</span>    <span class='k'>def</span> <span class='nf'>draw_from</span><span class='p'>(</span><span class='n'>probs</span><span class='p'>):</span>        <span class='sd'>&quot;&quot;&quot;</span><span class='sd'>        1.np.random.multinomial:</span><span class='sd'>        按照多项式分布，生成数据</span><span class='sd'>        &gt;&gt;&gt; np.random.multinomial(20, [1/6.]*6, size=2)</span><span class='sd'>                array([[3, 4, 3, 3, 4, 3],</span><span class='sd'>                       [2, 4, 3, 4, 0, 7]])</span><span class='sd'>         For the first run, we threw 3 times 1, 4 times 2, etc.  </span><span class='sd'>         For the second, we threw 2 times 1, 4 times 2, etc.</span><span class='sd'>        2.np.where:</span><span class='sd'>        &gt;&gt;&gt; x = np.arange(9.).reshape(3, 3)</span><span class='sd'>        &gt;&gt;&gt; np.where( x &gt; 5 )</span><span class='sd'>        (array([2, 2, 2]), array([0, 1, 2]))</span><span class='sd'>        &quot;&quot;&quot;</span>        <span class='k'>return</span> <span class='n'>np</span><span class='o'>.</span><span class='n'>where</span><span class='p'>(</span><span class='n'>np</span><span class='o'>.</span><span class='n'>random</span><span class='o'>.</span><span class='n'>multinomial</span><span class='p'>(</span><span class='mi'>1</span><span class='p'>,</span><span class='n'>probs</span><span class='p'>)</span> <span class='o'>==</span> <span class='mi'>1</span><span class='p'>)[</span><span class='mi'>0</span><span class='p'>][</span><span class='mi'>0</span><span class='p'>]</span>    <span class='n'>observations</span> <span class='o'>=</span> <span class='n'>np</span><span class='o'>.</span><span class='n'>zeros</span><span class='p'>(</span><span class='n'>T</span><span class='p'>,</span> <span class='n'>dtype</span><span class='o'>=</span><span class='nb'>int</span><span class='p'>)</span>    <span class='n'>states</span> <span class='o'>=</span> <span class='n'>np</span><span class='o'>.</span><span class='n'>zeros</span><span class='p'>(</span><span class='n'>T</span><span class='p'>,</span> <span class='n'>dtype</span><span class='o'>=</span><span class='nb'>int</span><span class='p'>)</span>    <span class='n'>states</span><span class='p'>[</span><span class='mi'>0</span><span class='p'>]</span> <span class='o'>=</span> <span class='n'>draw_from</span><span class='p'>(</span><span class='n'>pi</span><span class='p'>)</span>    <span class='n'>observations</span><span class='p'>[</span><span class='mi'>0</span><span class='p'>]</span> <span class='o'>=</span> <span class='n'>draw_from</span><span class='p'>(</span><span class='n'>B</span><span class='p'>[</span><span class='n'>states</span><span class='p'>[</span><span class='mi'>0</span><span class='p'>],:])</span>    <span class='k'>for</span> <span class='n'>t</span> <span class='ow'>in</span> <span class='nb'>range</span><span class='p'>(</span><span class='mi'>1</span><span class='p'>,</span> <span class='n'>T</span><span class='p'>):</span>        <span class='n'>states</span><span class='p'>[</span><span class='n'>t</span><span class='p'>]</span> <span class='o'>=</span> <span class='n'>draw_from</span><span class='p'>(</span><span class='n'>A</span><span class='p'>[</span><span class='n'>states</span><span class='p'>[</span><span class='n'>t</span><span class='o'>-</span><span class='mi'>1</span><span class='p'>],:])</span>        <span class='n'>observations</span><span class='p'>[</span><span class='n'>t</span><span class='p'>]</span> <span class='o'>=</span> <span class='n'>draw_from</span><span class='p'>(</span><span class='n'>B</span><span class='p'>[</span><span class='n'>states</span><span class='p'>[</span><span class='n'>t</span><span class='p'>],:])</span>    <span class='k'>return</span> <span class='n'>observations</span><span class='p'>,</span> <span class='n'>states</span></pre></div>    </div></div></div></div><div class='cell border-box-sizing code_cell rendered'><div class='input'><div class='prompt input_prompt'>In&nbsp;[3]:</div><div class='inner_cell'>    <div class='input_area'><div class=' highlight hl-ipython3'><pre><span></span><span class='k'>def</span> <span class='nf'>generate_index_map</span><span class='p'>(</span><span class='n'>lables</span><span class='p'>):</span>    <span class='n'>id2label</span> <span class='o'>=</span> <span class='p'>{}</span>    <span class='n'>label2id</span> <span class='o'>=</span> <span class='p'>{}</span>    <span class='n'>i</span> <span class='o'>=</span> <span class='mi'>0</span>    <span class='k'>for</span> <span class='n'>l</span> <span class='ow'>in</span> <span class='n'>lables</span><span class='p'>:</span>        <span class='n'>id2label</span><span class='p'>[</span><span class='n'>i</span><span class='p'>]</span> <span class='o'>=</span> <span class='n'>l</span>        <span class='n'>label2id</span><span class='p'>[</span><span class='n'>l</span><span class='p'>]</span> <span class='o'>=</span> <span class='n'>i</span>        <span class='n'>i</span> <span class='o'>+=</span> <span class='mi'>1</span>    <span class='k'>return</span> <span class='n'>id2label</span><span class='p'>,</span> <span class='n'>label2id</span> <span class='n'>states_id2label</span><span class='p'>,</span> <span class='n'>states_label2id</span> <span class='o'>=</span> <span class='n'>generate_index_map</span><span class='p'>(</span><span class='n'>states</span><span class='p'>)</span><span class='n'>observations_id2label</span><span class='p'>,</span> <span class='n'>observations_label2id</span> <span class='o'>=</span> <span class='n'>generate_index_map</span><span class='p'>(</span><span class='n'>observations</span><span class='p'>)</span><span class='nb'>print</span><span class='p'>(</span><span class='n'>states_id2label</span><span class='p'>,</span> <span class='n'>states_label2id</span><span class='p'>)</span><span class='nb'>print</span><span class='p'>(</span><span class='n'>observations_id2label</span><span class='p'>,</span> <span class='n'>observations_label2id</span><span class='p'>)</span></pre></div>    </div></div></div><div class='output_wrapper'><div class='output'><div class='output_area'>    <div class='prompt'></div><div class='output_subarea output_stream output_stdout output_text'><pre>{0: &#39;Box1&#39;, 1: &#39;Box2&#39;, 2: &#39;Box3&#39;} {&#39;Box1&#39;: 0, &#39;Box2&#39;: 1, &#39;Box3&#39;: 2}{0: &#39;red&#39;, 1: &#39;white&#39;} {&#39;red&#39;: 0, &#39;white&#39;: 1}</pre></div></div></div></div></div><div class='cell border-box-sizing code_cell rendered'><div class='input'><div class='prompt input_prompt'>In&nbsp;[4]:</div><div class='inner_cell'>    <div class='input_area'><div class=' highlight hl-ipython3'><pre><span></span><span class='k'>def</span> <span class='nf'>convert_map_to_vector</span><span class='p'>(</span><span class='n'>map_</span><span class='p'>,</span> <span class='n'>label2id</span><span class='p'>):</span>    <span class='sd'>&quot;&quot;&quot;将概率向量从dict转换成一维array&quot;&quot;&quot;</span>    <span class='n'>v</span> <span class='o'>=</span> <span class='n'>np</span><span class='o'>.</span><span class='n'>zeros</span><span class='p'>(</span><span class='nb'>len</span><span class='p'>(</span><span class='n'>map_</span><span class='p'>),</span> <span class='n'>dtype</span><span class='o'>=</span><span class='nb'>float</span><span class='p'>)</span>    <span class='k'>for</span> <span class='n'>e</span> <span class='ow'>in</span> <span class='n'>map_</span><span class='p'>:</span>        <span class='n'>v</span><span class='p'>[</span><span class='n'>label2id</span><span class='p'>[</span><span class='n'>e</span><span class='p'>]]</span> <span class='o'>=</span> <span class='n'>map_</span><span class='p'>[</span><span class='n'>e</span><span class='p'>]</span>    <span class='k'>return</span> <span class='n'>v</span> <span class='k'>def</span> <span class='nf'>convert_map_to_matrix</span><span class='p'>(</span><span class='n'>map_</span><span class='p'>,</span> <span class='n'>label2id1</span><span class='p'>,</span> <span class='n'>label2id2</span><span class='p'>):</span>    <span class='sd'>&quot;&quot;&quot;将概率转移矩阵从dict转换成矩阵&quot;&quot;&quot;</span>    <span class='n'>m</span> <span class='o'>=</span> <span class='n'>np</span><span class='o'>.</span><span class='n'>zeros</span><span class='p'>((</span><span class='nb'>len</span><span class='p'>(</span><span class='n'>label2id1</span><span class='p'>),</span> <span class='nb'>len</span><span class='p'>(</span><span class='n'>label2id2</span><span class='p'>)),</span> <span class='n'>dtype</span><span class='o'>=</span><span class='nb'>float</span><span class='p'>)</span>    <span class='k'>for</span> <span class='n'>line</span> <span class='ow'>in</span> <span class='n'>map_</span><span class='p'>:</span>        <span class='k'>for</span> <span class='n'>col</span> <span class='ow'>in</span> <span class='n'>map_</span><span class='p'>[</span><span class='n'>line</span><span class='p'>]:</span>            <span class='n'>m</span><span class='p'>[</span><span class='n'>label2id1</span><span class='p'>[</span><span class='n'>line</span><span class='p'>]][</span><span class='n'>label2id2</span><span class='p'>[</span><span class='n'>col</span><span class='p'>]]</span> <span class='o'>=</span> <span class='n'>map_</span><span class='p'>[</span><span class='n'>line</span><span class='p'>][</span><span class='n'>col</span><span class='p'>]</span>    <span class='k'>return</span> <span class='n'>m</span></pre></div>    </div></div></div></div><div class='cell border-box-sizing code_cell rendered'><div class='input'><div class='prompt input_prompt'>In&nbsp;[5]:</div><div class='inner_cell'>    <div class='input_area'><div class=' highlight hl-ipython3'><pre><span></span><span class='n'>A</span> <span class='o'>=</span> <span class='n'>convert_map_to_matrix</span><span class='p'>(</span><span class='n'>transition_probability</span><span class='p'>,</span> <span class='n'>states_label2id</span><span class='p'>,</span> <span class='n'>states_label2id</span><span class='p'>)</span><span class='nb'>print</span><span class='p'>(</span><span class='s2'>&quot;状态转移概率矩阵：</span><span class='se'>\n</span><span class='s2'>&quot;</span><span class='p'>,</span><span class='n'>A</span><span class='p'>)</span><span class='n'>B</span> <span class='o'>=</span> <span class='n'>convert_map_to_matrix</span><span class='p'>(</span><span class='n'>emission_probability</span><span class='p'>,</span> <span class='n'>states_label2id</span><span class='p'>,</span> <span class='n'>observations_label2id</span><span class='p'>)</span><span class='nb'>print</span><span class='p'>(</span><span class='s2'>&quot;观测概率矩阵</span><span class='se'>\n</span><span class='s2'>&quot;</span><span class='p'>,</span><span class='n'>B</span><span class='p'>)</span><span class='n'>observations_index</span> <span class='o'>=</span> <span class='p'>[</span><span class='n'>observations_label2id</span><span class='p'>[</span><span class='n'>o</span><span class='p'>]</span> <span class='k'>for</span> <span class='n'>o</span> <span class='ow'>in</span> <span class='n'>observations</span><span class='p'>]</span><span class='n'>pi</span> <span class='o'>=</span> <span class='n'>convert_map_to_vector</span><span class='p'>(</span><span class='n'>start_probability</span><span class='p'>,</span> <span class='n'>states_label2id</span><span class='p'>)</span><span class='nb'>print</span><span class='p'>(</span><span class='s2'>&quot;初始状态概率向量</span><span class='se'>\n</span><span class='s2'>&quot;</span><span class='p'>,</span><span class='n'>pi</span><span class='p'>)</span></pre></div>    </div></div></div><div class='output_wrapper'><div class='output'><div class='output_area'>    <div class='prompt'></div><div class='output_subarea output_stream output_stdout output_text'><pre>状态转移概率矩阵： [[0.5 0.2 0.3] [0.3 0.5 0.2] [0.2 0.3 0.5]]观测概率矩阵 [[0.5 0.5] [0.4 0.6] [0.7 0.3]]初始状态概率向量 [0.2 0.4 0.4]</pre></div></div></div></div></div><div class='cell border-box-sizing code_cell rendered'><div class='input'><div class='prompt input_prompt'>In&nbsp;[6]:</div><div class='inner_cell'>    <div class='input_area'><div class=' highlight hl-ipython3'><pre><span></span><span class='c1'># 生成模拟数据</span><span class='n'>observations_data</span><span class='p'>,</span> <span class='n'>states_data</span> <span class='o'>=</span> <span class='n'>simulate</span><span class='p'>(</span><span class='mi'>10</span><span class='p'>)</span><span class='nb'>print</span><span class='p'>(</span><span class='n'>states_data</span><span class='p'>)</span><span class='nb'>print</span><span class='p'>(</span><span class='n'>observations_data</span><span class='p'>)</span><span class='c1'># 相应的label</span><span class='nb'>print</span><span class='p'>(</span><span class='s2'>&quot;盒子的状态: &quot;</span><span class='p'>,</span> <span class='p'>[</span><span class='n'>states_id2label</span><span class='p'>[</span><span class='n'>index</span><span class='p'>]</span> <span class='k'>for</span> <span class='n'>index</span> <span class='ow'>in</span> <span class='n'>states_data</span><span class='p'>])</span><span class='nb'>print</span><span class='p'>(</span><span class='s2'>&quot;得到的观测: &quot;</span><span class='p'>,</span> <span class='p'>[</span><span class='n'>observations_id2label</span><span class='p'>[</span><span class='n'>index</span><span class='p'>]</span> <span class='k'>for</span> <span class='n'>index</span> <span class='ow'>in</span> <span class='n'>observations_data</span><span class='p'>])</span></pre></div>    </div></div></div><div class='output_wrapper'><div class='output'><div class='output_area'>    <div class='prompt'></div><div class='output_subarea output_stream output_stdout output_text'><pre>[0 2 2 1 1 1 1 0 0 0][1 0 0 1 0 1 1 0 0 0]盒子的状态:  [&#39;Box1&#39;, &#39;Box3&#39;, &#39;Box3&#39;, &#39;Box2&#39;, &#39;Box2&#39;, &#39;Box2&#39;, &#39;Box2&#39;, &#39;Box1&#39;, &#39;Box1&#39;, &#39;Box1&#39;]得到的观测:  [&#39;white&#39;, &#39;red&#39;, &#39;red&#39;, &#39;white&#39;, &#39;red&#39;, &#39;white&#39;, &#39;white&#39;, &#39;red&#39;, &#39;red&#39;, &#39;red&#39;]</pre></div></div></div></div></div>    </div>  </div><!-- hexo-inject:begin --><!-- hexo-inject:end --></body> </html>" style="scrolling:no;"></iframe><script>$("#ipynb").load( function() {console.log($("#ipynb").contents().find("body").find("#notebook"));document.getElementById('ipynb').height=$("#ipynb").contents().find("#notebook").height()+100;})</script>     <h2 id="hmm模型的三个基本问题">HMM模型的三个基本问题</h2><p>HMM在实际应用中，一般会遇上三种问题：</p><ol type="1"><li><strong>概率计算问题</strong>：给定模型<span class="math inline">\(\lambda = (A,B,\pi)\)</span> 和观测序列<span class="math inline">\(O={o_1,o_2,...,o_T}\)</span>，计算在模型<span class="math inline">\(\lambda\)</span>下观测序列<span class="math inline">\(O\)</span>出现的概率<span class="math inline">\(P(O|\lambda)\)</span></li><li><strong>学习问题</strong>：已知观测序列<span class="math inline">\(O={o_1,o_2,\cdots,o_T}\)</span>，估计模型<span class="math inline">\(\lambda= (A,B,\pi)\)</span>，使得<span class="math inline">\(P(O|\lambda)\)</span>最大。即是用最大似然法的方法估计参数。</li><li><strong>预测问题</strong>：（亦称为 decoding 解码问题）已知观测序列<span class="math inline">\(O={o_1,o_2,...,o_T}\)</span>和模型<span class="math inline">\(\lambda = (A,B,\pi)\)</span>，求给定的观测序列条件概率<span class="math inline">\(P(I|O)\)</span>最大的状态序列<span class="math inline">\(I = (i_1,i_2,\cdots,i_T)\)</span>，即是给定观测序列，求最有可能的状态序列。</li></ol><p>回到上面的例子，这三个问题就是：</p><ol type="1"><li><strong>概率计算问题</strong>：如果给定模型参数，抽球结果某一系列观测的序列状态出现的概率</li><li><strong>学习问题</strong>：根据抽球结果某一些列观测的状态，学习模型参数。</li><li><strong>预测问题</strong>：根据学到的模型，预测抽球的序列。</li></ol><h3 id="前向后向算法评估观察序列概率">前向后向算法评估观察序列概率</h3><p>首先要解决的问题是上面的问题一，即是概率计算问题，在模型<span class="math inline">\(\lambda\)</span>下观测序列<span class="math inline">\(O\)</span>出现的概率<span class="math inline">\(P(O|\lambda)\)</span>。</p><h4 id="直接计算法">直接计算法</h4><p>因为我们知道所有的隐藏状态之间的转移概率和所有从隐藏状态到观测状态生成概率，那么我们是可以暴力求解的。 我们可以列举出所有可能出现的长度为T的隐藏序列<span class="math inline">\(I = (i_1,i_2,\cdots,i_T)\)</span>，分布求出这些隐藏序列与观测序列<span class="math inline">\(O={o_1,o_2,...,o_T}\)</span>的联合概率分布<span class="math inline">\(P(O,I|\lambda)\)</span>，这样我们就可以求出边缘分布<span class="math inline">\(P(O|\lambda)\)</span></p><p>算法步骤如下：</p><ol type="1"><li>任意一个隐藏序列<span class="math inline">\(I = (i_1,i_2,\cdots,i_T)\)</span>出现的概率是: <span class="math display">\[P(I|\lambda) = \pi_{i_1} a_{i_1i_2} a_{i_2i_3}... a_{i_{T-1}\;\;i_T}\]</span></li><li>对上面这种状态序列，产生观测序列<span class="math inline">\(O={o_1,o_2,...,o_T}\)</span>的概率是： <span class="math display">\[P(O|I,\lambda)=b_{i_1}(o_1)b_{i_2}(o_2)...b_{i_T}(o_{T})\]</span></li><li>则O和I联合出现的概率是： <span class="math display">\[P(O,I|\lambda)=P(O|I,\lambda)P(I|\lambda)=\pi_{i_1}b_{i_1}(o_1)a_{i_1i_2}b_{i_2}(o_2)...a_{i_{T-1}i_T}b_{i_T}(o_{T})\]</span></li><li>对所有可能的<span class="math inline">\(I\)</span>求和，得到: <span class="math display">\[P(O|λ)=\sum_IP(O,I|\lambda)=\sum_{i_1,...,i_T}\pi_{i_1}b_{i_1}(o_1)a_{i_1i_2}b_{i_2}(o_2)...a_{i_{T-1}i_T}b_{i_T}(o_{T})\]</span> 如果直接计算，时间复杂度太高，是<span class="math inline">\(O(TN^T)\)</span></li></ol><p>因此对于一些隐藏状态数极少的模型，我们可以用暴力求解法来得到观测序列出现的概率，但是如果隐藏状态多，则上述算法太耗时，我们需要寻找其他简洁的算法。</p><p>前向后向算法就是来帮助我们在较低的时间复杂度情况下求解这个问题的。 #### 前向算法（或者后向算法） 前向算法本质上属于动态规划的算法，也就是我们要通过找到局部状态递推的公式，这样一步步的从子问题的最优解拓展到整个问题的最优解。</p><p>在前向算法中，通过定义“前向概率”来定义动态规划的这个局部状态。</p><p><strong>前向概率：</strong>定义时刻<span class="math inline">\(t\)</span>时隐藏状态为<span class="math inline">\(q_i\)</span>, 观测状态的序列为<span class="math inline">\(o_1,o_2,\cdots,o_t\)</span>的概率为前向概率，记做： <span class="math display">\[\alpha_t(i) = P(o_1,o_2,...o_t, i_t =q_i | \lambda)\]</span></p><p>利用的思想是动态规划中的递推：</p><p>即是利用在时刻<span class="math inline">\(t\)</span>掌握的前向概率信息推出<span class="math inline">\(t+1\)</span>时刻各个隐藏状态的前向概率。具体步骤如下： <img src="https://suool-bolg.b0.upaiyun.com/2018/12/16/423B35A6-5DE4-432E-A68D-CD4FB933C0C9.png" alt="前向算法递推步骤"> 算法步骤如下：</p><p><strong>输入</strong>：隐马模型<span class="math inline">\(\lambda = (A, B, \Pi)\)</span>，观测序列<span class="math inline">\(O=(o_1,o_2,...o_T)\)</span>; <strong>输出</strong>：观测序列概率<span class="math inline">\(P(O|λ)\)</span>.</p><p><strong>step 1：</strong> 计算<span class="math inline">\(t=1\)</span>时刻的各个隐藏状态初始前向概率： <span class="math display">\[\alpha_1(i) = \pi_ib_i(o_1),\; i=1,2,...N\]</span> <strong>step 2：</strong>递推时刻<span class="math inline">\(2,3,\cdots,T\)</span>时刻的前向概率： <span class="math display">\[\alpha_{t+1}(i) = \Big[\sum\limits_{j=1}^N\alpha_t(j)a_{ji}\Big]b_i(o_{t+1}),\; i=1,2,...N\]</span> <strong>step 3：</strong>计算最终结果： <span class="math display">\[P(O|\lambda) = \sum\limits_{i=1}^N\alpha_T(i)\]</span></p><p>从递推公式可以看出，我们的算法时间复杂度是<span class="math inline">\(O(TN^2)\)</span></p><p>后向算法原理亦是如此。</p><p>实现代码如下:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 接上面代码</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(obs_seq)</span>:</span></span><br><span class="line">    <span class="string">"""前向算法"""</span></span><br><span class="line">    N = A.shape[<span class="number">0</span>]</span><br><span class="line">    T = len(obs_seq)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># F保存前向概率矩阵</span></span><br><span class="line">    F = np.zeros((N,T))</span><br><span class="line">    F[:,<span class="number">0</span>] = pi * B[:, obs_seq[<span class="number">0</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> range(<span class="number">1</span>, T):</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> range(N):</span><br><span class="line">            F[n,t] = np.dot(F[:,t<span class="number">-1</span>], (A[:,n])) * B[n, obs_seq[t]]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> F, sum(F[:,T<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backward</span><span class="params">(obs_seq)</span>:</span></span><br><span class="line">    <span class="string">"""后向算法"""</span></span><br><span class="line">    N = A.shape[<span class="number">0</span>]</span><br><span class="line">    T = len(obs_seq)</span><br><span class="line">    <span class="comment"># X保存后向概率矩阵</span></span><br><span class="line">    X = np.zeros((N,T))</span><br><span class="line">    X[:,<span class="number">-1</span>:] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> reversed(range(T<span class="number">-1</span>)):</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> range(N):</span><br><span class="line">            X[n,t] = np.sum(X[:,t+<span class="number">1</span>] * A[n,:] * B[:, obs_seq[t+<span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> X, sum(pi*B[:,<span class="number">0</span>]*X[:,<span class="number">0</span>])</span><br></pre></td></tr></table></figure><p>结果如下： <img src="https://suool-bolg.b0.upaiyun.com/2018/12/16/238936F0-D7CC-4527-9C36-B7AA0B9D25FB.png" alt="结果"></p><h3 id="鲍姆-韦尔奇算法求解hmm参数">鲍姆-韦尔奇算法求解HMM参数</h3><p>HMM模型参数求解根据已知的条件可以分为两种情况。 第一种情况较为简单，就是我们已知<span class="math inline">\(D\)</span>个长度为<span class="math inline">\(T\)</span>的观测序列和对应的隐藏状态序列，<span class="math inline">\(\{(O_1, I_1), (O_2, I_2), ...(O_D, I_D)\}\)</span>是已知的，此时我们可以很容易的用最大似然来求解模型参数。 <img src="media/76C08584-F650-4B94-90DC-0C18D99EC5B0.png" alt="求解步骤"></p><p>可见第一种情况下求解模型还是很简单的。但是在很多时候，我们无法得到HMM样本观察序列对应的隐藏序列，只有D个长度为T的观测序列，即是<span class="math inline">\(\{(O_1), (O_2), ...(O_D)\}\)</span>是已知的，此时我们能不能求出合适的HMM模型参数呢？这就是我们的第二种情况，它的解法最常用的是鲍姆-韦尔奇算法，其实就是基于EM算法的求解。</p><h3 id="维特比算法解码隐藏状态序列">维特比算法解码隐藏状态序列</h3><h2 id="分词实战">分词实战</h2>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;p&gt;同时在&lt;a href=&quot;https://suool.net/2018/11/16/Text-Segmentation-1/&quot;&gt;LP 之分词技术概述&lt;/a&gt;中有提到 HMM 模型，虽然此方法在现代的作用和地位有所下降，但是依然是非常值得了解的学习机器学习经典算法。
    
    </summary>
    
      <category term="机器学习" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="NLP" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/NLP/"/>
    
    
      <category term="NLP" scheme="https://suool.net/tags/NLP/"/>
    
  </entry>
  
  <entry>
    <title>Gibbs采样</title>
    <link href="https://suool.net/2018/11/17/Markov-Chain-Monte-Carlo-4/"/>
    <id>https://suool.net/2018/11/17/Markov-Chain-Monte-Carlo-4/</id>
    <published>2018-11-17T03:43:35.000Z</published>
    <updated>2018-11-22T14:23:59.395Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="前言">前言</h2><p>M-H采样已经可以很好的解决蒙特卡罗方法需要的任意概率分布的样本集的问题。但是M-H采样有两个缺点：一是需要计算接受率，在高维时计算量大。并且由于接受率的原因导致算法收敛时间变长。二是有些高维数据，特征的条件概率分布好求，但是特征的联合分布不好求。因此需要一个好的方法来改进M-H采样，这就是我们下面讲到的Gibbs采样。 <a id="more"></a></p><h3 id="重新寻找合适的细致平稳条件">重新寻找合适的细致平稳条件</h3><p>之前在 MCMC 采样及 M-H 采样的时候提到一个细致平稳条件,其表述如下:</p><p>如果非周期马尔科夫链的状态转移矩阵<span class="math inline">\(P\)</span>和概率分布<span class="math inline">\(π(x)\)</span>对于所有的<span class="math inline">\(i,j\)</span>满足： <span class="math display">\[\pi(i)P(i,j) = \pi(j)P(j,i)\]</span></p><p>则称概率分布<span class="math inline">\(π(x)\)</span>是状态转移矩阵<span class="math inline">\(P\)</span>的平稳分布。上式被称为细致平稳条件(<code>detailed balance condition</code>)。</p><p>现在我们换一个思路。</p><p>从二维的数据分布开始，假设<span class="math inline">\(π(x_1,x_2)\)</span>是一个二维联合数据分布，观察第一个特征维度相同的两个点A<span class="math inline">\(A(x_1^{(1)},x_2^{(1)})\)</span>和B<span class="math inline">\(A(x_1^{(1)},x_2^{(2)})\)</span>，容易发现下面两式成立：</p><p><span class="math display">\[\pi(x_1^{(1)},x_2^{(1)}) \pi(x_2^{(2)} | x_1^{(1)}) = \pi(x_1^{(1)})\pi(x_2^{(1)}|x_1^{(1)}) \pi(x_2^{(2)} | x_1^{(1)}) \\\pi(x_1^{(1)},x_2^{(2)}) \pi(x_2^{(1)} | x_1^{(1)}) = \pi(x_1^{(1)}) \pi(x_2^{(2)} | x_1^{(1)})\pi(x_2^{(1)}|x_1^{(1)})\]</span></p><p>由于两式的右边相等，因此我们有： <span class="math display">\[\pi(x_1^{(1)},x_2^{(1)}) \pi(x_2^{(2)} | x_1^{(1)})  = \pi(x_1^{(1)},x_2^{(2)}) \pi(x_2^{(1)} | x_1^{(1)})\]</span></p><p>也就是： <span class="math display">\[\pi(A) \pi(x_2^{(2)} | x_1^{(1)})  = \pi(B) \pi(x_2^{(1)} | x_1^{(1)})\]</span></p><p>观察上式再观察细致平稳条件的公式，我们发现在<span class="math inline">\(x_1=x^{(1)}_1\)</span>这条直线上，如果用条件概率分布<span class="math inline">\(π(x_2|x^{(1)}_1)\)</span>作为马尔科夫链的状态转移概率，则任意两个点之间的转移满足细致平稳条件！同样的道理，在<span class="math inline">\(x_2=x^{(1)}_2\)</span>这条直线上，如果用条件概率分布<span class="math inline">\(π(x_1|x^{(1)}_2)\)</span>作为马尔科夫链的状态转移概率，则任意两个点之间的转移也满足细致平稳条件。那是因为假如有一点C<span class="math inline">\((x^{(2)}_1,x^{(1)}_2)\)</span>,我们可以得到： <span class="math display">\[\pi(A) \pi(x_1^{(2)} | x_2^{(1)})  = \pi(C) \pi(x_1^{(1)} | x_2^{(1)})\]</span></p><p>基于上面的发现，我们可以这样构造分布<span class="math inline">\(π(x_1,x_2)\)</span>的马尔可夫链对应的状态转移矩阵P： <span class="math display">\[P(A \to B) = \pi(x_2^{(B)}|x_1^{(1)})\;\; if\; x_1^{(A)} = x_1^{(B)} =x_1^{(1)} \\P(A \to C) = \pi(x_1^{(C)}|x_2^{(1)})\;\; if\; x_2^{(A)} = x_2^{(C)} =x_2^{(1)} \\P(A \to D) = 0\;\; else\]</span></p><p>有了上面这个状态转移矩阵，我们很容易验证平面上的任意两点E,F，满足细致平稳条件：</p><p><span class="math display">\[\pi(E)P(E \to F)  = \pi(F)P(F \to E)\]</span></p><p>###二维Gibbs采样 利用上一节找到的状态转移矩阵，我们就得到了二维Gibbs采样，这个采样需要两个维度之间的条件概率。</p><p>###多维Gibbs采样</p><p>##Gibbs采样小结 由于Gibbs采样在高维特征时的优势，目前我们通常意义上的MCMC采样都是用的Gibbs采样。当然Gibbs采样是从M-H采样的基础上的进化而来的，同时Gibbs采样要求数据至少有两个维度，一维概率分布的采样是没法用Gibbs采样的,这时M-H采样仍然成立。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;p&gt;M-H采样已经可以很好的解决蒙特卡罗方法需要的任意概率分布的样本集的问题。但是M-H采样有两个缺点：一是需要计算接受率，在高维时计算量大。并且由于接受率的原因导致算法收敛时间变长。二是有些高维数据，特征的条件概率分布好求，但是特征的联合分布不好求。因此需要一个好的方法来改进M-H采样，这就是我们下面讲到的Gibbs采样。
    
    </summary>
    
      <category term="统计学" scheme="https://suool.net/categories/%E7%BB%9F%E8%AE%A1%E5%AD%A6/"/>
    
    
      <category term="算法" scheme="https://suool.net/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>MCMC采样及M-H采样</title>
    <link href="https://suool.net/2018/11/17/Markov-Chain-Monte-Carlo-3/"/>
    <id>https://suool.net/2018/11/17/Markov-Chain-Monte-Carlo-3/</id>
    <published>2018-11-17T02:12:15.000Z</published>
    <updated>2018-11-19T10:56:31.307Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="mcmc采样及m-h采样">MCMC采样及M-H采样</h1><h2 id="前言">前言</h2><p><a href="https://suool.net/2018/11/16/Markov-Chain-Monte-Carlo-2/">前面的文章</a>已经说到给定一个概率平稳分布π, 只要能够其马尔科夫链状态转移矩阵P，我们就可以找到一种通用的概率分布采样方法，进而用于蒙特卡罗模拟。现在就学习下解决这个问题的办法：MCMC采样和它的易用版M-H采样。</p><p>如何能做到这一点呢？我们主要使用如下的定理。 <a id="more"></a></p><h3 id="马尔科夫链的细致平稳条件">马尔科夫链的细致平稳条件</h3><p>细致平稳条件: 如果非周期马尔科夫链的状态转移矩阵<span class="math inline">\(P\)</span>和概率分布<span class="math inline">\(π(x)\)</span>对于所有的<span class="math inline">\(i,j\)</span>满足： <span class="math display">\[\pi(i)P(i,j) = \pi(j)P(j,i)\]</span></p><p>则称概率分布<span class="math inline">\(π(x)\)</span>是状态转移矩阵<span class="math inline">\(P\)</span>的平稳分布。上式被称为细致平稳条件(<code>detailed balance condition</code>)。</p><p>其实这个定理是显而易见的，因为细致平稳条件的物理含义就是对于任何两个状态<span class="math inline">\(i,j\)</span>, 从<span class="math inline">\(i\)</span>转移出去到<span class="math inline">\(j\)</span>而丢失的概率质量，恰好会被从<span class="math inline">\(j\)</span>转移回<span class="math inline">\(i\)</span>的概率质量补充回来，所以状态上的概率质量<span class="math inline">\(π(i\)</span>)是稳定的，从而<span class="math inline">\(π(x)\)</span>是马尔科夫链的平稳分布。</p><p>证明很简单,由细致平稳条件可知: <span class="math display">\[\sum\limits_{i=1}^{\infty}\pi(i)P(i,j)  = \sum\limits_{i=1}^{\infty} \pi(j)P(j,i) =  \pi(j)\sum\limits_{i=1}^{\infty} P(j,i) =  \pi(j)\]</span></p><p>将上式用矩阵表示即为： <span class="math display">\[\pi P = \pi\]</span></p><p>即满足马尔可夫链的收敛性质。也就是说，只要我们找到了可以使概率分布<span class="math inline">\(π(x)\)</span>满足细致平稳分布的矩阵<span class="math inline">\(P\)</span>即可。这给了我们寻找从平稳分布<span class="math inline">\(π\)</span>, 找到对应的马尔科夫链状态转移矩阵<span class="math inline">\(P\)</span>的新思路。</p><p>不过不幸的是，仅仅从细致平稳条件还是很难找到合适的矩阵P。比如我们的目标平稳分布是<span class="math inline">\(π(x)\)</span>,随机找一个马尔科夫链状态转移矩阵<span class="math inline">\(Q\)</span>,它是很难满足细致平稳条件的，即: <span class="math display">\[\pi(i)Q(i,j) \neq \pi(j)Q(j,i)\]</span></p><p>那么如何使这个等式满足呢？</p><h2 id="mcmc采样">MCMC采样</h2><p>由于一般情况下，目标平稳分布<span class="math inline">\(π(x)\)</span>和某一个马尔科夫链状态转移矩阵<span class="math inline">\(Q\)</span>不满足细致平稳条件，即: <span class="math display">\[\pi(i)Q(i,j) \neq \pi(j)Q(j,i)\]</span></p><p>我们可以对上式做一个改造，使细致平稳条件成立。方法是引入一个<span class="math inline">\(α(i,j)\)</span>,使上式可以取等号，即：</p><p><span class="math display">\[\pi(i)Q(i,j)\alpha(i,j) = \pi(j)Q(j,i)\alpha(j,i)\]</span></p><p>此时的问题转化为什么样的<span class="math inline">\(α(i,j)\)</span>可以使等式成立, 其实很简单，只要满足下两式即可： <span class="math display">\[\alpha(i,j) = \pi(j)Q(j,i) \\\alpha(j,i) = \pi(i)Q(i,j)\]</span></p><p>这样，我们就得到了我们的分布<span class="math inline">\(π(x)\)</span>对应的马尔科夫链状态转移矩阵<span class="math inline">\(P\)</span>，满足： <span class="math display">\[P(i,j) = Q(i,j)\alpha(i,j)\]</span></p><p>也就是说，我们的目标矩阵<span class="math inline">\(P\)</span>可以通过任意一个马尔科夫链状态转移矩阵<span class="math inline">\(Q\)</span>乘以<span class="math inline">\(α(i,j)\)</span>得到。<span class="math inline">\(α(i,j)\)</span>我们有一般称之为接受率。取值在[0,1]之间，可以理解为一个概率值。即目标矩阵<span class="math inline">\(P\)</span>可以通过任意一个马尔科夫链状态转移矩阵<span class="math inline">\(Q\)</span>以一定的接受率获得。这个很像我们在<a href="https://suool.net/2018/11/16/Markov-Chain-Monte-Carlo-1/">蒙特卡罗方法</a>讲到的接受-拒绝采样，那里是以一个常用分布通过一定的接受-拒绝概率得到一个非常见分布，这里是以一个常见的马尔科夫链状态转移矩阵<span class="math inline">\(Q\)</span>通过一定的接受-拒绝概率得到目标转移矩阵<span class="math inline">\(P\)</span>,两者的解决问题思路是类似的。</p><p><strong>MCMC的采样过程</strong>如下</p><ol type="1"><li>输入我们任意选定的马尔科夫链状态转移矩阵<span class="math inline">\(Q\)</span>，平稳分布<span class="math inline">\(π(x)\)</span>，设定状态转移次数阈值<span class="math inline">\(n_1\)</span>，需要的样本个数<span class="math inline">\(n_2\)</span></li><li>从任意简单概率分布采样得到初始状态值<span class="math inline">\(x_0\)</span></li><li><span class="math inline">\(for\; t=0 \; to \; n_1+n_2−1:\)</span><ol type="1"><li>从条件概率分布<span class="math inline">\(Q(x|x_t)\)</span>中采样得到样本<span class="math inline">\(x_∗\)</span></li><li>从均匀分布采样<span class="math inline">\(u∼uniform[0,1]\)</span></li><li>如果<span class="math inline">\(u &lt; \alpha(x_t,x_{*}) = \pi(x_{*})Q(x_{*},x_t)\)</span>, 则接受转移<span class="math inline">\(x_t \to x_{*}\)</span>，即<span class="math inline">\(x_{t+1}= x_{*}\)</span></li><li>否则不接受转移，<span class="math inline">\(t=max(t−1,0)\)</span></li></ol></li><li>样本集<span class="math inline">\((x_{n_1}, x_{n_1+1},..., x_{n_1+n_2-1})\)</span>即为我们需要的平稳分布对应的样本集。</li></ol><p>以上的MCMC采样算法已经能很漂亮的工作了，不过它有一个小的问题：马尔科夫链<span class="math inline">\(Q\)</span>在转移的过程中的接受率<span class="math inline">\(α(i,j)\)</span>可能偏小，这样采样过程中容易原地踏步，拒绝大量的跳转，使得马尔科夫链收敛到平稳分布<span class="math inline">\(p(x)\)</span>的速度太慢。有可能我们采样了上百万次马尔可夫链还没有收敛，也就是上面这个<span class="math inline">\(n_1\)</span>要非常非常的大，这让人难以接受，怎么办呢？</p><p>看下节.</p><h2 id="m-h采样">M-H采样</h2><p>M-H采样是Metropolis-Hastings采样的简称，这个算法首先由Metropolis提出，被Hastings改进，因此被称之为Metropolis-Hastings采样或M-H采样.</p><p>M-H采样解决了我们上一节MCMC采样接受率过低的问题。</p><p>假设<span class="math inline">\(α(i,j)=0.1,α(j,i)=0.2\)</span>此时满足细致平稳条件，于是: <span class="math display">\[p(i)q(i,j) \cdot 0.1=p(j)q(j,i) \cdot 0.2\]</span></p><p>上式两边同时扩大5倍，等式变为: <span class="math display">\[p(i)q(i,j) \cdot 0.5=p(j)q(j,i) \cdot 1\]</span></p><p>我们提高了接受率，而细致平稳条件并没有打破。这启发我们可以把细致平稳条件中<span class="math inline">\(α(i,j),α(j,i)\)</span>等比例放大，使得两数中较大的一个放大到1，如此提高了采样中的跳转接受率。 这样我们的接受率可以做如下改进，即： <span class="math display">\[\alpha(i,j) = min\{ \frac{\pi(j)Q(j,i)}{\pi(i)Q(i,j)},1\}\]</span></p><p>通过这个微小的改造，我们就得到了可以在实际应用中使用的M-H采样算法过程如下：</p><ol type="1"><li>输入我们任意选定的马尔科夫链状态转移矩阵<span class="math inline">\(Q\)</span>，平稳分布<span class="math inline">\(π(x)\)</span>，设定状态转移次数阈值<span class="math inline">\(n_1\)</span>，需要的样本个数<span class="math inline">\(n_2\)</span></li><li>从任意简单概率分布采样得到初始状态值<span class="math inline">\(x_0\)</span></li><li><span class="math inline">\(for\; t=0 \;to\; n_1+n_2−1:\)</span><ol type="1"><li>从条件概率分布<span class="math inline">\(Q(x|x_t)\)</span>中采样得到样本<span class="math inline">\(x_∗\)</span></li><li>从均匀分布采样<span class="math inline">\(u∼uniform[0,1]\)</span></li><li>如果<span class="math inline">\(u &lt; \alpha(x_t,x_{*}) = min\{ \frac{\pi(j)Q(j,i)}{\pi(i)Q(i,j)},1\}\)</span>, 则接受转移<span class="math inline">\(x_t \to x_{*}\)</span>，即<span class="math inline">\(x_{t+1}=x_∗\)</span></li><li>否则不接受转移，<span class="math inline">\(t=max(t-1,0)\)</span></li></ol></li><li>样本集<span class="math inline">\((x_{n_1}, x_{n_1+1},..., x_{n_1+n_2-1})\)</span>即为我们需要的平稳分布对应的样本集。</li></ol><p>很多时候，我们选择的马尔科夫链状态转移矩阵<span class="math inline">\(Q\)</span>如果是对称的，即满足<span class="math inline">\(Q(i,j)=Q(j,i)\)</span>,这时我们的接受率可以进一步简化为： <span class="math display">\[\alpha(i,j) = min\{ \frac{\pi(j)}{\pi(i)},1\}\]</span></p><h2 id="note注意点">Note注意点</h2><ul><li>具体的关于上述两个采样的方法的转移矩阵<span class="math inline">\(Q\)</span>的选择，如果是离散的分布，那么只要这个矩阵满足每行概率和为1即可，没有特殊要求。如果是连续分布，则一般会选择正态分布作为<span class="math inline">\(Q\)</span>，因为正态分布的联合分布，条件分布，边缘分布都是正态分布，所以后面计算条件概率比较的容易。对采样的好坏一般影响都不大，只能说不同的<span class="math inline">\(Q\)</span>对算法的收敛速度会快有慢，只要收敛了，最后的采样结果都是可以的。</li><li>这里<span class="math inline">\(α(i,j)\)</span>是某一个位置的<span class="math inline">\((i,j)\)</span>的接受率，所以α实际上也是一个矩阵，如果按矩阵的写法，就是:<span class="math inline">\(P=Qα^T\)</span>, 不要理解为所有的位置都乘以的是同一个α(i,j),这是不对的。</li></ul><h3 id="m-h采样实例">M-H采样实例</h3><p>我们的目标平稳分布是一个均值3，标准差2的正态分布，而选择的马尔可夫链状态转移矩阵<span class="math inline">\(Q(i,j)\)</span>的条件转移概率是以<span class="math inline">\(i\)</span>为均值,方差<span class="math inline">\(1\)</span>的正态分布在位置<span class="math inline">\(j\)</span>的值。这个例子仅仅用来加深对M-H采样过程的理解。毕竟一个普通的一维正态分布用不着去用M-H采样来获得样本。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> norm</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">norm_dist_prob</span><span class="params">(theta)</span>:</span></span><br><span class="line">    y = norm.pdf(theta, loc=<span class="number">3</span>, scale=<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">T = <span class="number">100000</span></span><br><span class="line">pi = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(T)]</span><br><span class="line">sigma = <span class="number">1</span></span><br><span class="line">t = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> t &lt; T<span class="number">-1</span>:</span><br><span class="line">    t = t + <span class="number">1</span></span><br><span class="line">    pi_star = norm.rvs(loc=pi[t - <span class="number">1</span>], scale=sigma, size=<span class="number">1</span>, random_state=<span class="keyword">None</span>)</span><br><span class="line">    alpha = min(<span class="number">1</span>, (norm_dist_prob(pi_star[<span class="number">0</span>]) / norm_dist_prob(pi[t - <span class="number">1</span>])))</span><br><span class="line"></span><br><span class="line">    u = random.uniform(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> u &lt; alpha:</span><br><span class="line">        pi[t] = pi_star[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pi[t] = pi[t - <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">plt.scatter(pi, norm.pdf(pi, loc=<span class="number">3</span>, scale=<span class="number">2</span>))</span><br><span class="line">num_bins = <span class="number">1000</span></span><br><span class="line">plt.hist(pi, num_bins, density=<span class="number">1</span>, facecolor=<span class="string">'red'</span>, alpha=<span class="number">0.7</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>结果如下： <img src="https://suool-bolg.b0.upaiyun.com/2018/11/19/977C93F7-DC2F-4E60-BC0F-820B055DF4C4.png" alt="采样结果"></p><h2 id="m-h采样总结">M-H采样总结</h2><p>M-H采样完整解决了使用蒙特卡罗方法需要的任意概率分布样本集的问题，因此在实际生产环境得到了广泛的应用。</p><p>但是在大数据时代，M-H采样面临着两大难题：</p><ol type="1"><li><p>我们的数据特征非常的多，M-H采样由于接受率计算式<span class="math inline">\(\frac{\pi(j)Q(j,i)}{\pi(i)Q(i,j)}\)</span>的存在，在高维时需要的计算时间非常的可观，算法效率很低。同时<span class="math inline">\(α(i,j)\)</span>一般小于1，有时候辛苦计算出来却被拒绝了。能不能做到不拒绝转移呢？</p></li><li><p>由于特征维度大，很多时候我们甚至很难求出目标的各特征维度联合分布，但是可以方便求出各个特征之间的条件概率分布。这时候我们能不能只有各维度之间条件概率分布的情况下方便的采样呢？</p></li></ol><p>Gibbs采样解决了上面两个问题，因此在大数据时代，MCMC采样基本是Gibbs采样的天下，下一篇我们就来学习Gibbs采样。</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;mcmc采样及m-h采样&quot;&gt;MCMC采样及M-H采样&lt;/h1&gt;
&lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://suool.net/2018/11/16/Markov-Chain-Monte-Carlo-2/&quot;&gt;前面的文章&lt;/a&gt;已经说到给定一个概率平稳分布π, 只要能够其马尔科夫链状态转移矩阵P，我们就可以找到一种通用的概率分布采样方法，进而用于蒙特卡罗模拟。现在就学习下解决这个问题的办法：MCMC采样和它的易用版M-H采样。&lt;/p&gt;
&lt;p&gt;如何能做到这一点呢？我们主要使用如下的定理。
    
    </summary>
    
      <category term="统计学" scheme="https://suool.net/categories/%E7%BB%9F%E8%AE%A1%E5%AD%A6/"/>
    
    
      <category term="算法" scheme="https://suool.net/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>NLP 之分词技术概述</title>
    <link href="https://suool.net/2018/11/16/Text-Segmentation-1/"/>
    <id>https://suool.net/2018/11/16/Text-Segmentation-1/</id>
    <published>2018-11-16T12:01:00.000Z</published>
    <updated>2018-11-24T10:31:55.837Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="前言">前言</h2><p>NLP 的问题领域中，首先的要解决核心问题就是分词。在英文以空格来作为天然的词语间隔的语言中，分词是非常容易的；但是在中文领域，词以汉字为单位组成，词语与词语之间并无天然的界限，句子或短语之间以标点符号作为间隔。这就导致在中文领域做 NLP 的前提是做好中文分词技术。 <a id="more"></a></p><h3 id="基于规则的分词">基于规则的分词</h3><p>中文分词技术是中文 NLP 领域一个非常基础而核心的问题。在此问题被提出来之后，主要有三种思路出现，分别是：基于规则的分词、基于统计的分词、混合方式分词（规则+统计）。</p><p>基于规则的分词是一种机械的分词方法，主要通过维护词典，在切分语句的时候，通过将语句中的每个字符串与词表中的词语逐一匹配，找到即切分，否则不切分。按照匹配切分的方法，主要有：正向最大匹配法（MM），逆向最大匹配法（RMM）以及双向最大匹配法（BM）。</p><p>基于规则的方式其优点和缺点都显而易见，当今的环境下，这种方式已不再是主流，不再细说。</p><p>###基于统计的分词</p><p>基于统计的分词其主要思想是把每个词看作是由词的最小单位的各个字组成的，如果相连的字在不同的文本中出现的次数越多，就说明这个相连的字很可能就是一个词。因此可以利用字与字相邻出现的频率来反映其组成词的可靠度，统计语料库中相邻共现的各个字的组合的频度，当这个频度高于某一个临界值的时候，便可以认为这个字的组合是一个词语。</p><p>基于统计的分词，基本操作有两个： 1. 建立语言模型 2. 对句子进行单词划分，然后对划分结果进行概率计算，获得概率最大的分词方式，这里面用到的统计算法主要有隐马尔科夫模型（HMM）、条件随机场（CRF）等。</p><h2 id="语言模型">语言模型</h2><p>语言模型主要有统计语言模型（n-gram语言模型）和神经网络语言模型等，这里主要详细说明统计语言模型。</p><h3 id="n-gram语言模型">n-gram语言模型</h3><p>统计语言模型简单来讲，就是计算一个句子的概率，更确切的说是计算组成这个句子一系列词语的概率。</p><p>比如给定一个已知词语序列的句子： <span class="math display">\[S = W_1,W_2,\cdots,W_n\]</span></p><p>一个好的语言模型应该会给这个句子比较高的概率。因为这个句子在语义语法上都没有任何问题。我们可以用如下的公式来计算概率： <span class="math display">\[\begin{align}P(S)&amp;=P(W_1,W_2,...,W_n) \\&amp;=P(W_1)P(W_2|W_1)\cdots P(W_n|W_1,W_2,...W_{n−1})\end{align}\]</span></p><p>可是这样的方法存在两个致命的缺陷：</p><ul><li><strong>參数空间过大</strong>：条件概率 <span class="math inline">\(P(W_n|W_1,W_2,...W_{n−1})\)</span> 的可能性太多，无法估算，不可能有用；</li><li><strong>数据稀疏严重</strong>：对于非常多词对的组合，在语料库中都没有出现，依据最大似然估计得到的概率将会是0。</li></ul><p>为了解决參数空间过大的问题。引入了<strong>马尔科夫假设：随意一个词出现的概率只与它前面出现的有限的一个或者几个词有关</strong>。</p><p>如果 n=1，即假设每个单词之间相互独立，那么就会得到 unigram 也就是一元语言模型： <strong>Unigram model</strong> <span class="math display">\[ P(W_1,W_2,W_3,...,W_n)=∏^n_{i=1}P(W_i)\]</span></p><p>如果 n=2 则为 bi-gram 模型表示，因为，下一个单词和之前一个单词是有很强的关联性 <strong>Bigram model</strong> <span class="math display">\[P(W_1,W_2,W_3,...,W_n)=∏^n_{i=2}P(W_i|W_{i−1})\]</span></p><p>假设一个词的出现仅依赖于它前面出现的两个词，即是 n=3，那么我们就称之为trigram： <strong>Trigram model</strong> <span class="math display">\[P(W_1,W_2,W_3,...,W_n)=∏^n_{i=3}P(W_i|W_{i−1},W_{i−2})\]</span></p><p>一般来说，N 元模型就是假设当前词的出现概率只与它前面的 N-1 个词有关。而这些概率参数都是可以通过大规模语料库来计算.</p><p>同时，n一般不会超过3, 否则参数空间过大，数据稀疏严重，时间复杂度高，精度却提高的不多。对于非常对多词对的组合，在语料库中没有出现，依据最大似然估计得到的概率将会是0。</p><p>当然，对于n-gram模型来说，有很多的平滑方法。即对频率为0的n元对进行估计，典型的平滑算法有加法平滑、Good-Turing平滑、Katz平滑、插值平滑，等等</p><h3 id="隐马尔科夫模型">隐马尔科夫模型</h3><p>隐马尔科夫模型（Hidden Markov Model，以下简称HMM）是比较经典的机器学习模型，它在语言识别，自然语言处理，模式识别等领域得到广泛的应用。当然，随着目前深度学习的崛起，尤其是RNN，LSTM等神经网络序列模型的火热，HMM的地位有所下降。</p><p>这部分内容会在后面专门说明,在 HMM 中也面临着计算复杂度过高等问题.</p><h2 id="结语">结语</h2><p>对于文本挖掘中需要的分词功能，一般我们会用现有的工具。简单的英文分词不需要任何工具，通过空格和标点符号就可以分词了，而进一步的英文分词推荐使用 <a href="http://www.nltk.org/" target="_blank" rel="noopener">nltk</a>。对于中文分词，则推荐用<a href="https://github.com/fxsjy/jieba/" target="_blank" rel="noopener">结巴分词</a>（jieba）。这些工具使用都很简单。你的分词没有特别的需求直接使用这些分词工具就可以了。</p><p>分词是传统中文 NLP 的第一步.</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;p&gt;NLP 的问题领域中，首先的要解决核心问题就是分词。在英文以空格来作为天然的词语间隔的语言中，分词是非常容易的；但是在中文领域，词以汉字为单位组成，词语与词语之间并无天然的界限，句子或短语之间以标点符号作为间隔。这就导致在中文领域做 NLP 的前提是做好中文分词技术。
    
    </summary>
    
      <category term="机器学习" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="机器学习" scheme="https://suool.net/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>马尔科夫链及其采样方法</title>
    <link href="https://suool.net/2018/11/16/Markov-Chain-Monte-Carlo-2/"/>
    <id>https://suool.net/2018/11/16/Markov-Chain-Monte-Carlo-2/</id>
    <published>2018-11-16T02:36:19.000Z</published>
    <updated>2018-11-17T03:50:20.620Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="前言">前言</h2><p>了解了什么是蒙特卡罗方法之后，自然引出了马尔可夫链这个概念，其在 WIKI 的解释如下：</p><blockquote><p>马尔可夫链（英语：Markov chain），又称离散时间马尔可夫链（discrete-time Markov chain，缩写为DTMC），因俄国数学家安德烈·马尔可夫得名，为状态空间中经过从一个状态到另一个状态的转换的随机过程。该过程要求具备“无记忆”的性质：下一状态的概率分布只能由当前状态决定，在时间序列中它前面的事件均与之无关。这种特定类型的“无记忆性”称作马尔可夫性质。 在马尔可夫链的每一步，系统根据概率分布，可以从一个状态变到另一个状态，也可以保持当前状态。状态的改变叫做转移，与不同的状态改变相关的概率叫做转移概率。</p></blockquote><a id="more"></a><h2 id="定义及性质">定义及性质</h2><p>依据上述 wiki 的定义可以知道，马尔可夫链能在很多时间序列模型中得到广泛的应用，比如循环神经网络RNN，隐式马尔科夫模型HMM等，当然MCMC也需要它。</p><p>如果用精确的数学定义来描述，则假设我们的序列状态是<span class="math inline">\(...X_{t-2}, X_{t-1}, X_{t}, X_{t+1},...\)</span>那么我们的在时刻 <span class="math inline">\(X_{t+1}\)</span> 的状态的条件概率仅仅依赖于时刻 <span class="math inline">\(X_t\)</span>，即： <span class="math display">\[P(X_{t+1} |...X_{t-2}, X_{t-1}, X_{t} ) = P(X_{t+1} | X_{t})\]</span></p><p>既然某一时刻状态转移的概率只依赖于它的前一个状态，那么我们只要能求出系统中任意两个状态之间的转换概率，这个马尔科夫链的模型就定了。我们来看看下图这个马尔科夫链模型的具体的例子(来源于维基百科)。</p><figure><img src="https://suool-bolg.b0.upaiyun.com/2018/11/16/15423528014563.jpg" alt="股市转移概率"><figcaption>股市转移概率</figcaption></figure><p>这个马尔科夫链是表示股市模型的，共有三种状态：牛市（Bull market）, 熊市（Bear market）和横盘（Stagnant market）。每一个状态都以一定的概率转化到下一个状态。比如，牛市以0.025的概率转化到横盘的状态。这个状态概率转化图可以以矩阵的形式表示。如果我们定义矩阵P某一位置<span class="math inline">\(P(i,j)\)</span>的值为<span class="math inline">\(P(j|i)\)</span>,即从状态i转化到状态j的概率，并定义牛市为状态0， 熊市为状态1, 横盘为状态2. 这样我们得到了马尔科夫链模型的状态转移矩阵为： <span class="math display">\[P=\left( \begin{array}{ccc} 0.9&amp;0.075&amp;0.025 \\ 0.15&amp;0.80&amp; 0.05 \\ 0.25&amp;0.25&amp;0.5 \end{array} \right)\]</span></p><p>假设已知当前处在熊市、牛市、横盘的人的比例是概率分布向量<span class="math inline">\(π_0=[π_0(1),π_0(2),π_0(3)]\)</span>,那么第一天的分布比例将是<span class="math inline">\(π_1=π_0P\)</span>, 第二天的分布比例将是<span class="math inline">\(π_2=π_1P=π_0P^2\)</span> ，第n天分布比例将是<span class="math inline">\(π_n=π_{n−1}P=π_0P^n\)</span>。</p><p>假设我们当前已知股市的概率分布为：[0.8,0.1,0.1],即80%概率的牛市，10%概率的熊盘与10%的横盘。然后这个状态作为序列概率分布的初始状态<span class="math inline">\(t_0\)</span>，将其带入这个状态转移矩阵计算<span class="math inline">\(t_1,t_2,t_3...\)</span>的状态。代码如下： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">matrix = np.matrix([[<span class="number">0.9</span>,<span class="number">0.075</span>,<span class="number">0.025</span>],[<span class="number">0.15</span>,<span class="number">0.8</span>,<span class="number">0.05</span>],[<span class="number">0.25</span>,<span class="number">0.25</span>,<span class="number">0.5</span>]], dtype=float)</span><br><span class="line">vector1 = np.matrix([[<span class="number">0.8</span>,<span class="number">0.1</span>,<span class="number">0.1</span>]], dtype=float)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    vector1 = vector1*matrix</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Current round:"</span> , i+<span class="number">1</span></span><br><span class="line">    <span class="keyword">print</span> vector1</span><br></pre></td></tr></table></figure></p><p>通过观察输出结果,可以看出在迭代一定次数之后,数据结果出现了如下的稳定情况 <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Current round: <span class="number">48</span></span><br><span class="line"><span class="string">[[0.62500011 0.3124999  0.06249999]]</span></span><br><span class="line">Current round: <span class="number">49</span></span><br><span class="line"><span class="string">[[0.62500008 0.31249992 0.06249999]]</span></span><br><span class="line">Current round: <span class="number">50</span></span><br><span class="line"><span class="string">[[0.62500006 0.31249994 0.06249999]]</span></span><br><span class="line">.............</span><br><span class="line">Current round: <span class="number">59</span></span><br><span class="line"><span class="string">[[0.625  0.3125 0.0625]]</span></span><br><span class="line">Current round: <span class="number">60</span></span><br><span class="line"><span class="string">[[0.625  0.3125 0.0625]]</span></span><br><span class="line">Current round: <span class="number">61</span></span><br><span class="line"><span class="string">[[0.625  0.3125 0.0625]]</span></span><br><span class="line">Current round: <span class="number">62</span></span><br><span class="line"><span class="string">[[0.625  0.3125 0.0625]]</span></span><br><span class="line">........</span><br></pre></td></tr></table></figure></p><p>可以发现，从第60轮开始，我们的状态概率分布就不变了，一直保持在[0.625 0.3125 0.0625]，即62.5%的牛市，31.25%的熊市与6.25%的横盘。</p><p>我们现在换一个初始概率分布试一试，现在我们用[0.7,0.1,0.2]作为初始概率分布, 利用上述的代码计算,得出的结果一样出现的最终状态的概率分布趋于同一个稳定的概率分布[0.625 0.3125 0.0625], 也就是说我们的<strong>马尔科夫链模型的状态转移矩阵收敛到的稳定概率分布与我们的初始状态概率分布无关</strong>。这是一个非常好的性质, 也就是说，如果我们得到了这个稳定概率分布对应的马尔科夫链模型的状态转移矩阵，则我们可以用任意的概率分布样本开始，代入马尔科夫链模型的状态转移矩阵，这样经过一些序列的转换，最终就可以得到符合对应稳定概率分布的样本。</p><p>这个性质不光对我们上面的状态转移矩阵有效，对于绝大多数的其他的马尔科夫链模型的状态转移矩阵也有效。同时不光是离散状态，连续状态时也成立。</p><p>同时这个性质也意味着，对于一个确定的状态转移矩阵 P，它的 n 次幂<span class="math inline">\(P^n\)</span>在当 n 大于一定的值的时候也可以发现是确定的.</p><h3 id="性质的数学语言描述">性质的数学语言描述</h3><p>如果一个非周期的马尔科夫链有状态转移矩阵P, 并且它的任何两个状态是连通的，那么<span class="math inline">\(\lim_{n \to \infty}P_{ij}^n\)</span>与 i 无关，我们有： <span class="math display">\[\lim_{n \to \infty}P_{ij}^n = \pi(j) \tag{1}\]</span></p><p><span class="math display">\[\lim_{n \to \infty}P^n = \left( \begin{array}{ccc} \pi(1)&amp;\pi(2)&amp;\ldots&amp;\pi(j)&amp;\ldots \\ \pi(1)&amp;\pi(2)&amp;\ldots&amp;\pi(j)&amp;\ldots \\ \ldots&amp;\ldots&amp;\ldots&amp;\ldots&amp;\ldots \\ \pi(1)&amp;\pi(2)&amp;\ldots&amp;\pi(j)&amp;\ldots \\ \ldots&amp;\ldots&amp;\ldots&amp;\ldots&amp;\ldots \end{array} \right) \tag{2}\]</span></p><p><span class="math display">\[\pi(j) = \sum\limits_{i=0}^{\infty}\pi(i)P_{ij} \tag{3}\]</span></p><p>π 是方程<span class="math inline">\(πP=π\)</span>的唯一非负解，其中 <span class="math display">\[\pi = [\pi(1),\pi(2),...,\pi(j),...]\;\; , \sum\limits_{i=0}^{\infty}\pi(i) = 1 \tag{4}\]</span></p><p>上面的性质中需要解释的有：</p><ol type="1"><li>非周期的马尔科夫链：定理中的“非周期“这个概念不解释，因为我们遇到的绝大多数马氏链都是非周期的；这个主要是指马尔科夫链的状态转化不是循环的，如果是循环的则永远不会收敛。幸运的是我们遇到的马尔科夫链一般都是非周期性的。用数学方式表述则是：对于任意某一状态i，d为集合<span class="math inline">\(\{n \mid n \geq 1,P_{ii}^n&gt;0 \}\)</span>的最大公约数，如果 d=1 ，则该状态为非周期的</li><li>任何两个状态是连通的：这个指的是从任意一个状态可以通过有限步到达其他的任意一个状态，不会出现条件概率一直为0导致不可达的情况。</li><li>马尔科夫链的状态数可以是有限的，也可以是无限的。因此可以用于连续概率分布和离散概率分布。</li><li>π 通常称为马尔科夫链的平稳分布。</li><li>我们用<span class="math inline">\(X_i\)</span>表示在马氏链上跳转第 i 步所处的状态，如果<span class="math inline">\(\lim_{n \rightarrow \infty}P_{ij}^{n} = \pi(j)\)</span>存在,很容易证明定理第二个结论 <span class="math display">\[P(X_{n+1}=j) = \sum_{i=1}^{\infty}P(X_{n}=i)P(X_{n+1}=j\mid x_{n}=i)=\sum_{i=1}^{\infty}P(X_{n}=i) p_{ij}\]</span></li></ol><h2 id="基于马尔科夫链采样">基于马尔科夫链采样</h2><p>对于给定的概率分布<span class="math inline">\(p(x)\)</span> ，我们希望能有便捷的方式生成它对应的样本。由于马尔科夫链能收敛到平稳分布，于是一个很的漂亮想法是：如果我们能构造一个转移矩阵为 P 的马尔科夫链，使得该马尔科夫链的平稳分布恰好是<span class="math inline">\(p(x)\)</span>，那么我们从任何一个初始状态<span class="math inline">\(x_0\)</span>出发沿着马尔科夫链转移，得到一个转移序列<span class="math inline">\(x_0,x_1,x_2,\ldots,x_n,x_{n+1},\ldots\)</span>, 如果马尔科夫在第n步已经收敛了，于是我们就得到了<span class="math inline">\(p(x)\)</span>的样本<span class="math inline">\(x_n,x_{n+1},\ldots\)</span></p><p>总结下基于马尔科夫链的采样过程：</p><ol type="1"><li>输入马尔科夫链状态转移矩阵P，设定状态转移次数阈值<span class="math inline">\(n_1\)</span>，需要的样本个数<span class="math inline">\(n_2\)</span></li><li>从任意简单概率分布采样得到初始状态值<span class="math inline">\(x_0\)</span></li><li><span class="math inline">\(for t=0 to n_1+n_2−1:\)</span> 从条件概率分布<span class="math inline">\(P(x|x_t)\)</span>中采样得到样本<span class="math inline">\(x_t+1\)</span></li></ol><p>样本集<span class="math inline">\((x_{n1},x_{n_1+1},\ldots,...,x_{n1+n2−1})\)</span>即为我们需要的平稳分布对应的样本集。</p><h2 id="小结">小结</h2><p>马尔科夫链的收敛性质主要由转移矩阵P决定， 所以基于马尔科夫链做采样的关键问题是如何构造转移矩阵P，使得平稳分布恰好是我们要的分布<span class="math inline">\(p(x)\)</span>。</p><p>如何能做到这一点呢？</p><p>幸运的是，MCMC采样通过迂回的方式解决了上面这个大问题，我们在下一篇来讨论MCMC的采样，以及它的使用改进版采样: M-H(Metropolis-Hastings)采样和Gibbs采样.</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;p&gt;了解了什么是蒙特卡罗方法之后，自然引出了马尔可夫链这个概念，其在 WIKI 的解释如下：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;马尔可夫链（英语：Markov chain），又称离散时间马尔可夫链（discrete-time Markov chain，缩写为DTMC），因俄国数学家安德烈·马尔可夫得名，为状态空间中经过从一个状态到另一个状态的转换的随机过程。该过程要求具备“无记忆”的性质：下一状态的概率分布只能由当前状态决定，在时间序列中它前面的事件均与之无关。这种特定类型的“无记忆性”称作马尔可夫性质。 在马尔可夫链的每一步，系统根据概率分布，可以从一个状态变到另一个状态，也可以保持当前状态。状态的改变叫做转移，与不同的状态改变相关的概率叫做转移概率。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="统计学" scheme="https://suool.net/categories/%E7%BB%9F%E8%AE%A1%E5%AD%A6/"/>
    
    
      <category term="算法" scheme="https://suool.net/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>蒙特卡罗方法概述</title>
    <link href="https://suool.net/2018/11/16/Markov-Chain-Monte-Carlo-1/"/>
    <id>https://suool.net/2018/11/16/Markov-Chain-Monte-Carlo-1/</id>
    <published>2018-11-16T02:06:19.000Z</published>
    <updated>2018-12-04T12:28:40.224Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="前言">前言</h2><p>作为一种随机采样方法，马尔科夫链蒙特卡罗（Markov Chain Monte Carlo，以下简称MCMC）在机器学习,深度学习以及自然语言处理等领域都有广泛的应用，是很多复杂算法求解的基础。</p><p>从名字我们可以看出，MCMC由两个MC组成，即蒙特卡罗方法（Monte Carlo Simulation，简称MC）和马尔科夫链（Markov Chain ，也简称MC）。要弄懂MCMC的原理我们首先得搞清楚蒙特卡罗方法和马尔科夫链的原理。 <a id="more"></a></p><h2 id="蒙特卡罗方法">蒙特卡罗方法</h2><p>蒙特卡罗原来是一个赌场的名称，用它作为名字大概是因为蒙特卡罗方法是一种随机模拟的方法，这很像赌博场里面的扔骰子的过程。原理是通过大量随机样本，去了解一个系统，进而得到所要计算的值。</p><p>它非常强大和灵活，又相当简单易懂，很容易实现。对于许多问题来说，它往往是最简单的计算方法，有时甚至是唯一可行的方法。</p><p>具体的适合理解的例子参考<a href="http://www.ruanyifeng.com/blog/2015/07/monte-carlo-method.html" target="_blank" rel="noopener">这篇文章</a></p><p>给定统计样本集，如何估计产生这个样本集的随机变量概率密度函数,是我们比较熟悉的概率密度估计问题。 求解概率密度估计问题的常用方法是最大似然估计、最大后验估计等。但是，我们思考概率密度估计问题的逆问题:给定一个概率分布p(x)，如何让计算机生成满足这个概率分布的样本。 这个问题就是统计模拟中研究的重要问题–采样(Sampling)。</p><p>如果有一个我们很难求解出<span class="math inline">\(f(x)\)</span>的原函数的函数, 现要求其在定义域 [a, b] 上的积分, 如果这个函数是均匀分布, 那么我们可以采样 [a,b] 区间的 n 个值：<span class="math inline">\({x_0,x_1,...x_{n-1}}\)</span>,用它们的均值来代表 [a,b] 区间上所有的 f(x) 的值。这样我们上面的定积分的近似求解为:</p><p><span class="math display">\[\theta = \int_a^b f(x)dx = \frac{b-a}{n}\sum\limits_{i=0}^{n-1}f(x_i)\]</span></p><p>如果不是均匀分布, 并<strong>假设我们可以得到 <span class="math inline">\(x\)</span> 在<span class="math inline">\([a,b]\)</span>的概率分布函数<span class="math inline">\(p(x)\)</span></strong>，那么我们的定积分求和可以这样进行： <span class="math display">\[\theta = \int_a^b f(x)dx =  \int_a^b \frac{f(x)}{p(x)}p(x)dx \approx \frac{1}{n}\sum\limits_{i=0}^{n-1}\frac{f(x_i)}{p(x_i)}\]</span></p><p>上式最右边的这个形式就是蒙特卡罗方法的一般形式。当然这里是连续函数形式的蒙特卡罗方法，但是在离散时一样成立。</p><p>可以看出，最上面我们假设x在[a,b]之间是均匀分布的时候，p(xi)=1/(b−a)，带入我们有概率分布的蒙特卡罗积分的上式，可以得到： <span class="math display">\[\frac{1}{n}\sum\limits_{i=0}^{n-1}\frac{f(x_i)}{1/(b-a)} = \frac{b-a}{n}\sum\limits_{i=0}^{n-1}f(x_i)\]</span></p><p>也就是说，我们最上面的均匀分布也可以作为一般概率分布函数<span class="math inline">\(p(x)\)</span>在均匀分布时候的特例。那么我们现在的问题转到了如何在已知分布求出 x 的分布<span class="math inline">\(p(x)\)</span>对应的若干个样本上来。</p><h2 id="采样方法">采样方法</h2><p>主要有概率分布采样及接受-拒绝采样方法. ###概率分布采样 如果求出了<span class="math inline">\(x\)</span>的概率分布，我们可以基于概率分布去采样基于这个概率分布的 n 个<span class="math inline">\(x\)</span>的样本集，带入蒙特卡罗求和的式子即可求解。但是还有一个关键的问题需要解决，即如何基于概率分布去采样基于这个概率分布的 n 个<span class="math inline">\(x\)</span>的样本集。</p><p>一般而言均匀分布<code>Uniform(0,1)</code>的样本是相对容易生成的。 通过线性同余发生器可以生成伪随机数，我们用确定性算法生成[0,1]之间的伪随机数序列后， 这些序列的各种统计指标和均匀分布<code>Uniform(0,1)</code>的理论计算结果非常接近。这样的伪随机序列就有比较好的统计性质，可以被当成真实的随机数使用。线性同余随机数生成器如下: <span class="math display">\[x_{n+1}=(ax_n+c)~\textrm{mod}~m\]</span> 式中<span class="math inline">\(a，c，m\)</span>是数学推导出的合适的常数。这种算法产生的下一个随机数完全依赖当前的随机数，当随机数序列足够大的时候，随机数会出现重复子序列的情况。 当然，也有很多更加先进的随机数产生算法出现，比如<code>numpy</code>用的是 <code>Mersenne Twister</code> 等.</p><p>而其他常见的概率分布，无论是离散的分布还是连续的分布，它们的样本都可以通过<code>Uniform(0,1)</code>的样本转换而得, 但是如何产生满足其他分布下的随机数呢？</p><p>比如二维正态分布的样本<span class="math inline">\((Z1,Z2)\)</span>可以通过通过独立采样得到的<code>uniform(0,1)</code>样本对<span class="math inline">\((X1,X2)\)</span>通过如下的式子转换而得： <span class="math display">\[Z_1 = \sqrt{-2 ln X_1}cos(2\pi X_2) \\Z_2 = \sqrt{-2 ln X_1}sin(2\pi X_2)\]</span></p><p>其他一些常见的连续分布，比如<code>t分布</code>，<code>F分布</code>，<code>Beta分布</code>，<code>Gamma分布</code>等，都可以通过类似的方式从<code>uniform(0,1)</code>得到的采样样本转化得到。在python的<code>numpy</code>，<code>scikit-learn</code>等类库中，都有生成这些常用分布样本的函数可以使用。</p><p>不过很多时候，我们的x的概率分布不是常见的分布，这意味着我们没法方便的得到这些非常见的概率分布的样本集。那这个问题怎么解决呢？</p><h3 id="接受-拒绝采样">接受-拒绝采样</h3><p>对于概率分布不是常见的分布，一个可行的办法是采用接受-拒绝采样来得到该分布的样本。既然 <span class="math inline">\(p(x)\)</span> 太复杂在程序中没法直接采样，那么我设定一个程序可采样的分布 <span class="math inline">\(q(x\)</span>) 比如高斯分布，然后按照一定的方法拒绝某些样本，以达到接近 <span class="math inline">\(p(x)\)</span> 分布的目的，其中<span class="math inline">\(q(x)\)</span>叫做 <code>proposal distribution</code>。</p><p>具体采用过程如下，设定一个方便采样的常用概率分布函数 q(x)，以及一个常量 k，使得 p(x) 总在 kq(x) 的下方。</p><figure><img src="https://suool-bolg.b0.upaiyun.com/2018/11/16/15423393056582.jpg" alt="接受-拒绝采样-w283"><figcaption>接受-拒绝采样-w283</figcaption></figure><p>首先，采样得到<code>q(x)</code>的一个样本<span class="math inline">\(z_0\)</span>，采样方法如上，使用<code>uniform(0,1)</code>转换得到。然后，从均匀分布<span class="math inline">\((0,kq(z_0))\)</span>中采样得到一个值<span class="math inline">\(u\)</span>。如果<span class="math inline">\(u\)</span>落在了上图中的灰色区域，则拒绝这次抽样，否则接受这个样本<span class="math inline">\(z_0\)</span>。重复以上过程得到 n 个接受的样本 <span class="math inline">\(z_0,z_1,...z_{n−1}\)</span>,则最后的蒙特卡罗方法求解结果为： <span class="math display">\[\frac{1}{n}\sum\limits_{i=0}^{n-1}\frac{f(z_i)}{p(z_i)}\]</span> 整个过程中，我们通过一系列的接受拒绝决策来达到用q(x)模拟p(x)概率分布的目的。</p><h2 id="小结">小结</h2><p>使用接受-拒绝采样，我们可以解决一些概率分布不是常见的分布的时候，得到其采样集并用蒙特卡罗方法求和的目的。但是接受-拒绝采样也只能部分满足我们的需求，在很多时候我们还是很难得到我们的概率分布的样本集。比如：</p><ol type="1"><li>对于一些二维分布<span class="math inline">\(p(x,y)\)</span>，有时候我们只能得到条件分布<span class="math inline">\(p(x|y)\)</span>和<span class="math inline">\(p(y|x)\)</span>,却很难得到二维分布<span class="math inline">\(p(x,y)\)</span>一般形式，这时我们无法用接受-拒绝采样得到其样本集。</li><li>对于一些高维的复杂非常见分布<span class="math inline">\(p(x_1,x_2,...,x_n)\)</span>，我们要找到一个合适的<span class="math inline">\(q(x)和\)</span>k$非常困难。</li></ol><p>从上面可以看出，要想将蒙特卡罗方法作为一个通用的采样模拟求和的方法，必须解决如何方便得到各种复杂概率分布的对应的采样样本集的问题。</p><p>此时就需要使用一些更加复杂的随机模拟的方法来生成样本。比如马尔科夫链蒙特卡罗方法，了解这个算法我们首先要对马尔科夫链的平稳分布的性质有基本的认识。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;p&gt;作为一种随机采样方法，马尔科夫链蒙特卡罗（Markov Chain Monte Carlo，以下简称MCMC）在机器学习,深度学习以及自然语言处理等领域都有广泛的应用，是很多复杂算法求解的基础。&lt;/p&gt;
&lt;p&gt;从名字我们可以看出，MCMC由两个MC组成，即蒙特卡罗方法（Monte Carlo Simulation，简称MC）和马尔科夫链（Markov Chain ，也简称MC）。要弄懂MCMC的原理我们首先得搞清楚蒙特卡罗方法和马尔科夫链的原理。
    
    </summary>
    
      <category term="机器学习" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="算法" scheme="https://suool.net/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>自剖</title>
    <link href="https://suool.net/2018/11/01/self-analysis/"/>
    <id>https://suool.net/2018/11/01/self-analysis/</id>
    <published>2018-10-31T23:15:32.000Z</published>
    <updated>2018-11-27T01:44:25.266Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="说明前面">说明前面</h2><p>这是一篇去年差不多这个时候写的东西，现在读起来依然适用现在的自己。</p><p>最近这几天是真的有点不好受，昨晚几乎失眠了一整晚，缺少很多的东西，对未来看不清楚，对自己没有信心，心里面就充满了怀疑。 <a id="more"></a> ## 正文</p><p>我终究还是成为了现在的我，我迷失了自我。</p><p>如今的我变成了什么样子呢？ 直观的感受来说，我变成了一个越来越封闭，一个离内在自我越来越远的自己了。这个过程像是我自己亲手给我自己筑了一堵墙，或者说我亲手抛弃了我自己，任由他在那里腐化、堕落、锈蚀，然后，至于此地，我越来越觉得难辨真正的自己是什么样了。</p><p>现在看上一次写这些东西，那时的我的确发现一些问题所在，但是也仅是止步于此，而后至今，我非但未能解决问题，反而使问题更加复杂和难以解决了。</p><p>现在的我越来越认同“最难也最重要的是经营好自己”这句话了。不仅是我现在近乎彻底失败于经营自己，也是在自察我的生活，直观的感觉就是众多问题都是由我而起。 自身都经营不好，谈何经营一段良好的亲密关系，谈何拥有一个好的未来。与人关系及美好的未来，如若缺少一个足够好的自己存在，怎么想都觉得不可能。</p><p>自我的经营，包括内在自我的经营和外在自我的经营。 近些日子，读了一些书，对于内在的自我和意识有了更多更深刻清晰的认识，所以，多谈一下这方面。</p><p>内在的自我不仅仅是指那个理性、逻辑的意识自我，也包括在潜意识中的自我。 内在的意识的自我是我的脑的活动的直接映射，而我的脑的活动则更多的是先验自我的映射，也即是昨日的我造就了今日的我，今日我蕴含着明日的我。 因此，经营内在自我的关键明显就在于经营当下的自我，因为当下所做的每个选择，每个情绪反应都是为以后的自我埋下伏笔，现时的每次情绪反馈和选择都不可避免的成为我的脑的先验自我的经验的一部分，从而成为其下一次重复当下的一个可能选择，重复这个选择即是再次强化意识中的自我，意识又会继续强化我的感受和情绪，进而形成了一个正向的反馈循环。 至此，改变内在自己我的唯一可能就是打破这个过去自我与当下自我的循环，从而造就新的当下自我和未来自我的新的循环的可能。说的在直接点，就是改变当下自我不如过去自我一样的选择和情绪反应，才能为产生一个新的明日自我提供可能。</p><p>纵观这些日子，我则在一遍又一遍的强化那个懒惰、消极、贪婪、放纵的自我，一次又一次的不断重复过去自我所做的错误选择，成为了今日的我，算是“修得正果”。</p><p>外在的自我的经营首先是对自己身体的经营，强身健体，其意义显然无需赘言。其次是外界关系的经营，人际沟通，心智交流。</p><p>这段时间里，在自己的亲密关系里面，因为自己不自觉的要去选择封闭自己，隐藏自己的感受，导致很多问题不仅没有被解决而且变得更加复杂和不堪。对于自己的不满意也使得自己缺少很多的耐心。</p><p>然后，现在就又回到了那个亘古难题：明明知道自己该怎么做，该做什么，但是就是不去做，做不好。</p><p>这里，我先自我剖析我的实际情况： 首先，很多情况下只有在当下这种自剖的时候，我才清醒的意识到自己该做什么，真正在日常生活中，往往是<em>由着自己的大脑做着潜意识下的决定</em>而走了。 其次，即是偶尔能够在面对选择和决定的时候（比如早上起床）意识到自己真正应该做的决定，但是要么是自己创造了一个理由没有去选择，要么是选择了但是具体执行的时候效果很不好。 最后，在自己做了不该做的选择之后，偶尔会意识到自己不应该如此，但是却无法去改变自己的方向，无法停止之前错误的选择造成的行为，而是继续任由自己错误下去。</p><p>根据上面的自己的实际情况，改变自己的可以尝试的方式是，每当自己面临比较关键的选择的时候，主动的去注意观察自己大脑的反应，观察自己潜意识的意图是什么，然后停下来，试着和自己的情绪和感受共处，不要急于做不同的决定，先试着跟它共处。 试着学会觉察自己的潜意识做决定时候的意图，站在一个第三方的角度去看自己的情绪和感受，与这个时候的自己共处，与自我的懒惰、拖延、放纵的意图保持觉察的链接。会对自己更深刻的认识和了解，多去练习这个过程。</p><p>比如早上闹钟响起，要做起不起床的决定的时候，去观察下此时自己内心的意图，不用急着说服自己起床，就纯粹是与此刻自己这个无论是要起床还是继续睡觉的意图保持链接，停下来和它共处，观察，然后再去做决定。</p><p>类似的还有在要不要锻炼，要不要赶紧关上灯关上手机睡觉等等这些决定的时候都一样，试着去观察自己当时的意图，并停下来和它共处。</p><p>这样子必然存在一定的困难，因为这是有意识的觉察无意识决定的过程，但是只要用心去做，还是做得到的，不用急着改变想法，只是尝试着要去观察并且和它共处，把它当作客观存在的东西，把自己当成一个观察的第三者。</p><p>改变，特别是向好的改变，意味着打破大脑同意识的旧有循环，而旧有循环之所以能够成为一个固化的循环，就是因为他能给大脑带来舒适，给意识带来愉悦。因此，改变，便意味这个打破这个正向反馈的“舒适愉悦”的循环，必然伴随着大脑的不适应及情绪上的痛苦体验，也必然是不易的。 但是，好的改变，都值得去尝试和牺牲。</p><p>学会和糟糕的自己和解，同做糟糕决定的大脑和意识共处，去觉察自己的懒惰、放纵等意图闪现的瞬间，然后停下来和他们共处。这是有意识觉察无意识的意图的练习。努力将有意识觉察养成无意识觉察的习惯，会发现更多关于深层次自我的东西。</p><p>这次找出了一些问题，也想了一些解决的方法，试试看吧。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;说明前面&quot;&gt;说明前面&lt;/h2&gt;
&lt;p&gt;这是一篇去年差不多这个时候写的东西，现在读起来依然适用现在的自己。&lt;/p&gt;
&lt;p&gt;最近这几天是真的有点不好受，昨晚几乎失眠了一整晚，缺少很多的东西，对未来看不清楚，对自己没有信心，心里面就充满了怀疑。
    
    </summary>
    
      <category term="心理学" scheme="https://suool.net/categories/%E5%BF%83%E7%90%86%E5%AD%A6/"/>
    
    
      <category term="反思" scheme="https://suool.net/tags/%E5%8F%8D%E6%80%9D/"/>
    
  </entry>
  
  <entry>
    <title>pytorch 自定义数据集及 Kaggle 101 数字识别</title>
    <link href="https://suool.net/2018/10/29/custom-dataset-use-pytorch/"/>
    <id>https://suool.net/2018/10/29/custom-dataset-use-pytorch/</id>
    <published>2018-10-29T12:54:46.000Z</published>
    <updated>2018-10-30T02:39:59.258Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="引言">引言</h2><p>前面的文章中使用 feed forward neural network 实现了简单的手写数字识别，但是这不能直接照搬到 kaggle上面，因为 kaggle 使用的数据集是 CSV 文件，因此需要自定义一个 pytorch 的数据类型，来完成这个入门题目。</p><p>本文的提纲如下: 1. 自定义 Dataset 2. 模型搭建保存与读取 <a id="more"></a></p><h2 id="自定义-dataset">自定义 Dataset</h2><p>Pytorch的数据读取主要包含三个类: 1. Dataset 2. DataLoader 3. DataLoaderIter</p><p>这三者大致是一个依次封装的关系: Dataset 被封装进DataLoader, DataLoader 被装进 DataLoaderIter。</p><h3 id="torch.utils.data.dataset">torch.utils.data.Dataset</h3><p>这个类的源码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dataset</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""An abstract class representing a Dataset.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    All other datasets should subclass it. All subclasses should override</span></span><br><span class="line"><span class="string">    ``__len__``, that provides the size of the dataset, and ``__getitem__``,</span></span><br><span class="line"><span class="string">    supporting integer indexing in range from 0 to len(self) exclusive.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span><span class="params">(self, index)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__add__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> ConcatDataset([self, other])</span><br></pre></td></tr></table></figure><p>其类的说明在上述源码的注释中一目了然，这是一个抽象类, 自定义的Dataset需要继承它并且实现下面两个成员方法:</p><ol type="1"><li><code>__getitem__()</code> 方法</li><li><code>__len__()</code> 方法</li></ol><p>自定义类的框架如下:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomDataset</span><span class="params">(torch.utils.data.Dataset)</span>:</span><span class="comment">#需要继承data.Dataset</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># TODO</span></span><br><span class="line">        <span class="comment"># 1. Initialize file path or list of file names.</span></span><br><span class="line">        <span class="comment"># 做一些初始化的工作</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span><span class="params">(self, index)</span>:</span></span><br><span class="line">        <span class="comment"># TODO</span></span><br><span class="line">        <span class="comment"># 1. Read one data from file (e.g. using numpy.fromfile, PIL.Image.open).</span></span><br><span class="line">        <span class="comment"># 2. Preprocess the data (e.g. torchvision.Transform).</span></span><br><span class="line">        <span class="comment"># 3. Return a data pair (e.g. image and label).</span></span><br><span class="line">        <span class="comment"># 这里需要注意的是，第一步：read one data，是一个data</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># You should change 0 to the total size of your dataset.</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><p>以下是官方的 <code>MNIST</code> 的一个参考例子：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MNIST</span><span class="params">(data.Dataset)</span>:</span></span><br><span class="line">    <span class="string">"""`MNIST &lt;http://yann.lecun.com/exdb/mnist/&gt;`_ Dataset.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        root (string): Root directory of dataset where ``processed/training.pt``</span></span><br><span class="line"><span class="string">            and  ``processed/test.pt`` exist.</span></span><br><span class="line"><span class="string">        train (bool, optional): If True, creates dataset from ``training.pt``,</span></span><br><span class="line"><span class="string">            otherwise from ``test.pt``.</span></span><br><span class="line"><span class="string">        download (bool, optional): If true, downloads the dataset from the internet and</span></span><br><span class="line"><span class="string">            puts it in root directory. If dataset is already downloaded, it is not</span></span><br><span class="line"><span class="string">            downloaded again.</span></span><br><span class="line"><span class="string">        transform (callable, optional): A function/transform that  takes in an PIL image</span></span><br><span class="line"><span class="string">            and returns a transformed version. E.g, ``transforms.RandomCrop``</span></span><br><span class="line"><span class="string">        target_transform (callable, optional): A function/transform that takes in the</span></span><br><span class="line"><span class="string">            target and transforms it.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, root, train=True, transform=None, target_transform=None, download=False)</span>:</span></span><br><span class="line">        self.root = os.path.expanduser(root)</span><br><span class="line">        self.transform = transform</span><br><span class="line">        self.target_transform = target_transform</span><br><span class="line">        self.train = train  <span class="comment"># training set or test set</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> download:</span><br><span class="line">            self.download()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self._check_exists():</span><br><span class="line">            <span class="keyword">raise</span> RuntimeError(<span class="string">'Dataset not found.'</span> +</span><br><span class="line">                               <span class="string">' You can use download=True to download it'</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.train:</span><br><span class="line">            self.train_data, self.train_labels = torch.load(</span><br><span class="line">                os.path.join(self.root, self.processed_folder, self.training_file))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.test_data, self.test_labels = torch.load(</span><br><span class="line">                os.path.join(self.root, self.processed_folder, self.test_file))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span><span class="params">(self, index)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            index (int): Index</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            tuple: (image, target) where target is index of the target class.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> self.train:</span><br><span class="line">            img, target = self.train_data[index], self.train_labels[index]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img, target = self.test_data[index], self.test_labels[index]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># doing this so that it is consistent with all other datasets</span></span><br><span class="line">        <span class="comment"># to return a PIL Image</span></span><br><span class="line">        img = Image.fromarray(img.numpy(), mode=<span class="string">'L'</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.transform <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            img = self.transform(img)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.target_transform <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            target = self.target_transform(target)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> img, target</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.train:</span><br><span class="line">            <span class="keyword">return</span> len(self.train_data)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> len(self.test_data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_check_exists</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> os.path.exists(os.path.join(self.root, self.processed_folder, self.training_file)) <span class="keyword">and</span> \</span><br><span class="line">            os.path.exists(os.path.join(self.root, self.processed_folder, self.test_file))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">download</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Download the MNIST data if it doesn't exist in processed_folder already."""</span></span><br><span class="line">        <span class="comment"># PASS</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># PASS</span></span><br><span class="line">        <span class="keyword">return</span> fmt_str</span><br></pre></td></tr></table></figure><p>第一个最为重要, 即每次怎么读数据；上面的读取图片的例子中可以看出如何实现这个方法，值得一提的是, <code>pytorch</code> 还提供了很多常用的 <code>transform</code>, 在 <code>torchvision.transforms</code> 里面, 本文中不多介绍, 我常用的有<code>Resize</code> , <code>RandomCrop</code> , <code>Normalize</code> , <code>ToTensor</code> (这个<strong>极为重要</strong>, 可以把一个 <code>PIL或numpy</code> 图片转为 <code>torch.Tensor</code>, 但是好像对 <code>numpy</code> 数组的转换比较受限, 所以这里建议在 <code>__getitem__()</code> 里面用 <code>PIL</code> 来读图片, 而不是用 <code>skimage.io</code>)。</p><p>第二个比较简单, 就是返回整个数据集的长度。</p><p>按照这个思路，我写的Version 1.0 版的如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DigitDataSet</span><span class="params">(torch.utils.data.Dataset)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, data_path, train=True, transform=None, target_transform=None)</span>:</span></span><br><span class="line">        self.transform = transform</span><br><span class="line">        self.train = train</span><br><span class="line">        self.target_transform = target_transform</span><br><span class="line">        self.data = pd.read_csv(data_path, header=<span class="number">0</span>, sep=<span class="string">','</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span><span class="params">(self, index)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.train:</span><br><span class="line">            img, target = self.data.iloc[index:index+<span class="number">1</span>, <span class="number">1</span>:].values.reshape(<span class="number">28</span>, <span class="number">28</span>).astype(np.uint8), self.data.iloc[index:index+<span class="number">1</span>, :<span class="number">1</span>].values[<span class="number">0</span>].tolist()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img, target = self.data.iloc[index:index + <span class="number">1</span>, :].values.reshape(<span class="number">28</span>, <span class="number">28</span>).astype(np.uint8), \</span><br><span class="line">                          <span class="number">-1</span></span><br><span class="line">        <span class="comment"># doing this so that it is consistent with all other datasets</span></span><br><span class="line">        <span class="comment"># to return a PIL Image</span></span><br><span class="line">        <span class="comment"># print(target, type(target))</span></span><br><span class="line">        img = Image.fromarray(img)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.transform <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            img = self.transform(img)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.target_transform <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            target = self.target_transform(target)</span><br><span class="line">        <span class="keyword">return</span> img, target</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> len(self.data)</span><br></pre></td></tr></table></figure><p>这是一个显然不够好看的实现方式，存在一些问题，比如没办法划分训练集和验证集，只能读取训练集和测试集。有点模型训练完了，一切看天的意思。</p><p>改进版会在下次再说，这次纯粹是为了解决问题。</p><h3 id="torch.utils.data.dataloader">torch.utils.data.DataLoader</h3><p>这个类中的源代码中的注释非常详细，在此直接贴下来：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataLoader</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">r"""</span></span><br><span class="line"><span class="string">    Data loader. Combines a dataset and a sampler, and provides</span></span><br><span class="line"><span class="string">    single- or multi-process iterators over the dataset.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">        dataset (Dataset): dataset from which to load the data.</span></span><br><span class="line"><span class="string">        batch_size (int, optional): how many samples per batch to load</span></span><br><span class="line"><span class="string">            (default: ``1``).</span></span><br><span class="line"><span class="string">        shuffle (bool, optional): set to ``True`` to have the data reshuffled</span></span><br><span class="line"><span class="string">            at every epoch (default: ``False``).</span></span><br><span class="line"><span class="string">        sampler (Sampler, optional): defines the strategy to draw samples from</span></span><br><span class="line"><span class="string">            the dataset. If specified, ``shuffle`` must be False.</span></span><br><span class="line"><span class="string">        batch_sampler (Sampler, optional): like sampler, but returns a batch of</span></span><br><span class="line"><span class="string">            indices at a time. Mutually exclusive with :attr:`batch_size`,</span></span><br><span class="line"><span class="string">            :attr:`shuffle`, :attr:`sampler`, and :attr:`drop_last`.</span></span><br><span class="line"><span class="string">        num_workers (int, optional): how many subprocesses to use for data</span></span><br><span class="line"><span class="string">            loading. 0 means that the data will be loaded in the main process.</span></span><br><span class="line"><span class="string">            (default: ``0``)</span></span><br><span class="line"><span class="string">        collate_fn (callable, optional): merges a list of samples to form a mini-batch.</span></span><br><span class="line"><span class="string">        pin_memory (bool, optional): If ``True``, the data loader will copy tensors</span></span><br><span class="line"><span class="string">            into CUDA pinned memory before returning them.</span></span><br><span class="line"><span class="string">        drop_last (bool, optional): set to ``True`` to drop the last incomplete batch,</span></span><br><span class="line"><span class="string">            if the dataset size is not divisible by the batch size. If ``False`` and</span></span><br><span class="line"><span class="string">            the size of dataset is not divisible by the batch size, then the last batch</span></span><br><span class="line"><span class="string">            will be smaller. (default: ``False``)</span></span><br><span class="line"><span class="string">        timeout (numeric, optional): if positive, the timeout value for collecting a batch</span></span><br><span class="line"><span class="string">            from workers. Should always be non-negative. (default: ``0``)</span></span><br><span class="line"><span class="string">        worker_init_fn (callable, optional): If not ``None``, this will be called on each</span></span><br><span class="line"><span class="string">            worker subprocess with the worker id (an int in ``[0, num_workers - 1]``) as</span></span><br><span class="line"><span class="string">            input, after seeding and before data loading. (default: ``None``)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    .. note:: By default, each worker will have its PyTorch seed set to</span></span><br><span class="line"><span class="string">              ``base_seed + worker_id``, where ``base_seed`` is a long generated</span></span><br><span class="line"><span class="string">              by main process using its RNG. However, seeds for other libraies</span></span><br><span class="line"><span class="string">              may be duplicated upon initializing workers (w.g., NumPy), causing</span></span><br><span class="line"><span class="string">              each worker to return identical random numbers. (See</span></span><br><span class="line"><span class="string">              :ref:`dataloader-workers-random-seed` section in FAQ.) You may</span></span><br><span class="line"><span class="string">              use :func:`torch.initial_seed()` to access the PyTorch seed for</span></span><br><span class="line"><span class="string">              each worker in :attr:`worker_init_fn`, and use it to set other</span></span><br><span class="line"><span class="string">              seeds before data loading.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    .. warning:: If ``spawn`` start method is used, :attr:`worker_init_fn` cannot be an</span></span><br><span class="line"><span class="string">                 unpicklable object, e.g., a lambda function.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    __initialized = <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, dataset, batch_size=<span class="number">1</span>, shuffle=False, sampler=None, batch_sampler=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                 num_workers=<span class="number">0</span>, collate_fn=default_collate, pin_memory=False, drop_last=False,</span></span></span><br><span class="line"><span class="function"><span class="params">                 timeout=<span class="number">0</span>, worker_init_fn=None)</span>:</span></span><br><span class="line">        self.dataset = dataset</span><br><span class="line">        self.batch_size = batch_size</span><br><span class="line">        self.num_workers = num_workers</span><br><span class="line">        self.collate_fn = collate_fn</span><br><span class="line">        self.pin_memory = pin_memory</span><br><span class="line">        self.drop_last = drop_last</span><br><span class="line">        self.timeout = timeout</span><br><span class="line">        self.worker_init_fn = worker_init_fn</span><br><span class="line">        <span class="comment"># PASS</span></span><br><span class="line">        self.sampler = sampler</span><br><span class="line">        self.batch_sampler = batch_sampler</span><br><span class="line">        self.__initialized = <span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setattr__</span><span class="params">(self, attr, val)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.__initialized <span class="keyword">and</span> attr <span class="keyword">in</span> (<span class="string">'batch_size'</span>, <span class="string">'sampler'</span>, <span class="string">'drop_last'</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">'&#123;&#125; attribute should not be set after &#123;&#125; is '</span></span><br><span class="line">                             <span class="string">'initialized'</span>.format(attr, self.__class__.__name__))</span><br><span class="line"></span><br><span class="line">        super(DataLoader, self).__setattr__(attr, val)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> _DataLoaderIter(self)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> len(self.batch_sampler)</span><br></pre></td></tr></table></figure><p>从他的 <code>__init__</code> 方法中可以看出可以看到, 主要参数有这么几个:</p><ul><li><code>dataset</code> : 即上面自定义的 dataset.</li><li><code>collate_fn</code>: 这个函数用来打包 batch.</li><li><code>num_worker</code>: 非常简单的多线程方法, 只要设置为&gt;=1, 就可以多线程预读数据</li></ul><p>这个类其实就是下面将要讲的 <code>DataLoaderIter</code> 的一个框架, 一共干了两件事: 1. 定义了一堆成员变量, 到时候赋给 <code>DataLoaderIter</code>, 2. 然后有一个 <code>__iter__()</code> 函数, 把自己 &quot;装进&quot; DataLoaderIter 里面.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> DataLoaderIter(self)</span><br></pre></td></tr></table></figure><h3 id="torch.utils.data.dataloader.dataloaderiter">torch.utils.data.dataloader.DataLoaderIter</h3><p>上面提到, <code>DataLoader</code> 就是<code>DataLoaderIter</code>的一个框架, 用来传给<code>DataLoaderIter</code> 一堆参数, 并把自己装进<code>DataLoaderIter</code> 里.</p><p>比如下面一个框架:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomDataset</span><span class="params">(Dataset)</span>:</span></span><br><span class="line">   <span class="comment"># 自定义自己的dataset</span></span><br><span class="line"></span><br><span class="line">dataset = CustomDataset()</span><br><span class="line">dataloader = Dataloader(dataset, ...)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> dataloader:</span><br><span class="line">   <span class="comment"># training...</span></span><br></pre></td></tr></table></figure><p>在for 循环里, 总共有三点操作:</p><ul><li>调用了 <code>dataloader</code> 的 <code>__iter__()</code> 方法, 产生了一个<code>DataLoaderIter</code></li><li>反复调用 <code>DataLoaderIter</code> 的 <code>__next__()</code> 来得到 batch, 具体操作就是, 多次调用 dataset 的 <code>__getitem__()</code> 方法 (如果<code>num_worker&gt;0</code>就多线程调用), 然后用<code>collate_fn</code>来把它们打包成batch. 中间还会涉及到<code>shuffle</code> , 以及 <code>sample</code> 的方法等, 这里就不多说了.</li><li>数据读完后, <code>__next__()</code> 抛出一个 <code>StopIteration</code> 异常, for循环结束, <code>dataloader</code> 失效.</li></ul><h2 id="模型搭建保存与读取">模型搭建保存与读取</h2><p>模型的搭建及保存部分和<a href="https://suool.net/2018/10/07/feed-forward-neural-network-on-tf-and-pytorch/">上篇文章</a>的一模一样，这里就不多说了。</p><p>关于模型的读取预测部分代码如下： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Created on 2018-10-29</span></span><br><span class="line"><span class="string">Update  on 2018-10-29</span></span><br><span class="line"><span class="string">Author: SuooL</span></span><br><span class="line"><span class="string">Github: https://github.com/SuooL</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.utils.data</span><br><span class="line"><span class="keyword">import</span> torchvision.transforms <span class="keyword">as</span> transforms</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多核 cpu 设置</span></span><br><span class="line">os.environ[<span class="string">"OMP_NUM_THREADS"</span>] = <span class="string">"8"</span></span><br><span class="line">os.environ[<span class="string">"MKL_NUM_THREADS"</span>] = <span class="string">"8"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置使用 CPU</span></span><br><span class="line">device = torch.device(<span class="string">'cpu'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数配置</span></span><br><span class="line">input_size = <span class="number">784</span></span><br><span class="line">hidden_size = <span class="number">512</span></span><br><span class="line">num_classes = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 Fully connected neural network with one hidden layer 定义网络</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NeuralNet</span><span class="params">(nn.Module)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, input_size, hidden_size, num_classes)</span>:</span></span><br><span class="line">        super(NeuralNet, self).__init__()</span><br><span class="line">        self.fc1 = nn.Linear(input_size, hidden_size)</span><br><span class="line">        self.relu = nn.ReLU()</span><br><span class="line">        self.fc2 = nn.Linear(hidden_size, num_classes)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        out = self.fc1(x)</span><br><span class="line">        out = self.relu(out)</span><br><span class="line">        out = self.fc2(out)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model = NeuralNet(input_size, hidden_size, num_classes).to(device)</span><br><span class="line">model_dict = model.load_state_dict(torch.load(<span class="string">'model.ckpt'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Test the model 预测</span></span><br><span class="line"><span class="comment"># In test phase, we don't need to compute gradients (for memory efficiency)</span></span><br><span class="line"></span><br><span class="line">test_data = pd.read_csv(<span class="string">'test.csv'</span>, header=<span class="number">0</span>, sep=<span class="string">','</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'submission.csv'</span>, <span class="string">'w'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> csv_file:</span><br><span class="line">        writer = csv.writer(csv_file, dialect=<span class="string">'excel'</span>)</span><br><span class="line">        writer.writerow([<span class="string">"ImageId"</span>, <span class="string">"Label"</span>])</span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">28000</span>):</span><br><span class="line">            img = Image.fromarray(test_data.iloc[index:index+<span class="number">1</span>, :].values.reshape(<span class="number">28</span>, <span class="number">28</span>).astype(np.uint8))</span><br><span class="line">            transform1 = transforms.Compose([</span><br><span class="line">                transforms.ToTensor(),  <span class="comment"># range [0, 255] -&gt; [0.0,1.0]</span></span><br><span class="line">            ])</span><br><span class="line">            img_tensor = transform1(img)</span><br><span class="line">            images = img_tensor.reshape(<span class="number">-1</span>, <span class="number">28</span> * <span class="number">28</span>).to(device)</span><br><span class="line">            outputs = model(images)</span><br><span class="line">            _, predicted = torch.max(outputs.data, <span class="number">1</span>)</span><br><span class="line">            <span class="comment"># writer.writerow([])</span></span><br><span class="line">            print(<span class="string">"picture %d, predicted number is %s"</span> % (index+<span class="number">1</span>, predicted[<span class="number">0</span>].item()))</span><br><span class="line">            writer.writerow([index+<span class="number">1</span>, predicted[<span class="number">0</span>].item()])</span><br></pre></td></tr></table></figure></p><h2 id="总结">总结</h2><p>这篇文章基本上上熟悉 pytorch 自定义数据集相关的知识，代码实现并没有过多去关注，算是完成了 kaggle 第一题的尝试。</p><p>以后会更新下这个代码，实现的更优雅一些。</p><p>下篇文章会写一些关于 NLP 处理的基础经典的算法使用。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;引言&quot;&gt;引言&lt;/h2&gt;
&lt;p&gt;前面的文章中使用 feed forward neural network 实现了简单的手写数字识别，但是这不能直接照搬到 kaggle上面，因为 kaggle 使用的数据集是 CSV 文件，因此需要自定义一个 pytorch 的数据类型，来完成这个入门题目。&lt;/p&gt;
&lt;p&gt;本文的提纲如下: 1. 自定义 Dataset 2. 模型搭建保存与读取
    
    </summary>
    
      <category term="深度学习" scheme="https://suool.net/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="机器学习" scheme="https://suool.net/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>全连接前向神经网络与手写数字的实践</title>
    <link href="https://suool.net/2018/10/07/feed-forward-neural-network-on-tf-and-pytorch/"/>
    <id>https://suool.net/2018/10/07/feed-forward-neural-network-on-tf-and-pytorch/</id>
    <published>2018-10-07T10:15:42.000Z</published>
    <updated>2018-10-29T12:53:08.399Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="引言">引言</h2><p>上一篇文章提到了 logistics regression 、多分类的 softmax 算法及梯度等概念，其实就可以很自然的引出深度学习了。</p><p>引用WiKi的定义： &gt;深度学习（deep learning）是机器学习的分支，是一种试图使用包含复杂结构或由多重非线性变换构成的多个处理层对数据进行高层抽象的算法。</p><p>早在1958年就提出了 perceptron 的模型，即最简单的线性感知机模型，在当时引起了很大的轰动，甚至提出了机器可以取代人的说法，然而后来就被人质疑，现在看来线性感知机的限制显而易见。</p><p>然后在20世纪80年代，根据之前 perceptron 提出了 multi-layer perceptron（又叫 Neural Network）， 这个模型和当今的深度神经网络是没有显著区别的。1986年提出了反向传播的概念，但是通常大于三层的 hidden layer 就没有效果了，神经网络学习出现了梯度消失的问题。</p><p>后来在 2006年，在上述神经网络的算法模型上，取得了一些改进（RBM initialization），将之前 multi-layer perceptron 改了个名字 —— Deep Learning 重新提了出来，2009年的时候 DL 的运算开始利用 GPU，后面其在各个领域取得了一些突破性的应用进展，就火起来了。</p><p>所以，深度学习并不是什么新鲜事物，只是换了个名字的稍微改进的旧模型。 <a id="more"></a></p><h2 id="全连接前向神经网络">全连接前向神经网络</h2><p>一个全连接的前向神经网络示例如下所示，其激活函数是之前提到的 sigmod 函数，经过这个全连接的神经网络，其 weight 和 bias 都知道的情况下，输入的向量就会不断的变化，最后输出一个向量。</p><figure><img src="https://suool-bolg.b0.upaiyun.com/2018/10/07/3AE7177E-8176-41EF-B7AE-54874C0E6DE8.png" alt="3AE7177E-8176-41EF-B7AE-54874C0E6DE8"><figcaption>3AE7177E-8176-41EF-B7AE-54874C0E6DE8</figcaption></figure><p>一般来说，Fully Connect Feedforward Network 的架构如下图所示，前一层每个输入都连接到下一层的所有神经元中： <img src="https://suool-bolg.b0.upaiyun.com/2018/10/07/819348CB-888B-4214-8A58-3E9E8EE9C721.png" alt="819348CB-888B-4214-8A58-3E9E8EE9"></p><p>其输入层和输出层都是一个 vector，但是其 dimension 不一定相同，其中的 hidden layer 一般有多层，这也是 Deep Learning 的 Deep 所在。</p><p>而神经网络的运算实质是矩阵运算，这也是为什么 GPU 能加速神经网络的原因所在。</p><figure><img src="https://suool-bolg.b0.upaiyun.com/2018/10/07/076D7461-22D5-4378-BED1-DA8F23AFB6B0.png" alt="076D7461-22D5-4378-BED1-DA8F23AFB6B0"><figcaption>076D7461-22D5-4378-BED1-DA8F23AFB6B0</figcaption></figure><p>##实例 以之前一直在用的手写数字识别为例，分别使用 keras 和 pytorch 搭建两个 fully connect feedforward network 模型，使用 Mnist 数据集进行训练。</p><p>首先是 keras （Using TensorFlow backend.）的代码如下:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/python3.6</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> keras.layers.core <span class="keyword">import</span> Dense, Dropout, Activation</span><br><span class="line"><span class="keyword">from</span> keras.utils <span class="keyword">import</span> np_utils</span><br><span class="line"><span class="keyword">from</span> keras <span class="keyword">import</span> backend <span class="keyword">as</span> K</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多核 CPU 使用设置</span></span><br><span class="line">K.set_session(K.tf.Session(config=K.tf.ConfigProto(device_count=&#123;<span class="string">"CPU"</span>: <span class="number">8</span>&#125;,</span><br><span class="line">                inter_op_parallelism_threads=<span class="number">8</span>,</span><br><span class="line">                intra_op_parallelism_threads=<span class="number">8</span>,</span><br><span class="line">                log_device_placement=<span class="keyword">True</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># tensorboard 可视化        </span></span><br><span class="line">tbCallBack = keras.callbacks.TensorBoard(log_dir=<span class="string">'./Graph'</span>,</span><br><span class="line">                                         histogram_freq=<span class="number">1</span>,</span><br><span class="line">                                         write_graph=<span class="keyword">True</span>,</span><br><span class="line">                                         write_images=<span class="keyword">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载数据集</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_data</span><span class="params">(file_path)</span>:</span></span><br><span class="line">    f = np.load(file_path)</span><br><span class="line">    x_train, y_train = f[<span class="string">'x_train'</span>], f[<span class="string">'y_train'</span>]</span><br><span class="line">    x_test, y_test = f[<span class="string">'x_test'</span>], f[<span class="string">'y_test'</span>]</span><br><span class="line">    f.close()</span><br><span class="line">    <span class="keyword">return</span> (x_train, y_train), (x_test, y_test)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化数据</span></span><br><span class="line">(X_train, y_train), (X_test, y_test) = load_data(<span class="string">'./mnist.npz'</span>)</span><br><span class="line"></span><br><span class="line">X_train = X_train.reshape(<span class="number">60000</span>, <span class="number">784</span>)</span><br><span class="line">X_test = X_test.reshape(<span class="number">10000</span>, <span class="number">784</span>)</span><br><span class="line">X_train = X_train.astype(<span class="string">'float32'</span>)</span><br><span class="line">X_test = X_test.astype(<span class="string">'float32'</span>)</span><br><span class="line">X_train /= <span class="number">255</span></span><br><span class="line">X_test /= <span class="number">255</span></span><br><span class="line"></span><br><span class="line">nb_classes = <span class="number">10</span></span><br><span class="line"><span class="comment"># 将 label 数据转化为 one-hot，因为模型训练 loss 参数为 categorical_crossentropy</span></span><br><span class="line">Y_train = np_utils.to_categorical(y_train, nb_classes)</span><br><span class="line">Y_test = np_utils.to_categorical(y_test, nb_classes)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化一个 model</span></span><br><span class="line">model = Sequential()</span><br><span class="line"><span class="comment"># 添加第一层，输入是784维，第一层节点为 500，激活函数为 relu</span></span><br><span class="line">model.add(Dense(<span class="number">500</span>, input_shape=(<span class="number">784</span>,)))</span><br><span class="line">model.add(Activation(<span class="string">'relu'</span>))</span><br><span class="line"><span class="comment"># model.add(Dropout(0.2))</span></span><br><span class="line"><span class="comment"># 添加第二层，节点为 500，激活函数为 relu</span></span><br><span class="line">model.add(Dense(<span class="number">500</span>))</span><br><span class="line">model.add(Activation(<span class="string">'relu'</span>))</span><br><span class="line"><span class="comment"># model.add(Dropout(0.2))</span></span><br><span class="line"><span class="comment"># 添加输出层，输出 10 维，激活函数为 softmax</span></span><br><span class="line">model.add(Dense(<span class="number">10</span>))</span><br><span class="line">model.add(Activation(<span class="string">'softmax'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置模型训练参数，loss 使用多类的对数损失函数，optimizer 优化器使用 adam，模型性能评估使用 accuracy</span></span><br><span class="line">model.compile(loss=<span class="string">'categorical_crossentropy'</span>, optimizer=<span class="string">'adam'</span>, metrics=[<span class="string">'accuracy'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开始训练，batch_size为100， 10 个 epoch，callbacks调用 tensorboard</span></span><br><span class="line">model.fit(X_train, Y_train,</span><br><span class="line">          batch_size=<span class="number">100</span>, epochs=<span class="number">10</span>,</span><br><span class="line">          validation_data=(X_test, Y_test),</span><br><span class="line">          callbacks=[tbCallBack]</span><br><span class="line">          )</span><br><span class="line"></span><br><span class="line">score = model.evaluate(X_test, Y_test, verbose=<span class="number">0</span>)</span><br><span class="line">print(<span class="string">'Test score:'</span>, score[<span class="number">0</span>])</span><br><span class="line">print(<span class="string">'Test accuracy:'</span>, score[<span class="number">1</span>])</span><br></pre></td></tr></table></figure><p>这是一个两层的全连接前向神经网络，训练了 10 epochs，准确率如下： <img src="https://suool-bolg.b0.upaiyun.com/2018/10/07/1F78B36F-9654-4FF3-9166-F827DD83B6B9.png" alt="1F78B36F-9654-4FF3-9166-F827DD83B6B9"></p><p>没有 GPU，纯 CPU 跑起来的不算慢，准确率达到 97.7%，其神经网络结构图如下： <img src="https://suool-bolg.b0.upaiyun.com/2018/10/07/96202340-46DD-40B4-97DB-7642D377A42D.png" alt="96202340-46DD-40B4-97DB-7642D377A42D"></p><p>pytorch 使用起来就没 keras 那么简单了，其代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">import</span> torchvision.transforms <span class="keyword">as</span> transforms</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多核 cpu 设置</span></span><br><span class="line">os.environ[<span class="string">"OMP_NUM_THREADS"</span>] = <span class="string">"8"</span></span><br><span class="line">os.environ[<span class="string">"MKL_NUM_THREADS"</span>] = <span class="string">"8"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置使用 CPU</span></span><br><span class="line">device = torch.device(<span class="string">'cpu'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数配置</span></span><br><span class="line">input_size = <span class="number">784</span></span><br><span class="line">hidden_size = <span class="number">500</span></span><br><span class="line">num_classes = <span class="number">10</span></span><br><span class="line">num_epochs = <span class="number">10</span></span><br><span class="line">batch_size = <span class="number">100</span></span><br><span class="line">learning_rate = <span class="number">0.001</span></span><br><span class="line"><span class="comment"># 1 MNIST dataset 加载图像数据</span></span><br><span class="line">train_dataset = torchvision.datasets.MNIST(root=<span class="string">'.'</span>,</span><br><span class="line">                                           train=<span class="keyword">True</span>,</span><br><span class="line">                                           transform=transforms.ToTensor(),</span><br><span class="line">                                           download=<span class="keyword">True</span>)</span><br><span class="line"></span><br><span class="line">test_dataset = torchvision.datasets.MNIST(root=<span class="string">'.'</span>,</span><br><span class="line">                                          train=<span class="keyword">False</span>,</span><br><span class="line">                                          transform=transforms.ToTensor())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 Data loader pytorch的数据加载方式，tensorflow是没有的</span></span><br><span class="line">train_loader = torch.utils.data.DataLoader(dataset=train_dataset,</span><br><span class="line">                                           batch_size=batch_size,</span><br><span class="line">                                           shuffle=<span class="keyword">True</span>)</span><br><span class="line"></span><br><span class="line">test_loader = torch.utils.data.DataLoader(dataset=test_dataset,</span><br><span class="line">                                          batch_size=batch_size,</span><br><span class="line">                                          shuffle=<span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 Fully connected neural network with one hidden layer 定义网络</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NeuralNet</span><span class="params">(nn.Module)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, input_size, hidden_size, num_classes)</span>:</span></span><br><span class="line">        super(NeuralNet, self).__init__()</span><br><span class="line">        self.fc1 = nn.Linear(input_size, hidden_size)</span><br><span class="line">        self.relu = nn.ReLU()</span><br><span class="line">        self.fc2 = nn.Linear(hidden_size, num_classes)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        out = self.fc1(x)</span><br><span class="line">        out = self.relu(out)</span><br><span class="line">        out = self.fc2(out)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model = NeuralNet(input_size, hidden_size, num_classes).to(device)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4 Loss and optimizer 定义损失和优化函数</span></span><br><span class="line">criterion = nn.CrossEntropyLoss()</span><br><span class="line">optimizer = torch.optim.Adam(model.parameters(),</span><br><span class="line">                             lr=learning_rate)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5 Train the model 训练模型</span></span><br><span class="line">total_step = len(train_loader)</span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> range(num_epochs):</span><br><span class="line">    <span class="keyword">for</span> i, (images, labels) <span class="keyword">in</span> enumerate(train_loader):  <span class="comment"># batch size的大小</span></span><br><span class="line">        <span class="comment"># Move tensors to the configured device</span></span><br><span class="line">        images = images.reshape(<span class="number">-1</span>, <span class="number">28</span>*<span class="number">28</span>).to(device)</span><br><span class="line">        labels = labels.to(device)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Forward pass 前向传播</span></span><br><span class="line">        outputs = model(images)</span><br><span class="line">        loss = criterion(outputs, labels)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Backward and optimize 后向传播</span></span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (i+<span class="number">1</span>) % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">            print(<span class="string">'Epoch [&#123;&#125;/&#123;&#125;], Step [&#123;&#125;/&#123;&#125;], Loss: &#123;:.4f&#125;'</span></span><br><span class="line">                   .format(epoch+<span class="number">1</span>, num_epochs, i+<span class="number">1</span>, total_step, loss.item()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Test the model 预测</span></span><br><span class="line"><span class="comment"># In test phase, we don't need to compute gradients (for memory efficiency)</span></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    correct = <span class="number">0</span></span><br><span class="line">    total = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> images, labels <span class="keyword">in</span> test_loader:</span><br><span class="line">        images = images.reshape(<span class="number">-1</span>, <span class="number">28</span>*<span class="number">28</span>).to(device)</span><br><span class="line">        labels = labels.to(device)</span><br><span class="line">        outputs = model(images)</span><br><span class="line">        _, predicted = torch.max(outputs.data, <span class="number">1</span>)</span><br><span class="line">        total += labels.size(<span class="number">0</span>)</span><br><span class="line">        correct += (predicted == labels).sum().item()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'Accuracy of the network on the 10000 test images: &#123;&#125; %'</span></span><br><span class="line">            .format(<span class="number">100</span> * correct / total))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save the model checkpoint</span></span><br><span class="line">torch.save(model.state_dict(), <span class="string">'model.ckpt'</span>)</span><br></pre></td></tr></table></figure><p>准确率如下: <img src="https://suool-bolg.b0.upaiyun.com/2018/10/07/4E84C574-A959-4E97-9C9F-3BB5057F954F.png" alt="4E84C574-A959-4E97-9C9F-3BB5057F954F"></p><p>总体时间上，要比 TF 的慢，从源码编译了一遍安装还是慢。。</p><p>下一篇练习 CNN 。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;引言&quot;&gt;引言&lt;/h2&gt;
&lt;p&gt;上一篇文章提到了 logistics regression 、多分类的 softmax 算法及梯度等概念，其实就可以很自然的引出深度学习了。&lt;/p&gt;
&lt;p&gt;引用WiKi的定义： &amp;gt;深度学习（deep learning）是机器学习的分支，是一种试图使用包含复杂结构或由多重非线性变换构成的多个处理层对数据进行高层抽象的算法。&lt;/p&gt;
&lt;p&gt;早在1958年就提出了 perceptron 的模型，即最简单的线性感知机模型，在当时引起了很大的轰动，甚至提出了机器可以取代人的说法，然而后来就被人质疑，现在看来线性感知机的限制显而易见。&lt;/p&gt;
&lt;p&gt;然后在20世纪80年代，根据之前 perceptron 提出了 multi-layer perceptron（又叫 Neural Network）， 这个模型和当今的深度神经网络是没有显著区别的。1986年提出了反向传播的概念，但是通常大于三层的 hidden layer 就没有效果了，神经网络学习出现了梯度消失的问题。&lt;/p&gt;
&lt;p&gt;后来在 2006年，在上述神经网络的算法模型上，取得了一些改进（RBM initialization），将之前 multi-layer perceptron 改了个名字 —— Deep Learning 重新提了出来，2009年的时候 DL 的运算开始利用 GPU，后面其在各个领域取得了一些突破性的应用进展，就火起来了。&lt;/p&gt;
&lt;p&gt;所以，深度学习并不是什么新鲜事物，只是换了个名字的稍微改进的旧模型。
    
    </summary>
    
      <category term="深度学习" scheme="https://suool.net/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="机器学习" scheme="https://suool.net/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>logistic 算法及其在手写数字识别的实践</title>
    <link href="https://suool.net/2018/09/05/logistic-mnist/"/>
    <id>https://suool.net/2018/09/05/logistic-mnist/</id>
    <published>2018-09-05T00:47:57.000Z</published>
    <updated>2018-10-29T12:53:08.400Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="引言">引言</h2><p>逻辑斯谛回归（logistic regression）是统计学习中的经典分类算法。最大熵模型是概率模型学习的一个准则，将其推广到分类问题得到最大熵模型（maximum entropy model). 逻辑斯谛回归模型与最大熵模型都是对数线性模型. <a id="more"></a></p><h2 id="逻辑斯谛回归模型">逻辑斯谛回归模型</h2><p>###sigmoid 函数 首先我们知道，线性回归的公式如下： <span class="math display">\[z = \omega_0x_0+\omega_1x_1+\omega_2x_1+\cdots+\omega_nx_n = \omega^Tx \tag{1}\]</span></p><p>其次在介绍逻辑斯谛回归模型之前，我们先引入sigmoid函数，其数学形式是： <span class="math display">\[g(x) = \frac {1}{1+e^{-x}} \tag{2}\]</span></p><p>函数曲线如下: <img src="https://suool-bolg.b0.upaiyun.com/2018/09/18/15362860576396.jpg"></p><p>从上图可以看到 sigmoid 函数是一个 s 形的曲线，它的取值在 [0, 1] 之间，在远离 0 的地方函数的值会很快接近 0/1 。在横坐标的大尺度下看，sigmoid 函数很类似阶跃函数。</p><h2 id="二项逻辑斯谛回归模型">二项逻辑斯谛回归模型</h2><p>一个机器学习的模型，实际上是把决策函数限定在某一组条件下，这组限定条件就决定了模型的假设空间。当然，我们还希望这组限定条件简单而合理。而逻辑回归模型所做的假设是：</p><p><span class="math display">\[h_\omega(x)=\frac {1}{1+e^{-z}} = \frac {1}{1+e^{-\omega^T\cdot x}} \tag{3}\]</span></p><p>其中， <span class="math display">\[y = \frac {1}{1+e^{-x}}\]</span></p><p>我们可以看到，Logistic Regression 算法是将线性函数的结果映射到了sigmoid函数中。</p><p>因此，为了实现 Logistic 回归分类器，我们可以在每个特征上都乘以一个回归系数（如公式1所示），然后把所有结果值相加，将这个总和代入 Sigmoid 函数中，进而得到一个范围在 0~1 之间的数值。任何大于 0.5 的数据被分入 1 类，小于 0.5 即被归入 0 类。所以，Logistic 回归也是一种概率估计，比如这里Sigmoid 函数得出的值为0.5，可以理解为给定数据和参数，数据被分入 1 类的概率为0.5。</p><p>模型的条件概率分布函数的一般写法如下 <span class="math display">\[P(Y=1\mid x;\omega) = h_\omega(x) \tag{4}\]</span> 及 <span class="math display">\[P(Y=0 \mid x;\omega) = 1-h_\omega(x) \tag{5}\]</span></p><p>其中 <span class="math inline">\(w = (w^1,w^2, \cdots, w^n, b)^T\)</span> 为权值向量, <span class="math inline">\(x=(x^1, x^2, \cdots, x^n, 1)^T\)</span> 为输入向量.</p><p>因此逻辑斯谛回归的对数几率为 <span class="math display">\[log \frac {P(Y=1\mid x)}{1-P(Y=1\mid x)} = w \cdot x \tag{6}\]</span></p><p>由此可知, 在二项逻辑斯谛回归模型中, 输出 Y=1 的对数几率是输入 x 的线性函数. 又由式(3)可知,线性函数的值越接近正无穷, 概率值就越接近1, 反之越接近0, 这样子的模型就是逻辑斯谛回归模型.</p><p>###参数求解之最大似然估计法 模型的数学形式确定后，剩下就是如何去求解模型中的参数。统计学中常用的一种方法是最大似然估计，即找到一组参数，使得在这组参数下，我们的数据的似然度（概率）越大.</p><p>首先通过式(4)及(5)确定的概率函数为： <span class="math display">\[P(y\mid x;\omega) = (h_\omega(x))^y\cdot (1-h_\omega(x))^{1-y}\]</span></p><p>因为样本数据相互独立，所以他们的联合分布可以表示为各边际分布的乘积，取似然函数为： <span class="math display">\[\begin{align}L(\omega) &amp;= \prod_{i=1}^n P(y^i \mid x^i; \omega) \\&amp; = \prod_{i=1}^n (h_\omega(x^i))^{y^i}\cdot (1-h_\omega(x^i))^{1-y^i}\end{align}\]</span></p><p>取对数似然函数： <span class="math display">\[l(\omega)= \log(L(\omega)) = \sum_{i=1}^m\log((h_\omega(x^i))^{y^i})+\log((1-h_\omega(x^i))^{1-y^i})\]</span></p><p>最大似然估计就是要求使得<span class="math inline">\(l(\omega)\)</span>取最大值时候的<span class="math inline">\(\omega\)</span>，这里可以用显然可以用梯度上升法求解，同时，如果稍微做下变换： <span class="math display">\[J(\omega) = - \frac{1}{n}l(\omega)\]</span></p><p>因为乘了一个负的系数,然后就可以使用梯度下降算法进行求解了.</p><p>###梯度上升算法 梯度上升算法的基本思想是:要找到某个函数的最大值, 最好的方法是沿着该函数的梯度方向探寻. 如果梯度记为 <span class="math inline">\(\nabla\)</span>, 那么函数 <span class="math inline">\(f(x,y)\)</span>的梯度表示为: <span class="math display">\[\nabla f(x,y) = \begin{pmatrix}  \frac{\partial f(x,y)}{\partial x} \\\frac{\partial f(x,y)}{\partial y} \end{pmatrix} \]</span></p><p>梯度上升算法的描述公式为: <span class="math display">\[w:=w+\alpha \nabla f(w)\]</span></p><p>梯度下降算法的描述公式: <span class="math display">\[w:=w-\alpha \nabla f(w)\]</span></p><p>这个梯度意味着要沿 x 的方向移动 <span class="math inline">\(\frac{\partial f(x,y)}{\partial x}\)</span> ，沿 y 的方向移动 <span class="math inline">\(\frac{\partial f(x,y)}{\partial y}\)</span> 。其中，函数<span class="math inline">\(f(x, y)\)</span>必须要在待计算的点上有定义并且可微。</p><p>梯度上升的一个示意图 <img src="https://suool-bolg.b0.upaiyun.com/2018/09/18/LR_8.png" alt="LR_8"></p><p>步长，记作 α , <span class="math inline">\(\nabla f(w)\)</span> 表示沿着梯度变化的方向</p><p>这个算法将会在很大的程度上被初始点的选择影响而陷入局部最小点。</p><h3 id="简单的线性分类器">简单的线性分类器</h3><p>代码示例-暂略</p><h2 id="多项逻辑斯谛回归模型">多项逻辑斯谛回归模型</h2><p>上述的都是二分类问题, 那么如何改造 logistics 回归解决多分类问题呢?</p><p>第一种方式是直接根据每个类别，都建立一个二分类器，带有这个类别的样本标记为1，带有其他类别的样本标记为0。假如我们有 K 个类别，最后我们就得到了 K 个针对不同标记的普通的logistic分类器。</p><p>第二种方式是修改 logistic 回归的损失函数，让其适应多分类问题。这个损失函数不再笼统地只考虑二分类非1就0的损失，而是具体考虑每个样本标记的损失。这种方法叫做 softmax 回归，即 logistic 回归的多分类版本。</p><p>首先对于第一种方式, 假如给定的的数据集 <span class="math inline">\(X \in R^{m\times n}\)</span>, 他们的标记为 <span class="math inline">\(Y \in R^k\)</span>, 即是政协样本有 K 个不同的类别。</p><p>现在我们挑选出数据集中标记为 <span class="math inline">\(c(c\leq k)\)</span> 的样本，将挑选出来的样本标记为1， 其余的所有不为 c 的样本标记为0，由此训练出一个 logistics回归二分分类器， 即得到 <span class="math inline">\(h_c(x)\)</span> （表示针对标记为 c 的 logistics 分类函数）</p><p>按照上面的步骤， 我们可以得到k个不同的分类器。针对一个分类样本，我们需要找到这个k个分类函数中输出值最大的那个， 即认为是测试样本的输出标记： <span class="math display">\[\mathop{\arg\;\max}\limits_{c} h_c(x), c=1,2,\cdots,k\]</span></p><p>第二种方式是 softmax 回归</p><p><span class="math display">\[h_\theta(x^i) = \begin{bmatrix} p(y^i = 1 \mid x^i; \theta) \\ p(y^i = 2 \mid x^i; \theta) \\ \vdots \\p(y^i = k \mid x^i; \theta)\end{bmatrix} = \frac{1}{\sum_{c=1}^k e^{\theta_c^Tx^i}} \begin{bmatrix}e^{\theta_1^Tx^i} \\e^{\theta_2^Tx^i} \\\vdots \\e^{\theta_k^Tx^i}\end{bmatrix}\]</span></p><p>然后使用矩阵<span class="math inline">\(\theta\)</span>表示上式中的<span class="math inline">\(\theta_1,\cdots,\theta_k\)</span>,即是: <span class="math display">\[\theta = \begin{bmatrix}\theta_1^T \\\theta_2^T \\\vdots \\\theta_k^T \\\end{bmatrix}\]</span></p><p>Softmax回归中将 <span class="math inline">\(\textstyle x\)</span> 分类为类别 <span class="math inline">\(\textstyle j\)</span> 的概率: <span class="math display">\[p(y^i=j\mid x^i;\theta) = \frac{e^{\theta_j^T}x^i}{\sum_{l=1}^k e_l^Tx^i}\]</span></p><p>一个图解: <img src="https://suool-bolg.b0.upaiyun.com/2018/09/18/15366230049078.jpg"></p><p><img src="https://suool-bolg.b0.upaiyun.com/2018/09/18/15366242666868.jpg"></p><h3 id="损失函数">损失函数</h3><p>为了训练模型，我们需要定义一个 loss function 来描述模型对问题的分类精度。loss 越小，代表模型的分类结果与真实值的偏差越小。在多分类问题中常使用交差熵作为损失函数，交叉熵定义如下，其中y代表真实值， <span class="math inline">\(\tilde{y}\)</span> 代表预测值，n代表需要区分的类别数。</p><p><span class="math display">\[H_y(\tilde{y}) = - \sum_i^n y\log \tilde{y}\]</span></p><p>那么，为什么交叉熵可以用来判断模型对真实概率分布 估计的准确程度呢？首先补充几个知识点</p><h4 id="信息量"><strong>信息量</strong></h4><p>直觉上来说：一件事情发生的可能性越小（概率小），当这件事发生时，人们所获得信息量越大；相反，一件事极有可能发生（概率大），当这件事发生时，人们会感觉没有什么信息量，因为早知道会发生。因此信息量跟事件发生的概率有关。定义如下，其中 <span class="math inline">\(p(x_{0})\)</span> 为事件 <span class="math inline">\(x_{0}\)</span> 发生的概率，log 为自然对数。</p><p><span class="math display">\[I(x_0) = -log(p(x_0))\]</span></p><p>由于是概率所以 <span class="math inline">\(p(x_{0})\)</span> 的取值范围是 [0,1],绘制为图，可见该函数符合我们对信息量的直觉</p><p><img src="https://suool-bolg.b0.upaiyun.com/2018/09/18/15366229765258.jpg"></p><h4 id="熵">熵</h4><p>对于某个事件，有n种可能性，每种可能性有个概率值。熵用来表示所有信息量的期望, 也是随机变量不确定性的度量, 其定义如下: <span class="math display">\[H(X) = - \sum_i^n p(x_i)\log (p(x_i))\]</span></p><p>由此可见, 熵只依赖与 X 的分布,与其取值大小无关,因此熵也可以直接记做: <span class="math display">\[H(p) = - \sum_i^n p_i\log p_i\]</span></p><p>熵越大, 随机变量的不确定性越大.</p><h4 id="相对熵kl散度">相对熵（KL散度）</h4><p>对同一个问题，用P、Q同时描述，用 KL 散度来衡量两个分布的差异。 <span class="math display">\[D_{KL}(p||q)=\sum_{i}^{n}{}p(x_{i})log(\frac{p(x_{i})}{q(x_{i})})\\\]</span> 在机器学习中，P往往用来表示真实的样本分布，比如[1,0,0]表示当前样本属于第一类。Q用来表示模型所预测的分布，比如[0.7,0.2,0.1]。当然Q越接近P越好，这样就说明预测值十分逼近真实值。也就是上式的 D_{KL}的值越小越好。</p><h4 id="交差熵">交差熵</h4><p>对 <span class="math inline">\(D_{KL}(p||q)\)</span>公式进行变形：</p><p><span class="math display">\[\begin{align}D_{KL}(p||q) &amp;= \sum_{i}^{n}{p(x_{i})log(p(x_{i}))} - \sum_{i}^{n}{p(x_{i})log(q(x_{i}))} \\&amp; = -H(p(x)) + [-\sum_{i}^{n}{p(x_{i})log(q(x_{i}))}]\end{align}\]</span></p><p>等式的前一部分恰巧就是p的熵，等式的后一部分，就是交叉熵：</p><p><span class="math display">\[H(p,q) = - \sum_{i}^{n}{p(x_{i})log(q(x_{i}))}\]</span></p><p>在机器学习中，我们需要评估 labels 和 predicts 之间的差距，使用 KL 散度刚刚好，即 <span class="math inline">\(D_{KL}(y||\tilde{y})\)</span> ，由于KL散度中的前一部分−H(y)不变，故在优化过程中，只需要关注交叉熵就可以了。所以一般在机器学习中直接用用交叉熵做loss，评估模型。</p><h3 id="识别数字实践">识别数字实践</h3><p>暂略</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;引言&quot;&gt;引言&lt;/h2&gt;
&lt;p&gt;逻辑斯谛回归（logistic regression）是统计学习中的经典分类算法。最大熵模型是概率模型学习的一个准则，将其推广到分类问题得到最大熵模型（maximum entropy model). 逻辑斯谛回归模型与最大熵模型都是对数线性模型.
    
    </summary>
    
      <category term="机器学习" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="机器学习" scheme="https://suool.net/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>问题解决记录</title>
    <link href="https://suool.net/2018/07/25/problems-solved-listed/"/>
    <id>https://suool.net/2018/07/25/problems-solved-listed/</id>
    <published>2018-07-25T14:57:12.000Z</published>
    <updated>2018-12-14T14:54:16.879Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="系统问题">系统问题</h2><h3 id="docker">Docker</h3><p><strong>1.Ubuntu 下安装 <code>docker</code> 使用非 <code>sudo</code> 命令的问题</strong>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.38/images/json: dial unix /var/run/docker.sock: connect: permission denied</span><br></pre></td></tr></table></figure><p>解决方法： &gt;the error message tells you that your current user can’t access the docker engine, because you’re lacking permissions to access the unix socket to communicate with the engine. <strong>Temporary solution</strong> Use the <code>sudo</code> command to execute the commands with elevated permissions every time. <strong>Permanent (suggested) solution</strong> Add the current user to the docker group. This can be achieved by typing <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo usermod -<span class="selector-tag">a</span> -G docker <span class="variable">$USER</span></span><br></pre></td></tr></table></figure></p><p><strong>You have to log out and log in again</strong> for the group membership to take effect.</p><a id="more"></a><p><strong>2.Docker 换源</strong></p><p>新版的 <code>Docker</code> 使用 <code>/etc/docker/daemon.json（Linux）</code> 或者 <code>%programdata%\docker\config\daemon.json（Windows）</code> 来配置 Daemon 。</p><p>请在该配置文件中加入（没有该文件的话，请先建一个）：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"registry-mirrors"</span>: [<span class="string">"https://docker.mirrors.ustc.edu.cn"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>完成上述配置后，执行如下命令即可：</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo<span class="keyword"> system</span>ctl daemon-reload</span><br><span class="line">sudo<span class="keyword"> system</span>ctl restart docker</span><br></pre></td></tr></table></figure><h3 id="替换及重置homebrew默认源">替换及重置Homebrew默认源</h3><p>替换 <code>brew.git</code>:</p><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">cd </span><span class="string">"$(brew --repo)"</span></span><br><span class="line"><span class="string">git </span><span class="string">remote </span><span class="built_in">set-url</span> <span class="string">origin </span><span class="string">https:</span>//<span class="string">mirrors.</span><span class="string">ustc.</span><span class="string">edu.</span><span class="string">cn/</span><span class="string">brew.</span><span class="string">git</span></span><br></pre></td></tr></table></figure><p>替换 <code>homebrew-core.git</code>:</p><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">cd </span><span class="string">"$(brew --repo)/Library/Taps/homebrew/homebrew-core"</span></span><br><span class="line"><span class="string">git </span><span class="string">remote </span><span class="built_in">set-url</span> <span class="string">origin </span><span class="string">https:</span>//<span class="string">mirrors.</span><span class="string">ustc.</span><span class="string">edu.</span><span class="string">cn/</span><span class="string">homebrew-core.</span><span class="string">git</span></span><br></pre></td></tr></table></figure><p>替换 <code>Homebrew Bottles</code> 源: 参考:<a href="https://lug.ustc.edu.cn/wiki/mirrors/help/homebrew-bottles" target="_blank" rel="noopener">替换 Homebrew Bottles 源</a></p><p>在中科大源失效或宕机时可以： 1. <a href="https://mirrors.tuna.tsinghua.edu.cn/help/homebrew/" target="_blank" rel="noopener">使用清华源设置参考</a>。 2. 切换回官方源：</p><p>重置 <code>brew.git</code>:</p><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">cd </span><span class="string">"$(brew --repo)"</span></span><br><span class="line"><span class="string">git </span><span class="string">remote </span><span class="built_in">set-url</span> <span class="string">origin </span><span class="string">https:</span>//<span class="string">github.</span><span class="string">com/</span><span class="string">Homebrew/</span><span class="string">brew.</span><span class="string">git</span></span><br></pre></td></tr></table></figure><p>重置 <code>homebrew-core.git</code>:</p><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">cd </span><span class="string">"$(brew --repo)/Library/Taps/homebrew/homebrew-core"</span></span><br><span class="line"><span class="string">git </span><span class="string">remote </span><span class="built_in">set-url</span> <span class="string">origin </span><span class="string">https:</span>//<span class="string">github.</span><span class="string">com/</span><span class="string">Homebrew/</span><span class="string">homebrew-core.</span><span class="string">git</span></span><br></pre></td></tr></table></figure><p>注释掉bash配置文件里的有关Homebrew Bottles即可恢复官方源。 重启bash或让bash重读配置文件。</p><h3 id="xcode-高亮和提示失效">Xcode 高亮和提示失效</h3><p>Xcode 在长时间运行之后，会出现一个问题，那就是 例如 return 不再高亮显示了。 重启Xcode 重启机器 也不能解决和个问题。 后来找了一些资料 解决了这个问题</p><ol type="1"><li>由于 DerivedData 问题<ul><li>关闭项目，Xcode 设置，选择 Localtions 点击 Derived Data 的的箭头进入 DerivedData 目录</li><li>直接进入 /Users/jingwenzheng/Library/Developer/Xcode/DerivedData 目录，删除这里面所有的文件</li><li>重启Xcode</li></ul></li><li>由于 pch 文件的问题<ul><li>把.pch里的内容全部注释掉，clean掉项目里的内容，把.pch里的注释去掉，编译。代码高亮，语法提示功能都回来了。</li></ul></li></ol><h3 id="mac-oslinux命令查询网络端口占用情况">Mac OS/Linux命令查询网络端口占用情况</h3><p><strong>netstat命令</strong></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -<span class="keyword">an</span> | <span class="keyword">grep</span> <span class="symbol">&lt;port&gt;</span></span><br></pre></td></tr></table></figure><p><strong>lsof命令</strong> 通过list open file命令可以查看到当前打开文件，在linux中所有事物都是以文件形式存在，包括网络连接及硬件设备。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -<span class="selector-tag">i</span>:<span class="number">80</span></span><br></pre></td></tr></table></figure><p>-i参数表示网络链接，:80指明端口号，该命令会同时列出PID，方便kill</p><p>查看所有进程监听的端口</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo lsof -i -P <span class="string">| grep -i "</span>listen<span class="string">"</span></span><br></pre></td></tr></table></figure><h2 id="vscode">VSCode</h2><p><a href="https://segmentfault.com/a/1190000012322533" target="_blank" rel="noopener">mac vscode Python配置</a> <a href="https://blog.csdn.net/ever_now_future/article/details/79075581" target="_blank" rel="noopener">使用vs(visual studio code)写python代码遇到的import requests失败问题</a> ## TensorFlow <a href="https://www.jianshu.com/p/1d305ac47d61" target="_blank" rel="noopener">源码编译安装TensorFlow</a> <a href="http://nooverfit.com/wp/tensorflow%E5%A6%82%E4%BD%95%E5%85%85%E5%88%86%E4%BD%BF%E7%94%A8%E6%89%80%E6%9C%89cpu%E6%A0%B8%E6%95%B0%EF%BC%8C%E6%8F%90%E9%AB%98tensorflow%E7%9A%84cpu%E4%BD%BF%E7%94%A8%E7%8E%87%EF%BC%8C%E4%BB%A5/" target="_blank" rel="noopener">TensorFlow如何充分使用所有CPU核数，提高TensorFlow的CPU使用率，以及Intel的MKL加速</a> <a href="https://blog.csdn.net/rockingdingo/article/details/55652662" target="_blank" rel="noopener">Tensorflow并行计算：多核(multicore)，多线程(multi-thread)，图分割(Graph Partition)</a></p><h2 id="dl">DL</h2><h3 id="jupyter">Jupyter</h3><ol type="1"><li>Jupyter python3 notebook cannot recognize pandas in jupyter notebook: <code>!pip install pandas</code></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;系统问题&quot;&gt;系统问题&lt;/h2&gt;
&lt;h3 id=&quot;docker&quot;&gt;Docker&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;1.Ubuntu 下安装 &lt;code&gt;docker&lt;/code&gt; 使用非 &lt;code&gt;sudo&lt;/code&gt; 命令的问题&lt;/strong&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.38/images/json: dial unix /var/run/docker.sock: connect: permission denied&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;解决方法： &amp;gt;the error message tells you that your current user can’t access the docker engine, because you’re lacking permissions to access the unix socket to communicate with the engine. &lt;strong&gt;Temporary solution&lt;/strong&gt; Use the &lt;code&gt;sudo&lt;/code&gt; command to execute the commands with elevated permissions every time. &lt;strong&gt;Permanent (suggested) solution&lt;/strong&gt; Add the current user to the docker group. This can be achieved by typing &lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo usermod -&lt;span class=&quot;selector-tag&quot;&gt;a&lt;/span&gt; -G docker &lt;span class=&quot;variable&quot;&gt;$USER&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;You have to log out and log in again&lt;/strong&gt; for the group membership to take effect.&lt;/p&gt;
    
    </summary>
    
      <category term="技术" scheme="https://suool.net/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="记录" scheme="https://suool.net/tags/%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>决策树及其在手写数字识别的实践</title>
    <link href="https://suool.net/2018/07/19/Mnist-With-Decision-Tree-ID3/"/>
    <id>https://suool.net/2018/07/19/Mnist-With-Decision-Tree-ID3/</id>
    <published>2018-07-19T02:32:03.000Z</published>
    <updated>2018-10-29T12:53:08.398Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>##引言 决策时是一种基本的分类和回归方法，现在主要讨论分类决策树。决策树模型呈树形结构，在分类问题中，表示基本特征对实例进行分类的过程，你可以认为他是一个 <code>if-then</code> 的集合，也可以认为是定义在特征空间与类空间上的条件概率分布。 <a id="more"></a></p><p>其优点是模型具有可读性，分类速度快，学习时，利用训练数据，根据损失函数最小化的原则建立决策树模型。预测的时，对新的数据利用训练建立的决策树模型来分类。</p><p>决策树学习分为三个步骤：特征选择、决策树生成和决策树的剪枝。主要的决策树生成算法有 ID3 算法、C4.5 算法、 CART 算法。</p><p>本文的大纲如下： 1. 介绍决策树模型的基本概念 2. 决策树的特征选择和学习过程 3. 以 ID3 算法为例进行手写数字识别实践</p><h2 id="决策树模型的基本概念">决策树模型的基本概念</h2><h3 id="决策树模型">决策树模型</h3><p>分类决策树是一种描述对实例进行分类的树形结构。决策树由节点和有向边组成，节点分为两类：内部结点和叶节点。内部结点表示一个特征或者属性，叶节点表示一个分类。</p><p>用决策树分类的过程类似于一系列的 <code>if-then</code> 判断，如下图的一个决策树，圆和方框分别表示内部节点和叶节点，决策分类过程是这样的：首先从顶端的根节点出发，每个内部结点都是一个特征判断，即是 <code>if-then</code> 判断，如果满足特征是一种路径，不满足特征是另一条路径。</p><p><img src="https://suool-bolg.b0.upaiyun.com/2018/07/24/D295E3E5-FD3E-4509-BBA7-D80D26317A61.png" alt="D295E3E5-FD3E-4509-BBA7-D80D26317A61"> ### 决策树学习 决策树学习，假设给定训练数据集： <span class="math display">\[D=\{(x_1,y_1),(x_2,y_2),\cdots,(x_N,y_N)\}\]</span></p><p>其中，<span class="math inline">\(x_i = (x_i^1,x_i^2,\cdots,x_i^n)\)</span> 为输入实力（特征向量），n为特征个数， <span class="math inline">\(y_i\in\{1,2,\cdots,K\}\)</span>为类标记，<span class="math inline">\(i=1,2,\cdots,N\)</span>，N 为样本容量。学习的目标是根据给定的训练数据集构建一个决策树模型，使他能够进行正确的分类。</p><p>而通过上面决策树的概念介绍，我们可以知道，决策树学习本质上是从训练数据集中归纳出一组分类规则。与训练数据集不相矛盾的决策树（即是能对训练数据进行正确分类的决策树）可能有多个，有可能一个都没有。我们需要的是一个与训练数据矛盾较小的决策树，同时有较好的泛化能力。</p><p>决策树学习的损失函数通常是正则化的极大似然函数。决策树学习的策略也自然是以损失函数为目标函数的最小化。而这是一个 NP 问题，所以一般采用启发式的方法求得一个次最优解。</p><p>决策树学习的算法通常是一个递归的选择最优特征，并根据该特征对训练数据进行分割，使得对各个子数据集有一个最好的分类的过程。</p><h2 id="特征选择">特征选择</h2><p>特征选择在于选取对训练数据具有分类能力的特征，这样可以提高决策树学习的效率，而衡量特征分类效果的函数就是信息增益函数。</p><p>###信息增益 信息增益是信息论中的概念，了解信息增益，首先要了解熵和条件熵的定义。 <img src="https://suool-bolg.b0.upaiyun.com/2018/07/24/02E0F04F-0D7E-463B-BBEC-92B7909204F8.png" alt="熵的定义"> <img src="https://suool-bolg.b0.upaiyun.com/2018/07/24/E16F35E0-799D-4CD7-8927-2CCC0BFBBC17.png" alt="条件熵"></p><p><strong>信息增益的定义</strong>：特征 A 对训练集 D 对信息增益 g(D,A)，定义为集合 D 的经验熵 H(D) 与特征 A 给定的条件下 D 的经验条件熵 H(D|A) 之差，即是： <span class="math display">\[g(D,A) = H(D)-H(D|A)\]</span></p><p><strong>信息增益算法</strong></p><ul><li>基本假设 <img src="https://suool-bolg.b0.upaiyun.com/2018/07/24/D145C82E-3CEC-40BA-BBA3-223CC39CE9AB.png" alt="基本元素定义"></li></ul><p>于是信息增益算法如下： <strong>输入</strong>：训练数据集 D 和特征 A； <strong>输出</strong>：特征 A 对训练数据集 D 的信息增益 g(D,A) <img src="https://suool-bolg.b0.upaiyun.com/2018/07/24/18A795F2-9690-479B-B780-B893C562ED4D.png" alt="算法步骤"></p><h2 id="决策树生成">决策树生成</h2><p>ID3 算法的核心是在决策树各个节点上应用信息增益准则选择特征，递归的构建决策树。具体点方法是：从根结点开始，对节点计算所有可能的特征的信息增益，选择信息增益最大的特征作为节点的特征，由该特征的不同取值建立子节点；再对子节点递归的调用以上方法，构建决策树；知道所有的特征的信心增益均很小或者没有特征可以选择为止。最后得到一个决策树，ID3 算法相当于用最大似然估计进行概率模型的选择。</p><p>###ID3 算法 <strong>输入：</strong>训练数据 D，特征集 A，阈值 <span class="math inline">\(\epsilon\)</span> <strong>输出：</strong>决策树 <img src="https://suool-bolg.b0.upaiyun.com/2018/07/24/A2008824-0C64-4C99-AB08-27B6AD708FE0.png" alt="ID3-1"> <img src="https://suool-bolg.b0.upaiyun.com/2018/07/24/5D4D317A-2635-47DC-81B5-CCF172A6BD72.png" alt="ID3-2"></p><p>ID3 算法只有树的生成，所以其生成的树很容易过拟合。</p><p>以下为该算法的代码在 Mnist 数据集上实现的准确率，86.7%，比不上 KNN 的准确度，但是速度比其快的多。</p><figure><img src="https://suool-bolg.b0.upaiyun.com/2018/07/24/8959541E-8E3F-4094-997E-C839D795ACA9.png" alt="预测准确率"><figcaption>预测准确率</figcaption></figure><p>代码如下： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> testLibrary <span class="keyword">as</span> tl</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ALL_DATA = <span class="number">60000</span></span><br><span class="line"></span><br><span class="line">total_class = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">        start_time = time.time()</span><br><span class="line">        logging.debug(<span class="string">'start %s()'</span> % func.__name__)</span><br><span class="line">        ret = func(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">        end_time = time.time()</span><br><span class="line">        logging.debug(<span class="string">'end %s(), cost %s seconds'</span> % (func.__name__,end_time-start_time))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 二值化</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binaryzation</span><span class="params">(img)</span>:</span></span><br><span class="line">    cv_img = img.astype(np.uint8)</span><br><span class="line">    cv2.threshold(cv_img,<span class="number">50</span>,<span class="number">1</span>,cv2.cv.CV_THRESH_BINARY_INV,cv_img)</span><br><span class="line">    <span class="keyword">return</span> cv_img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@log</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binaryzation_features</span><span class="params">(trainset)</span>:</span></span><br><span class="line">    features = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> img <span class="keyword">in</span> trainset:</span><br><span class="line">        img = np.reshape(img,(<span class="number">28</span>,<span class="number">28</span>))</span><br><span class="line">        cv_img = img.astype(np.uint8)</span><br><span class="line"></span><br><span class="line">        img_b = binaryzation(cv_img)</span><br><span class="line">        <span class="comment"># hog_feature = np.transpose(hog_feature)</span></span><br><span class="line">        features.append(img_b)</span><br><span class="line"></span><br><span class="line">    features = np.array(features)</span><br><span class="line">    features = np.reshape(features, (<span class="number">-1</span>, <span class="number">784</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> features</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tree</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, node_type, Class=None, feature=None)</span>:</span></span><br><span class="line">        self.node_type = node_type</span><br><span class="line">        self.dict = &#123;&#125;</span><br><span class="line">        self.Class = Class</span><br><span class="line">        self.feature = feature</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_tree</span><span class="params">(self, val, tree)</span>:</span></span><br><span class="line">        self.dict[val] = tree</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self, features)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.node_type == <span class="string">'leaf'</span>:</span><br><span class="line">            <span class="keyword">return</span> self.Class</span><br><span class="line"></span><br><span class="line">        tree = self.dict[features[self.feature]]</span><br><span class="line">        <span class="keyword">return</span> tree.predict(features)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_ent</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">        calculate shanno ent of x</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    x_value_list = set([x[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(x.shape[<span class="number">0</span>])])</span><br><span class="line">    ent = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> x_value <span class="keyword">in</span> x_value_list:</span><br><span class="line">        p = float(x[x == x_value].shape[<span class="number">0</span>]) / x.shape[<span class="number">0</span>]</span><br><span class="line">        logp = np.log2(p)</span><br><span class="line">        ent -= p * logp</span><br><span class="line">    <span class="keyword">return</span> ent</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_condition_ent</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">        calculate ent H(y|x)</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># calc ent(y|x)</span></span><br><span class="line">    x_value_list = set([x[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(x.shape[<span class="number">0</span>])])</span><br><span class="line">    ent = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> x_value <span class="keyword">in</span> x_value_list:</span><br><span class="line">        sub_y = y[x == x_value]</span><br><span class="line">        temp_ent = calc_ent(sub_y)</span><br><span class="line">        ent += (float(sub_y.shape[<span class="number">0</span>]) / y.shape[<span class="number">0</span>]) * temp_ent</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ent</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># def calc_ent_grap(x,y):</span></span><br><span class="line"><span class="comment">#     """</span></span><br><span class="line"><span class="comment">#         calculate ent grap</span></span><br><span class="line"><span class="comment">#     """</span></span><br><span class="line"><span class="comment">#     base_ent = calc_ent(y)</span></span><br><span class="line"><span class="comment">#     condition_ent = calc_condition_ent(x, y)</span></span><br><span class="line"><span class="comment">#     ent_grap = base_ent - condition_ent</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     return ent_grap</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recurse_train</span><span class="params">(train_set, train_label, features, epsilon)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> total_class</span><br><span class="line"></span><br><span class="line">    LEAF = <span class="string">'leaf'</span></span><br><span class="line">    INTERNAL = <span class="string">'internal'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 步骤1——如果train_set中的所有实例都属于同一类Ck</span></span><br><span class="line">    label_set = set(train_label)</span><br><span class="line">    <span class="keyword">if</span> len(label_set) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> Tree(LEAF, Class=label_set.pop())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 步骤2——如果features为空</span></span><br><span class="line">    (max_class, max_len) = max([(i, len([x <span class="keyword">for</span> x <span class="keyword">in</span> train_label <span class="keyword">if</span> x == i])) <span class="keyword">for</span> i <span class="keyword">in</span> range(total_class)],key = <span class="keyword">lambda</span> x:x[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(features) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> Tree(LEAF, Class=max_class)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 步骤3——计算信息增益</span></span><br><span class="line">    max_feature = <span class="number">0</span></span><br><span class="line">    max_gda = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    d = train_label</span><br><span class="line">    hd = calc_ent(d)</span><br><span class="line">    <span class="keyword">for</span> feature <span class="keyword">in</span> features:</span><br><span class="line">        A = np.array(train_set[:, feature].flat)</span><br><span class="line">        gda = hd - calc_condition_ent(A, d)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> gda &gt; max_gda:</span><br><span class="line">            max_gda, max_feature = gda, feature</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 步骤4——小于阈值</span></span><br><span class="line">    <span class="keyword">if</span> max_gda &lt; epsilon:</span><br><span class="line">        <span class="keyword">return</span> Tree(LEAF, Class=max_class)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 步骤5——构建非空子集</span></span><br><span class="line">    sub_features = [x <span class="keyword">for</span> x <span class="keyword">in</span> features <span class="keyword">if</span> x != max_feature]</span><br><span class="line">    tree = Tree(INTERNAL, feature=max_feature)</span><br><span class="line"></span><br><span class="line">    feature_col = np.array(train_set[:, max_feature].flat)</span><br><span class="line">    feature_value_list = set([feature_col[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(feature_col.shape[<span class="number">0</span>])])</span><br><span class="line">    <span class="keyword">for</span> feature_value <span class="keyword">in</span> feature_value_list:</span><br><span class="line"></span><br><span class="line">        index = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(train_label)):</span><br><span class="line">            <span class="keyword">if</span> train_set[i][max_feature] == feature_value:</span><br><span class="line">                index.append(i)</span><br><span class="line"></span><br><span class="line">        sub_train_set = train_set[index]</span><br><span class="line">        sub_train_label = train_label[index]</span><br><span class="line"></span><br><span class="line">        sub_tree = recurse_train(sub_train_set,sub_train_label,sub_features,epsilon)</span><br><span class="line">        tree.add_tree(feature_value,sub_tree)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tree</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@log</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">train</span><span class="params">(train_set, train_label, features, epsilon)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> recurse_train(train_set, train_label, features, epsilon)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@log</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(test_set, tree)</span>:</span></span><br><span class="line"></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> features <span class="keyword">in</span> test_set:</span><br><span class="line">        tmp_predict = tree.predict(features)</span><br><span class="line">        result.append(tmp_predict)</span><br><span class="line">    <span class="keyword">return</span> np.array(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_accuracy</span><span class="params">(predict_ary, test)</span>:</span></span><br><span class="line">    right_count = <span class="number">0.0</span></span><br><span class="line">    accuracy_ary = []</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(len(predict_ary)):</span><br><span class="line">        <span class="keyword">if</span> predict_ary[index] == test[index]:</span><br><span class="line">            right_count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> (index + <span class="number">1</span>) % <span class="number">500</span> == <span class="number">0</span>:</span><br><span class="line">                accuracy_ary.append(float(right_count) / (index + <span class="number">1</span>))</span><br><span class="line">        print(<span class="string">"预测值：%d 实际值： %d"</span> % (predict_ary[index], test[index]))</span><br><span class="line">    <span class="keyword">return</span> right_count/len(test), accuracy_ary</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    logger = logging.getLogger()</span><br><span class="line">    logger.setLevel(logging.DEBUG)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取训练数据集和测试数据集的方法和朴素贝叶斯方法一致</span></span><br><span class="line">    print(<span class="string">'Start read train data'</span>)</span><br><span class="line">    time_1 = time.time()</span><br><span class="line">    data_map, labels = tl.loadCSVfile(<span class="string">"data.csv"</span>)</span><br><span class="line">    print(data_map.shape, labels.shape)</span><br><span class="line">    time_2 = time.time()</span><br><span class="line">    print(<span class="string">'read data train cost '</span>, time_2 - time_1, <span class="string">' seconds'</span>, <span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'Start read predict data'</span>)</span><br><span class="line">    time_3 = time.time()</span><br><span class="line">    test_data_map, test_labels = tl.loadCSVfile(<span class="string">"dataTest.csv"</span>)</span><br><span class="line">    print(test_data_map.shape, test_data_map.shape)</span><br><span class="line">    time_4 = time.time()</span><br><span class="line">    print(<span class="string">'read predict data cost '</span>, time_4 - time_3, <span class="string">' seconds'</span>, <span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">    tree = train(data_map, labels, [i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">784</span>)], <span class="number">0.1</span>)</span><br><span class="line">    test_predict = predict(test_data_map, tree)</span><br><span class="line"></span><br><span class="line">    rate, accuracy = calculate_accuracy(test_predict, test_labels)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"The accuracy score is "</span>, rate)</span><br><span class="line">    new_ticks = np.linspace(<span class="number">1</span>, <span class="number">20</span>, <span class="number">20</span>)</span><br><span class="line">    plt.xticks(new_ticks)</span><br><span class="line">    plt.ylim(ymin=<span class="number">0.7</span>, ymax=<span class="number">1</span>)</span><br><span class="line">    plt.plot(new_ticks, accuracy, <span class="string">'o-'</span>, color=<span class="string">'g'</span>)</span><br><span class="line">    plt.xlabel(<span class="string">"x -- 1:500"</span>)</span><br><span class="line">    plt.ylabel(<span class="string">"y"</span>)</span><br><span class="line">    plt.title(<span class="string">u"预测准确率"</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;##引言 决策时是一种基本的分类和回归方法，现在主要讨论分类决策树。决策树模型呈树形结构，在分类问题中，表示基本特征对实例进行分类的过程，你可以认为他是一个 &lt;code&gt;if-then&lt;/code&gt; 的集合，也可以认为是定义在特征空间与类空间上的条件概率分布。
    
    </summary>
    
      <category term="机器学习" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="机器学习" scheme="https://suool.net/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>K 近邻法及其在手写数字识别的实践</title>
    <link href="https://suool.net/2018/07/10/Mnist-With-K-Nearest-Neighbor/"/>
    <id>https://suool.net/2018/07/10/Mnist-With-K-Nearest-Neighbor/</id>
    <published>2018-07-10T09:09:08.000Z</published>
    <updated>2018-10-29T12:53:08.398Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="引言">引言</h2><p>k 近邻法（k-nearest-neighbor, KNN）是一种基本的分类和回归方法。现在只讨论其分类方面的应用，它不具备明显的学习过程，实际上是利用已知的训练数据集对输入特征向量空间进行划分，并作为其分类的“模型”。 <a id="more"></a></p><p>其中 k 值的选择、距离的度量及分类决策规则是 k 近邻模型的三个基本要素。</p><p>本文将按照以下提纲进行： - k 近邻法阐述 - k 近邻的模型 - k 近邻在手写数字识别上的实战</p><h2 id="k-近邻法阐述">k 近邻法阐述</h2><p>k 近邻算法非常容易理解，因为其本质上就是求距离，这是非常简单而直观的度量方法：对于给定的一个训练数据集，对新的输入实例 M，在训练数据集中找到与该新实例 M 最邻近的 k 个实例，由这 k 个实例按照一定的表决规则进行投票决策最合适的类别，那么实例 M 就属于这个类。下面是算法的描述： <img src="https://suool-bolg.b0.upaiyun.com/2018/07/10/CC3A072A-F73B-4A54-A6F9-94EF80316B66.png" alt="CC3A072A-F73B-4A54-A6F9-94EF80316B66"></p><h2 id="k-近邻模型">k 近邻模型</h2><p>k 近邻算法本质上是在超空间内划分区域空间分类的问题，在输入数据集的特征空间内，对于每个训练实例点 <span class="math inline">\(x_i\)</span> ，距离改点比其他点更近的所有点组成一个区域，叫做单元(cell)。上文说了 k 近邻模型的三个要素，k 值选择、距离度量、决策函数，下面一一说明。</p><h3 id="k-值选择">k 值选择</h3><p>k 值指的是选择近邻点的数目，如果 k = 1 则是最近邻，即是每次由距离新实例最近的训练点所属的类别决定待分类实例的类别。</p><p>k 值的选择对于 k 近邻法的结果可以产生重大影响。</p><p>当 k 值较小的时候，那么预测学习的近似误差会减少，因为此时只有距离待分类点较近的训练实例才会对于分类预测结果有影响作用，但是缺点是估计误差会增大，因为预测结果会对近邻的实例点非常敏感，如果近邻的实例多数都是噪声点，那么就很容易导致预测出错。即是说，k 值的减少意味着模型变得复杂，容易发生过拟合。</p><p>当 k 值较大的时候，就相当于用较大邻域中的训练实例进行预测。其优点是可以减少学习的估计误差。但缺点是学习的近似误差会增大，这时与输入实例较远的（不相似的）训练实例也会对预测起作用，使预测发生错误。k 值的增大就意味着整体的模型变得简单。</p><p>如果 k = N，那么无论输入实例是什么，都将简单地预测它属于在训练实例中最多的类。这时，模型过于简单，完全忽略训练实例中的大量有用信息，是不可取的。</p><p>在应用中，k 值一般取一个比较小的数值。通常采用交叉验证法来选取最优的 k 值。</p><h3 id="距离度量">距离度量</h3><p>在实数域中，数的大小和两个数之间的距离是通过绝对值来度量的。在解析几何中，向量的大小和两个向量之差的大小是“长度”和“距离”的概念来度量的。为了对矩阵运算进行数值分析，我们需要对向量 和矩阵的“大小”引进某种度量。而范数是绝对值概念的自然推广。</p><p>特征空间中两个实例点的距离是其相似程度的反映，k 近邻空间选用欧式距离及更一般的 <span class="math inline">\(L_p\)</span> 距离。</p><p>设特征空间 X 是 n 维实数向量空间 <span class="math inline">\(R^n\)</span>，<span class="math inline">\(x_i,x_j \in \mathcal{X}, x_i = (x_i^1,x_i^2,\cdots,x_i^n), x_j = (x_j^1,x_j^2,\cdots,x_j^n)\)</span>，则 <span class="math inline">\(x_i, x_j\)</span> 的<span class="math inline">\(L_p\)</span>距离定义为: <span class="math display">\[L_p(x_i,x_j) =  \left(\sum_{l=1}^n |x_i^l-x_j^l|^p\right) ^{\frac{1}{p}}\]</span></p><p>这里 p 要不小于1，当 p = 2时，成为欧氏距离； 当 p = 1 时，称为曼哈顿距离； 当 p = <span class="math inline">\(\infty\)</span> 时，它是各个坐标距离的最大值。</p><h3 id="分类决策">分类决策</h3><p>k 近邻法中的分类决策规则往往是多数投票表决，即由输入实例的 k 个邻近的训练实例中的多数类决定输入实例的类。</p><p>多数表决规则（majorityvotingrule）有如下解释：如果分类的损失函数为 0-1 损失函数，分类函数为： <span class="math display">\[f:R^n \to \{c_1,c_2,\cdots, c_K\}\]</span></p><p>那么对给定的实例 <span class="math inline">\(x\in X\)</span>，其最近邻的 k 个训练实例点构成集合 <span class="math inline">\(N_k(x\)</span>。如果涵盖<span class="math inline">\(N_k(x)\)</span>的区域的类别是，那么误分类率是： <span class="math display">\[\frac{1}{k} \sum_{x_i\in N_k(x)} I (y_i\not=c_j) = 1 - \frac{1}{k} \sum_{x_i\in N_k(x)} I (y_i = c_j)\]</span></p><p>要使误分类率最小即经验风险最小，就要使<span class="math inline">\(\sum_{x_i\in N_k(x)} I (y_i = c_j)\)</span>最大，所以多数表决规则等价于经验风险最小化。</p><p>同时多数表决可以加权表决，可以一定程度提高表决结果的准确性。</p><h2 id="k-近邻在手写数字识别上的实战">k 近邻在手写数字识别上的实战</h2><p>数据集的读取和解析和<a href="https://suool.net/2018/07/08/navie-bayes-handwriting-recognition/">朴素贝叶斯法识别手写数字</a>的原理一样，这里不再赘述。</p><p>代码实现算法上，这里先采用线性暴搜的方法，效率上明显是非常低的，耗时也比朴素贝叶斯慢的多，但是准确率却非常高，目前表决数为 k=3 的情况下且不加权的预测准确率可以达到 94% 以上。</p><p>训练预测结果如下: <img src="https://suool-bolg.b0.upaiyun.com/2018/07/10/597C98CC-BFA6-4998-9E03-A43C6BAF6620.png" alt="597C98CC-BFA6-4998-9E03-A43C6BAF6620"></p><p>可以看出，测试 2100 个图片，用了1218秒，20多分钟，效率非常慢。 <img src="https://suool-bolg.b0.upaiyun.com/2018/07/10/A535D08C-349E-46B2-8147-E59F88076FB1.png" alt="A535D08C-349E-46B2-8147-E59F88076FB1"></p><p>但是准确率异常高，且比较稳定。</p><h3 id="总结">总结</h3><ul><li><p>更高效率的 k 近邻寻找方法是 k-d树（k-dimensional树的简称），这是一种分割 k 维数据空间的数据结构，主要应用于多维空间关键数据的搜索。</p></li><li><p>可以对 k 近邻进行加权表决，对于预测准确率应该也会有所提升。</p></li></ul><h2 id="next">NEXT</h2><p>下一次将实践以上的两点总结，看看具体的表现如何吧。</p><hr><p>附KNN 算法的线性暴搜实现如下:</p><div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># -*- coding: utf-8 -*</span></a><a class="sourceLine" id="cb1-2" data-line-number="2"><span class="im">import</span> time</a><a class="sourceLine" id="cb1-3" data-line-number="3"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a><a class="sourceLine" id="cb1-4" data-line-number="4"><span class="im">import</span> testLibrary <span class="im">as</span> tl</a><a class="sourceLine" id="cb1-5" data-line-number="5"><span class="im">import</span> collections</a><a class="sourceLine" id="cb1-6" data-line-number="6"><span class="im">import</span> numpy <span class="im">as</span> np</a><a class="sourceLine" id="cb1-7" data-line-number="7"></a><a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co"># 距离计算</span></a><a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">def</span> calc_dis(train_image,test_image):</a><a class="sourceLine" id="cb1-10" data-line-number="10">    dist<span class="op">=</span>np.linalg.norm(train_image<span class="op">-</span>test_image)</a><a class="sourceLine" id="cb1-11" data-line-number="11">    <span class="cf">return</span> dist</a><a class="sourceLine" id="cb1-12" data-line-number="12"></a><a class="sourceLine" id="cb1-13" data-line-number="13"></a><a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co"># 确定待分类实例的 k 近邻</span></a><a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw">def</span> find_labels(k,train_images,train_labels,test_image):</a><a class="sourceLine" id="cb1-16" data-line-number="16">    all_dis <span class="op">=</span> []</a><a class="sourceLine" id="cb1-17" data-line-number="17">    labels<span class="op">=</span>collections.defaultdict(<span class="bu">int</span>)</a><a class="sourceLine" id="cb1-18" data-line-number="18">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(train_images)):</a><a class="sourceLine" id="cb1-19" data-line-number="19">        dis <span class="op">=</span> np.linalg.norm(train_images[i]<span class="op">-</span>test_image)</a><a class="sourceLine" id="cb1-20" data-line-number="20">        all_dis.append(dis)</a><a class="sourceLine" id="cb1-21" data-line-number="21">    sorted_dis <span class="op">=</span> np.argsort(all_dis)</a><a class="sourceLine" id="cb1-22" data-line-number="22">    count <span class="op">=</span> <span class="dv">0</span></a><a class="sourceLine" id="cb1-23" data-line-number="23">    <span class="cf">while</span> count <span class="op">&lt;</span> k:</a><a class="sourceLine" id="cb1-24" data-line-number="24">        labels[train_labels[sorted_dis[count]]]<span class="op">+=</span><span class="dv">1</span></a><a class="sourceLine" id="cb1-25" data-line-number="25">        count <span class="op">+=</span> <span class="dv">1</span></a><a class="sourceLine" id="cb1-26" data-line-number="26">    <span class="cf">return</span> labels</a><a class="sourceLine" id="cb1-27" data-line-number="27"></a><a class="sourceLine" id="cb1-28" data-line-number="28"></a><a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co"># 结合训练数据集，对所有待分类实例进行 k 近邻分类预测</span></a><a class="sourceLine" id="cb1-30" data-line-number="30"><span class="kw">def</span> knn_all(k,train_images,train_labels,test_images, test_labels):</a><a class="sourceLine" id="cb1-31" data-line-number="31">    <span class="bu">print</span>(<span class="st">&quot;start knn_all!&quot;</span>)</a><a class="sourceLine" id="cb1-32" data-line-number="32">    res<span class="op">=</span>[]</a><a class="sourceLine" id="cb1-33" data-line-number="33">    right <span class="op">=</span> <span class="dv">0</span></a><a class="sourceLine" id="cb1-34" data-line-number="34">    accuracy <span class="op">=</span> []</a><a class="sourceLine" id="cb1-35" data-line-number="35">    count<span class="op">=</span><span class="dv">0</span></a><a class="sourceLine" id="cb1-36" data-line-number="36">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2100</span>):</a><a class="sourceLine" id="cb1-37" data-line-number="37">        labels<span class="op">=</span>find_labels(k,train_images,train_labels,test_images[i])</a><a class="sourceLine" id="cb1-38" data-line-number="38">        res.append(<span class="bu">max</span>(labels))</a><a class="sourceLine" id="cb1-39" data-line-number="39">        <span class="bu">print</span>(<span class="st">&quot;Picture </span><span class="sc">%d</span><span class="st"> has been predicted! real is </span><span class="sc">%d</span><span class="st"> predicted is </span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">%</span>(count, test_labels[i], <span class="bu">max</span>(labels)))</a><a class="sourceLine" id="cb1-40" data-line-number="40">        count<span class="op">+=</span><span class="dv">1</span></a><a class="sourceLine" id="cb1-41" data-line-number="41">        <span class="cf">if</span> <span class="bu">max</span>(labels) <span class="op">==</span> test_labels[i]:</a><a class="sourceLine" id="cb1-42" data-line-number="42">            right<span class="op">+=</span><span class="dv">1</span></a><a class="sourceLine" id="cb1-43" data-line-number="43">        <span class="cf">if</span> (i<span class="op">+</span><span class="dv">1</span>) <span class="op">%</span> <span class="dv">70</span> <span class="op">==</span> <span class="dv">0</span>:</a><a class="sourceLine" id="cb1-44" data-line-number="44">            accuracy.append(<span class="bu">float</span>(right)<span class="op">/</span>(i<span class="op">+</span><span class="dv">1</span>))</a><a class="sourceLine" id="cb1-45" data-line-number="45">    <span class="cf">return</span> res, accuracy</a><a class="sourceLine" id="cb1-46" data-line-number="46"></a><a class="sourceLine" id="cb1-47" data-line-number="47"></a><a class="sourceLine" id="cb1-48" data-line-number="48"><span class="co"># 总的预测准确率计算</span></a><a class="sourceLine" id="cb1-49" data-line-number="49"><span class="kw">def</span> calc_precision(res,test_labels):</a><a class="sourceLine" id="cb1-50" data-line-number="50">    f_res_open<span class="op">=</span><span class="bu">open</span>(<span class="st">&quot;res.txt&quot;</span>,<span class="st">&quot;a+&quot;</span>)</a><a class="sourceLine" id="cb1-51" data-line-number="51">    precision<span class="op">=</span><span class="dv">0</span></a><a class="sourceLine" id="cb1-52" data-line-number="52">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(res)):</a><a class="sourceLine" id="cb1-53" data-line-number="53">        f_res_open.write(<span class="st">&quot;res:&quot;</span><span class="op">+</span><span class="bu">str</span>(res[i])<span class="op">+</span><span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a><a class="sourceLine" id="cb1-54" data-line-number="54">        f_res_open.write(<span class="st">&quot;test:&quot;</span><span class="op">+</span><span class="bu">str</span>(test_labels[i])<span class="op">+</span><span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a><a class="sourceLine" id="cb1-55" data-line-number="55">        <span class="cf">if</span> res[i]<span class="op">==</span>test_labels[i]:</a><a class="sourceLine" id="cb1-56" data-line-number="56">            precision<span class="op">+=</span><span class="dv">1</span></a><a class="sourceLine" id="cb1-57" data-line-number="57">    <span class="cf">return</span> precision<span class="op">/</span><span class="bu">len</span>(res)</a><a class="sourceLine" id="cb1-58" data-line-number="58"></a><a class="sourceLine" id="cb1-59" data-line-number="59"></a><a class="sourceLine" id="cb1-60" data-line-number="60"><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</a><a class="sourceLine" id="cb1-61" data-line-number="61">    <span class="bu">print</span>(<span class="st">&#39;Start process train data&#39;</span>)</a><a class="sourceLine" id="cb1-62" data-line-number="62">    time_0 <span class="op">=</span> time.time()</a><a class="sourceLine" id="cb1-63" data-line-number="63">    <span class="co"># tl.get_train_set()</span></a><a class="sourceLine" id="cb1-64" data-line-number="64"></a><a class="sourceLine" id="cb1-65" data-line-number="65">    <span class="bu">print</span>(<span class="st">&#39;Start process test data&#39;</span>)</a><a class="sourceLine" id="cb1-66" data-line-number="66">    time_t <span class="op">=</span> time.time()</a><a class="sourceLine" id="cb1-67" data-line-number="67">    <span class="co"># tl.get_test_set()</span></a><a class="sourceLine" id="cb1-68" data-line-number="68"></a><a class="sourceLine" id="cb1-69" data-line-number="69">    <span class="co"># 读取训练数据集和测试数据集的方法和朴素贝叶斯方法一致</span></a><a class="sourceLine" id="cb1-70" data-line-number="70">    <span class="bu">print</span> (<span class="st">&#39;Start read train data&#39;</span>)</a><a class="sourceLine" id="cb1-71" data-line-number="71">    time_1 <span class="op">=</span> time.time()</a><a class="sourceLine" id="cb1-72" data-line-number="72">    data_map, labels <span class="op">=</span> tl.loadCSVfile(<span class="st">&quot;data.csv&quot;</span>)</a><a class="sourceLine" id="cb1-73" data-line-number="73">    <span class="bu">print</span>(data_map.shape, labels.shape)</a><a class="sourceLine" id="cb1-74" data-line-number="74">    time_2 <span class="op">=</span> time.time()</a><a class="sourceLine" id="cb1-75" data-line-number="75">    <span class="bu">print</span>(<span class="st">&#39;read data train cost &#39;</span>, time_2 <span class="op">-</span> time_1, <span class="st">&#39; seconds&#39;</span>, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a><a class="sourceLine" id="cb1-76" data-line-number="76"></a><a class="sourceLine" id="cb1-77" data-line-number="77">    <span class="bu">print</span>(<span class="st">&#39;Start read predict data&#39;</span>)</a><a class="sourceLine" id="cb1-78" data-line-number="78">    time_3 <span class="op">=</span> time.time()</a><a class="sourceLine" id="cb1-79" data-line-number="79">    test_data_map, test_labels <span class="op">=</span> tl.loadCSVfile(<span class="st">&quot;dataTest.csv&quot;</span>)</a><a class="sourceLine" id="cb1-80" data-line-number="80">    <span class="bu">print</span>(test_data_map.shape, test_data_map.shape)</a><a class="sourceLine" id="cb1-81" data-line-number="81">    time_4 <span class="op">=</span> time.time()</a><a class="sourceLine" id="cb1-82" data-line-number="82">    <span class="bu">print</span>(<span class="st">&#39;read predict data cost &#39;</span>, time_4 <span class="op">-</span> time_3, <span class="st">&#39; seconds&#39;</span>, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a><a class="sourceLine" id="cb1-83" data-line-number="83"></a><a class="sourceLine" id="cb1-84" data-line-number="84">    <span class="bu">print</span>(<span class="st">&#39;Start predicting data&#39;</span>)</a><a class="sourceLine" id="cb1-85" data-line-number="85">    time_5 <span class="op">=</span> time.time()</a><a class="sourceLine" id="cb1-86" data-line-number="86">    res, accuracy <span class="op">=</span> knn_all(<span class="dv">3</span>, data_map, labels, test_data_map, test_labels)</a><a class="sourceLine" id="cb1-87" data-line-number="87">    score <span class="op">=</span> calc_precision(res, test_labels)</a><a class="sourceLine" id="cb1-88" data-line-number="88">    time_6 <span class="op">=</span> time.time()</a><a class="sourceLine" id="cb1-89" data-line-number="89">    <span class="bu">print</span>(<span class="st">&#39;read predict data cost &#39;</span>, time_6 <span class="op">-</span> time_5, <span class="st">&#39; seconds&#39;</span>, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a><a class="sourceLine" id="cb1-90" data-line-number="90"></a><a class="sourceLine" id="cb1-91" data-line-number="91">    new_ticks <span class="op">=</span> np.linspace(<span class="dv">1</span>, <span class="dv">30</span>, <span class="dv">30</span>)</a><a class="sourceLine" id="cb1-92" data-line-number="92">    plt.xticks(new_ticks)</a><a class="sourceLine" id="cb1-93" data-line-number="93">    plt.ylim(ymin<span class="op">=</span><span class="fl">0.5</span>, ymax <span class="op">=</span> <span class="dv">1</span>)</a><a class="sourceLine" id="cb1-94" data-line-number="94">    plt.plot(new_ticks, accuracy, <span class="st">&#39;o-&#39;</span>, color<span class="op">=</span><span class="st">&#39;g&#39;</span>)</a><a class="sourceLine" id="cb1-95" data-line-number="95">    plt.xlabel(<span class="st">&quot;x -- 1:70&quot;</span>)</a><a class="sourceLine" id="cb1-96" data-line-number="96">    plt.ylabel(<span class="st">&quot;y&quot;</span>)</a><a class="sourceLine" id="cb1-97" data-line-number="97">    plt.title(<span class="st">u&quot;预测准确率&quot;</span>)</a><a class="sourceLine" id="cb1-98" data-line-number="98">    plt.show()</a><a class="sourceLine" id="cb1-99" data-line-number="99"></a><a class="sourceLine" id="cb1-100" data-line-number="100">    <span class="bu">print</span>(<span class="st">&quot;The accuracy rate is &quot;</span>, score)</a><a class="sourceLine" id="cb1-101" data-line-number="101">    <span class="bu">print</span>(<span class="st">&quot;All data processing cost </span><span class="sc">%s</span><span class="st"> seconds&quot;</span> <span class="op">%</span> (time_6 <span class="op">-</span> time_0))</a></code></pre></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;引言&quot;&gt;引言&lt;/h2&gt;
&lt;p&gt;k 近邻法（k-nearest-neighbor, KNN）是一种基本的分类和回归方法。现在只讨论其分类方面的应用，它不具备明显的学习过程，实际上是利用已知的训练数据集对输入特征向量空间进行划分，并作为其分类的“模型”。
    
    </summary>
    
      <category term="机器学习" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="机器学习" scheme="https://suool.net/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>乡土中国</title>
    <link href="https://suool.net/2018/07/09/from-the-soil-first/"/>
    <id>https://suool.net/2018/07/09/from-the-soil-first/</id>
    <published>2018-07-09T08:28:07.000Z</published>
    <updated>2018-10-29T12:53:08.399Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>上个周看完了费孝通的《乡土中国》，现在摘抄一下其中的标记，后续再写相关的读后感吧。 <a id="more"></a></p><ol type="1"><li>从基层上看，中国社会是乡土性的。</li><li>农业和游牧或者工业不同，它是直接取资于土地的。种地的农民是搬不动的，因为长在土里的庄稼是他们生存的基础，伺候庄家的老农也像是半身插在土里，无法流动。</li><li>直接靠土地来谋生的人是站着在土地上的。以农为生的人，时代定居是常态，迁移是变态。除非天灾战火才有可能会使他们背井离乡，即使这样，死守在土里的可能还是较大的。</li><li>人口的不流动是从人和空间的关系上说的，从人和人在空间的排列关系上说就是孤立和隔膜。孤立和隔膜并不是以个人为单位的，而是以一处住在的集团为单位的，比如村落。</li><li>中国的农民一般是聚村而居，形成数百户人家的村落是积极普遍的；而美国等国家农民则一般是一户人家形成一个单位，因此而形成的精神文明也大不相同。</li><li>乡土社会在地方性的限制下成了生于斯、死于斯的社会，常态的生活是终老于乡。因此，中国的基层社会也就形成了这样一个特色，每个孩子都是在人家眼里看着长大的，在孩子眼里周围的人也是从小看惯的。这就形成了一个对每个人而言都充满了“熟悉”感的社会，没有陌生人的社会。</li><li>社会学里分出两种性质的社会：礼俗社会和法理社会。礼俗社会是没有具体目的，只是因为在一起生长而发生的社会，是有机的团结；法理社会是为了要完成一件任务而结合的社会，是机械的团结。</li><li>乡土社会中的规矩不是法律，规矩是“习”出来的礼俗。</li><li>乡土社会是熟人社会，因此乡土社会的人与人之间也从熟悉得到信任，但这种信任不是出于契约精神的信用，乡土社会的信用不是对契约的重视，而是发生于对一种行为的规矩熟悉到不假思索时的可靠性。</li><li>像是一株植物扎根于土地，在能在后续悠长的生存时间里，从容的摸清每个人都生活，甚至摸清“物”的生活，传统的二十四节气，以及各种农业谚语都是农人对于生存环境熟悉的经验总结。然而这些熟悉里面的认识都是个别的，不具有抽象的普遍原则，在熟悉环境中生长的人也不需要这些原则就能世代安稳的生存，因此，他们也会不去尝试追求更加抽象的笼罩万物的真理。</li><li>但是熟悉个别的事物，总结成生存经验这种生存哲学在一个陌生人的社会是无法应用的。在我们社会的急速变迁中，从乡土社会进入现代社会的过程中，我们在乡土社会中所养成的生活方式处处产生了流弊。陌生人所组成的现代社会是无法用乡土社会的习俗来应对的。于是，“土气”成了贬义词，“乡”也不再是衣锦荣归的去处了。</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;上个周看完了费孝通的《乡土中国》，现在摘抄一下其中的标记，后续再写相关的读后感吧。
    
    </summary>
    
      <category term="社会学" scheme="https://suool.net/categories/%E7%A4%BE%E4%BC%9A%E5%AD%A6/"/>
    
    
      <category term="书摘" scheme="https://suool.net/tags/%E4%B9%A6%E6%91%98/"/>
    
      <category term="思考" scheme="https://suool.net/tags/%E6%80%9D%E8%80%83/"/>
    
  </entry>
  
  <entry>
    <title>朴素贝叶斯应用之在手写数字识别的实践</title>
    <link href="https://suool.net/2018/07/08/navie-bayes-handwriting-recognition/"/>
    <id>https://suool.net/2018/07/08/navie-bayes-handwriting-recognition/</id>
    <published>2018-07-08T06:42:24.000Z</published>
    <updated>2018-10-29T12:53:08.545Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><hr><h2 id="引言">引言</h2><p>我们都见过或者用过的一个东西就是输入法的手写键盘，如下面的动图所示，那么输入法是如何识别出我们手写的字迹是什么字的呢？这是一个对人而言非常简单（前提是你写的字体不过于潦草），但是对于程序而言，可能就没有那么简单了，这次我就从一个更简单的角度来试一下，如何去识别手写的数字。 <sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top-right hint--error hint--large" data-aria-label="李航《统计学习方法》第四章">[1]</span></a></sup> <a id="more"></a> <img src="https://suool-bolg.b0.upaiyun.com/2018/07/08/handinput.gif" alt="手写输入"></p><h2 id="朴素贝叶斯">朴素贝叶斯</h2><p>我们在前面的文章中提到了<a href="https://suool.net/2018/06/21/%E4%BF%A1%E6%81%AF%E8%AE%BA%E5%92%8C%E8%B4%9D%E5%8F%B6%E6%96%AF/">贝叶斯定理</a>，公式表示如下 <span class="math display">\[P(y|x)= \frac{P(x,y)}{p(x)} = \frac {P(x|y)P(y)} {P(x)} = \frac {P(x|y)P(y)} {\sum_{y \in Y} P(x|y)P(y)}\]</span> 并从中得出了这样的结论: &gt; 贝叶斯定理可以精确的说明在已知新证据 <span class="math inline">\(x\)</span> 的情况下，我们应该改变多少关于 <span class="math inline">\(y\)</span> 的信念，这个等式中，<span class="math inline">\(P(y)\)</span> 是新证据 <span class="math inline">\(x\)</span> 出现之前我对于 <span class="math inline">\(y\)</span> 的先验信念。 <span class="math inline">\(P(x|y)\)</span> 是在 <span class="math inline">\(y\)</span> 确定的前提下，得到证据 <span class="math inline">\(x\)</span> 的可能性。 <span class="math inline">\(P(y|x)\)</span> 是在考虑新证据后我对于 <span class="math inline">\(y\)</span> 的后验信念。</p><p>而朴素贝叶斯（Naive Bayes）法是基于贝叶斯定理与特征条件独立假设的分类方法。对于给定的训练数据集，首先基于特征条件独立假设学习输入/输出的联合概率分布，然后基于学习到模型，对于新的输入 <span class="math inline">\(x\)</span> ，利用贝叶斯定理求出后验概率最大的输出 <span class="math inline">\(y\)</span> ，朴素贝叶斯法实现简单，学习和预测的效率也非常高，是一种很常用的分类方法。</p><h3 id="朴素贝叶斯法的学习与分类">朴素贝叶斯法的学习与分类</h3><p>朴素贝叶斯法如何用于分类工作呢？这里用更加数学的语言，可以表述如下： 首先设输入空间 $ R^n $ 为 n 维向量的集合，输出空间为类标记集合 <span class="math inline">\(\mathcal{Y} = \{c_1, c_2, \cdots , c_k\}\)</span>，其中输入为特征向量 <span class="math inline">\(x \in \mathcal{X}\)</span>，输出为类标记（class label） <span class="math inline">\(y \in \mathcal{Y}\)</span> .则 $ P(X, Y) $ 是 <span class="math inline">\(X\)</span> 和 <span class="math inline">\(Y\)</span> 的联合概率分布.</p><p>其次训练数据集表示为: <span class="math display">\[T = \{(x_1, y_1), (x_2, y_2), \cdots, (x_N, y_N) \}\]</span> 由 $P(X, Y) $ 独立同分布产生.</p><p>最后由朴素贝叶斯法通过上述训练数据集学习到联合概率分布 $P(X, Y) $ ，由条件概率公式可以知道只需要学习到如下的先验概率分布: <span class="math display">\[P(Y = c_k), k=1,2,\cdots, K\]</span> 以及条件概率分布： <span class="math display">\[P(X = x \mid Y = c_k) = P(X^{(1)} = x^{(1)}, \cdots, X^{(n)} = x^{(n)} \mid Y = c_k)\]</span> 二者相乘即可得到联合概率分布。</p><p>但是，事实上，从我们学到的条件概率分布的知识可以知道，$P(X = x Y = c_k) $ 是一个具有指数级数量的参数，一旦训练集稍微具有规模，那么这个概率分布都是无法估计的。而机器学习中，训练集的规模化显然是不可避免的。</p><p>那么现在我们明显已经知道通过学习上述两个概率分布，可以得到我们想要的联合概率分布，从而得到训练模型，然而其中条件概率分布计算的不可行性却让我们止步不前。</p><p>在这样一个尴尬的时候，朴素贝叶斯法站出来为我们解围了，它提出了一个非常强的假设，就是假设条件概率分布是特征条件独立的，因此朴素贝叶斯，也就朴素在这里:他的假设太强，强到改变了理论上计算的规则。</p><p>具体的，条件独立性假设是： <span class="math display">\[\begin{align}P(X = x \mid Y = c_k) &amp; = P(X^{(1)} = x^{(1)}, \cdots, X^{(n)} = x^{(n)} \mid Y = c_k) \\&amp; = \prod^{n}_{j=1}P(X^{(j)} = x^{(j)} \mid Y=c_k) \tag{1}\end{align}\]</span> 这个假设等于是说用于分类的特征在类别确定的条件下都是条件独立的，这一假设使得条件概率的计算变得异常简单，但是显然也牺牲了一定的准确率，因为一般情况下特征并不都是独立的而是有关联的。</p><p>通过上述学习到模型，就可以计算后验概率分布 <span class="math inline">\(P(Y = c_k \mid X = x)\)</span>，将后验概率最大的类别作为要预测的样本 <span class="math inline">\(x\)</span> 的输出。后验概率的计算依据贝叶斯定理进行： <span class="math display">\[P(Y = c_k \mid X = x) = \frac{P(X=x\mid Y=c_k) P(Y=c_k)}{\sum_k P(X=x\mid Y=c_k) P(Y=c_k)} \tag{2}\]</span></p><p>将 2 式代入 1 式，得到： <span class="math display">\[P(Y = c_k \mid X = x) = \frac{P(Y=c_k) \prod_{j}P(X^{(j)} = x^{(j)} \mid Y=c_k)}{\sum_k P(Y=c_k) \prod_{j}P(X^{(j)} = x^{(j)} \mid Y=c_k)}\]</span></p><p>所以，贝叶斯分类器可以表示为： <span class="math display">\[y=f(x)= \arg \max_{c_k} \frac{P(Y=c_k) \prod_{j}P(X^{(j)} = x^{(j)} \mid Y=c_k)}{\sum_k P(Y=c_k) \prod_{j}P(X^{(j)} = x^{(j)} \mid Y=c_k)}\]</span></p><p>上式因为分母对所有 <span class="math inline">\(c_k\)</span> 都是相同的，所以： <span class="math display">\[y = \arg \max_{c_k} P(Y=c_k) \prod_{j}P(X^{(j)} = x^{(j)} \mid Y=c_k)\]</span></p><p>这就是朴素贝叶斯分类器的最简形式，从这个式子可以看出来，朴素贝叶斯分类器本质上是根据先验概率及条件概率求最大化的后验概率，从而推断类别。</p><h3 id="朴素贝叶斯法的参数估计">朴素贝叶斯法的参数估计</h3><h4 id="极大似然估计"><strong>极大似然估计</strong></h4><p>在上面所说的朴素贝叶斯法中，训练学习意味着估计先验概率 <span class="math inline">\(P(Y=c_k)\)</span> 和条件概率 <span class="math inline">\(P(X^{(j)} = x^{(j)} \mid Y=c_k)\)</span>，这可以应用极大似然估计来估计相应的概率，其中先验概率的极大似然估计是：</p><p><span class="math display">\[P(Y=c_k) = \frac{\sum^{N}_{i=1} I(y_i=c_k)}{N} ，k = 1,2,\cdots,K\]</span> 设第 j 个特征 <span class="math inline">\(x^{j}\)</span> 可能的取值的集合为 <img src="https://suool-bolg.b0.upaiyun.com/2018/07/08/0EE6F321-E6D7-495F-BEDD-0CA48526F6EB.png" alt="0EE6F321-E6D7-495F-BEDD-0CA48526F6EB">，则条件概率的极大似然估计为：</p><p><span class="math display">\[P(X^{(j)} = a_{jl} \mid Y=c_k) = \frac{\sum^{N}_{i=1} I (x_i^{(j)} = a_{jl}, y_i = c_k)}{\sum^{N}_{i=1}I (y_i=c_k)} \tag{3}\]</span></p><figure><img src="https://suool-bolg.b0.upaiyun.com/2018/07/08/D5690E7F-DC11-4F6C-8842-77972CDFEBE8.png" alt="D5690E7F-DC11-4F6C-8842-77972CDFEBE8"><figcaption>D5690E7F-DC11-4F6C-8842-77972CDFEBE8</figcaption></figure><p>####<strong>贝叶斯估计</strong></p><p>因为用极大似然估计可能会出现所要估计的概率值为 0 的情况，这就会导致后续的计算出现错误，使得分类出现偏差，解决这个问题的方法就是使用贝叶斯估计，即是平滑处理估计结果，条件概率的贝叶斯估计是： <span class="math display">\[P(X^{(j)} = a_{jl} \mid Y=c_k) = \frac{\sum^{N}_{i=1} I (x_i^{(j)} = a_{jl}, y_i = c_k) + \lambda}{\sum^{N}_{i=1}I (y_i=c_k) + S_j\lambda} \tag{3}\]</span></p><p>其中 <span class="math inline">\(\lambda \geq 0\)</span>，等价于给随机变量的各个取值的频数加上一个正数 <span class="math inline">\(\lambda &gt; 0\)</span> 常取 <span class="math inline">\(\lambda = 1\)</span>，称为<strong>拉普拉斯平滑</strong>。</p><h2 id="实战朴素贝叶斯">实战朴素贝叶斯</h2><p>有了上面的基础，那么处理手写数字识别上面就变得很简单了，整个处理的步骤分为： - 图片预处理 - 图片数据化 - 模型训练 - 模型测试</p><h3 id="图片预处理">图片预处理</h3><p>这里我们取现成的 mnist 数据集 <sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top-right hint--error hint--large" data-aria-label="[THE MNIST DATABASE](http://yann.lecun.com/exdb/mnist/)">[2]</span></a></sup> ，首先数据集下载下来的是特殊格式的压缩包，其中训练集的图片包和标签包格式如下： <img src="https://suool-bolg.b0.upaiyun.com/2018/07/08/traintype.png" alt="压缩格式"></p><p>可以看出在 train-images.idx3-ubyte 中，第一个数为 32 位的整数（魔数，图片类型的数），第二个数为32位的整数（图片的个数），第三和第四个也是 32 位的整数（分别代表图片的行数和列数），接下来的都是一个字节的无符号数（即像素，值域为0~255），因此，我们只需要依次获取魔数和图片的个数，然后获取图片的长和宽，最后逐个按照图片大小的像素读取就可以得到一张张的图片内容了。标签数据集及测试数据集的的数据读取都是一样的原理。</p><p>读取训练图片集并将图片存储成图片，读取标签集的代码实现代码如下： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_image</span><span class="params">(filename)</span>:</span></span><br><span class="line">    f = open(filename, <span class="string">'rb'</span>)</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    buf = f.read()</span><br><span class="line">    f.close()</span><br><span class="line">    // 开始读取 魔数、图片数目、图片行数、列数</span><br><span class="line">    magic, images, rows, columns = struct.unpack_from(<span class="string">'&gt;IIII'</span>, buf, index)</span><br><span class="line">    index += struct.calcsize(<span class="string">'&gt;IIII'</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(images):</span><br><span class="line">        <span class="comment"># 逐个读取图片，每个图片字节数为 行数X列数</span></span><br><span class="line">        image = Image.new(<span class="string">'L'</span>, (columns, rows))</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> range(rows):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> range(columns):</span><br><span class="line">                <span class="comment"># 读取并填充图片的像素值，每个像素值为一个字节</span></span><br><span class="line">                image.putpixel((y, x), int(struct.unpack_from(<span class="string">'&gt;B'</span>, buf, index)[<span class="number">0</span>]))</span><br><span class="line">                index += struct.calcsize(<span class="string">'&gt;B'</span>)</span><br><span class="line">        print(<span class="string">'save '</span> + str(i) + <span class="string">'image'</span>)</span><br><span class="line">        image.save(<span class="string">'train/'</span> + str(i) + <span class="string">'.png'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_label</span><span class="params">(filename, saveFilename)</span>:</span></span><br><span class="line">    f = open(filename, <span class="string">'rb'</span>)</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    buf = f.read()</span><br><span class="line">    f.close()</span><br><span class="line">    <span class="comment"># 开始读取 魔数及标签数目</span></span><br><span class="line">    magic, labels = struct.unpack_from(<span class="string">'&gt;II'</span>, buf, index)</span><br><span class="line">    index += struct.calcsize(<span class="string">'&gt;II'</span>)</span><br><span class="line">    labelArr = [<span class="number">0</span>] * labels</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(labels):</span><br><span class="line">        <span class="comment"># 一个标签一个字节</span></span><br><span class="line">        labelArr[x] = int(struct.unpack_from(<span class="string">'&gt;B'</span>, buf, index)[<span class="number">0</span>])</span><br><span class="line">        index += struct.calcsize(<span class="string">'&gt;B'</span>)</span><br><span class="line">    save = open(saveFilename, <span class="string">'w'</span>)</span><br><span class="line">    save.write(<span class="string">','</span>.join([str(x) <span class="keyword">for</span> x <span class="keyword">in</span> labelArr]))</span><br><span class="line">    save.write(<span class="string">'\n'</span>)</span><br><span class="line">    save.close()</span><br><span class="line">    print(<span class="string">'save labels success'</span>)</span><br><span class="line">    <span class="keyword">return</span> labelArr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    read_image(<span class="string">'train-images.idx3-ubyte'</span>)</span><br><span class="line">    read_label(<span class="string">'train-labels.idx1-ubyte'</span>, <span class="string">'train/label.txt'</span>)</span><br></pre></td></tr></table></figure></p><p>读取到图片之后，存储的结果如下：</p><figure><img src="https://suool-bolg.b0.upaiyun.com/2018/07/08/dataprocess-1.png" alt="数据解压"><figcaption>数据解压</figcaption></figure><p>###图片数据化 为了将图片变成更易为计算机接受的形式，这里需要将图片二值化，即是只包含0和1的图片表现形式，即是下面这样的矩阵，其方法是超过一定像素值的点标记为 1，否则为 0： <img src="https://suool-bolg.b0.upaiyun.com/2018/07/08/FE2F3FF5-7847-4F83-9C62-400196BB55FF.png" alt="FE2F3FF5-7847-4F83-9C62-400196BB55FF"></p><p>可以隐约看出一个 5 的形状。</p><p>这里为了方便继续处理图片特征，将这个 28 *28 的矩阵进行 reshape 操作，将一幅图展开为行向量。因此整个训练集（）60000张图片）就变成了一个大小为 60000×784 的矩阵，之后尽量进行矩阵操作。</p><p>同时为了方便标记，将每行向量表示的数字写在最后一列，因此整个矩阵的大小为 60000×785。</p><p>并为了后续数据操作的方便，将这个矩阵存在本地的CSV文件中，代码及结果如下： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">28</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_train_set</span><span class="params">()</span>:</span></span><br><span class="line">    f = open(<span class="string">'data.csv'</span>, <span class="string">'wb'</span>)</span><br><span class="line">    category = MR.read_label(<span class="string">'train-labels.idx1-ubyte'</span>, <span class="string">'train/label.txt'</span>)</span><br><span class="line"></span><br><span class="line">    file_names = os.listdir(<span class="string">r"./train/"</span>, )</span><br><span class="line">    train_picture = np.zeros([len(file_names)<span class="number">-1</span>, N ** <span class="number">2</span> + <span class="number">1</span>])</span><br><span class="line">    <span class="comment"># 遍历文件，转为向量存储</span></span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> range(len(file_names)<span class="number">-1</span>):</span><br><span class="line">        img_num = io.imread(<span class="string">'./train/%d.png'</span> % (file))</span><br><span class="line">        rows, cols = img_num.shape</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(rows):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(cols):</span><br><span class="line">                <span class="keyword">if</span> img_num[i, j] &lt; <span class="number">100</span>:</span><br><span class="line">                    img_num[i, j] = <span class="number">0</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    img_num[i, j] = <span class="number">1</span></span><br><span class="line">        train_picture[file, <span class="number">0</span>:N ** <span class="number">2</span>] = img_num.reshape(N ** <span class="number">2</span>)</span><br><span class="line">        train_picture[file, N ** <span class="number">2</span>] = category[file]</span><br><span class="line">        print(<span class="string">"完成处理第%d张图片"</span> % (file+<span class="number">1</span>))</span><br><span class="line">    np.savetxt(f,train_picture,fmt=<span class="string">'%d'</span>,delimiter=<span class="string">','</span>, newline=<span class="string">'\n'</span>, header=<span class="string">''</span>, footer=<span class="string">''</span>)</span><br><span class="line">    f.close()</span><br><span class="line">    time_e = time.time()</span><br><span class="line">    print(<span class="string">'process data train cost '</span>, time_e - time_0, <span class="string">' seconds'</span>, <span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">return</span> train_picture</span><br></pre></td></tr></table></figure></p><p>结果为，红色框内即是该行向量的标签： <img src="https://suool-bolg.b0.upaiyun.com/2018/07/08/EAFE6D9C-EC29-4806-80D2-055FCE2CFFB5.png" alt="EAFE6D9C-EC29-4806-80D2-055FCE2CFFB5"></p><p>处理测试数据也是一样的原理。</p><h3 id="模型训练">模型训练</h3><p>从第一部分我们可以了解到，要求后验概率的本质是求在类别为 j 的条件下，样本 x 的第 i 个特征出现的条件概率的，将所有特征的概率与该类别的先验概率作连乘即得到后验概率。</p><p>因此，重点是计算类别的先验概率和在类别为 j 的条件下，样本 x 的第 i 个特征出现的条件概率，这也就是我们要训练的模型，代码如下： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Train</span><span class="params">()</span>:</span></span><br><span class="line">    conditional_probability = np.zeros((class_num, feature_len, <span class="number">2</span>))   <span class="comment"># 条件概率</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算先验概率及条件概率</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(labels)):</span><br><span class="line">        img = data_map[i, :]</span><br><span class="line">        label = labels[i]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(feature_len):</span><br><span class="line">            conditional_probability[label][j][img[j]] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将概率归到[1.1001]</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(class_num):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(feature_len):</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 经过二值化后图像只有0，1两种取值</span></span><br><span class="line">            pix_0 = conditional_probability[i][j][<span class="number">0</span>]</span><br><span class="line">            pix_1 = conditional_probability[i][j][<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 计算0，1像素点对应的条件概率</span></span><br><span class="line">            probalility_0 = (float(pix_0)/float(pix_0+pix_1))*<span class="number">1000</span> + <span class="number">1</span></span><br><span class="line">            probalility_1 = (float(pix_1)/float(pix_0+pix_1))*<span class="number">1000</span> + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            conditional_probability[i][j][<span class="number">0</span>] = probalility_0</span><br><span class="line">            conditional_probability[i][j][<span class="number">1</span>] = probalility_1</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> conditional_probability</span><br></pre></td></tr></table></figure></p><p>其中部分说明如下： - 由于 Python 浮点数精度的原因，784个浮点数联乘后结果变为 Inf，而 Python 中 int 可以无限相乘的，因此可以利用python int 数据类型的特性对先验概率与条件概率进行一些改造。</p><ul><li>先验概率： 由于先验概率分母都是 N，因此不用除于 N，直接用分子即可。</li><li>条件概率： 条件概率公式如上说明济代码所示，我们得到概率后再乘以1000000 （最小的可能性为1/784，同时需要尽量保存概率精度，这里保存到白万分之一，因此乘以1000000），将概率映射到[0,1000000]中，但是为防止出现概率值为0的情况，人为的加上1，使概率映射到[1,1000001]中。<sup id="fnref:3"><a href="#fn:3" rel="footnote"><span class="hint--top-right hint--error hint--large" data-aria-label="李航《统计学习方on实现朴素贝叶斯分类器（MNIST数据集）](https://blog.csdn.net/wds2006sdo/article/details/51967839)">[3]</span></a></sup></li></ul><h3 id="模型预测">模型预测</h3><p>模型预测的方法就是根据上面训练出来的朴素贝叶斯模型，对任一个新的样本 x ，分别计算它是类别 j 的条件下的后验概率，取最大后验概率的类别即可。</p><p>代码如下： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算概率</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_probability</span><span class="params">(img, label)</span>:</span></span><br><span class="line">    probability = int(prior_probability[label])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(img)):</span><br><span class="line">        probability *= int(conditional_probability[label][i][img[i]])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> probability</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Predict</span><span class="params">(testset, test_labels)</span>:</span></span><br><span class="line">    predict = []</span><br><span class="line">    accuracy = []</span><br><span class="line">    right = <span class="number">0</span></span><br><span class="line">    rows, cols = testset.shape</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(rows):</span><br><span class="line">        <span class="comment"># 图像二值化</span></span><br><span class="line">        img = testset[row, :]</span><br><span class="line"></span><br><span class="line">        max_label = <span class="number">0</span></span><br><span class="line">        max_probability = calculate_probability(img, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">            probability = calculate_probability(img, j)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> max_probability &lt; probability:</span><br><span class="line">                max_label = j</span><br><span class="line">                max_probability = probability</span><br><span class="line">        predict.append(max_label)</span><br><span class="line">        <span class="keyword">if</span> max_label == test_labels[row]:</span><br><span class="line">            right += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (row+<span class="number">1</span>) % <span class="number">500</span> == <span class="number">0</span>:</span><br><span class="line">            accuracy.append(float(right)/(row+<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> float(right)/len(test_labels), np.array(predict), accuracy</span><br></pre></td></tr></table></figure></p><p>整个代码运行的结果如下： <img src="https://suool-bolg.b0.upaiyun.com/2018/07/08/15310514214661.jpg" alt="-w455"> 准确率曲线如下： <img src="https://suool-bolg.b0.upaiyun.com/2018/07/08/8EAA5A09-8E40-45F3-85EC-D20F83C5C844.png" alt="8EAA5A09-8E40-45F3-85EC-D20F83C5"></p><h3 id="其他说明">其他说明</h3><ul><li>本次实验将图像展开、对单个像素独立判断，损失了图像的空间信息，而这种空间信息正是我们人眼识别图像的关键。所以最终的准确率受此影响。</li><li>测试数据的准确率为84.47%，还是非常不错的（共有10个分类，理论上随机猜测的准确率只有10%）。能使准确率达到84.15%的原因主要是：(1) MNIST数据集被预先处理过。通过上面的示例图片可以看出，MNIST中的图片较为纯净，没有噪声干扰，非常清晰。所以实验中可以直接进行二值化。(2) MNIST数据集中，图片中的数字总是在中心位置，大小合适，比较饱满。这一点保留了部分的空间信息。</li><li>本例中的二值化过程是直接将超过一定像素阀值值置1，如果采用更合理的阈值(比如取当前图片最大像素阀值为 100 )进行二值化操作，进行训练、测试过程，最终的准确率可能会提升。 <sup id="fnref:4"><a href="#fn:4" rel="footnote"><span class="hint--top-right hint--error hint--large" data-aria-label="[用朴素贝叶斯法对MNIST数据集分类](http://geyao1995.com/%E7%94%A8%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E6%B3%95%E5%AF%B9MNIST%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%86%E7%B1%BB/)">[4]</span></a></sup></li></ul><p>以上就是这次朴素贝叶斯法的理论及实战啦。</p><p>下次是 K 近邻算法在手写识别上的应用。</p><h2 id="reference">Reference</h2><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">李航《统计学习方法》第四章<a href="#fnref:1" rev="footnote"> ↩</a></span></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">2.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a href="http://yann.lecun.com/exdb/mnist/" target="_blank" rel="noopener">THE MNIST DATABASE</a><a href="#fnref:2" rev="footnote"> ↩</a></span></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">3.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">李航《统计学习方on实现朴素贝叶斯分类器（MNIST数据集）](https://blog.csdn.net/wds2006sdo/article/details/51967839)<a href="#fnref:3" rev="footnote"> ↩</a></span></li><li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">4.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a href="http://geyao1995.com/%E7%94%A8%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E6%B3%95%E5%AF%B9MNIST%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%86%E7%B1%BB/" target="_blank" rel="noopener">用朴素贝叶斯法对MNIST数据集分类</a><a href="#fnref:4" rev="footnote"> ↩</a></span></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;h2 id=&quot;引言&quot;&gt;引言&lt;/h2&gt;
&lt;p&gt;我们都见过或者用过的一个东西就是输入法的手写键盘，如下面的动图所示，那么输入法是如何识别出我们手写的字迹是什么字的呢？这是一个对人而言非常简单（前提是你写的字体不过于潦草），但是对于程序而言，可能就没有那么简单了，这次我就从一个更简单的角度来试一下，如何去识别手写的数字。 &lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;&lt;span class=&quot;hint--top-right hint--error hint--large&quot; data-aria-label=&quot;李航《统计学习方法》第四章&quot;&gt;[1]&lt;/span&gt;&lt;/a&gt;&lt;/sup&gt;
    
    </summary>
    
      <category term="机器学习" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="机器学习" scheme="https://suool.net/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>最小二乘法矩阵表示及非线性响应</title>
    <link href="https://suool.net/2018/06/26/Least-Squares-with-Matrix-Nolinear/"/>
    <id>https://suool.net/2018/06/26/Least-Squares-with-Matrix-Nolinear/</id>
    <published>2018-06-26T05:43:19.000Z</published>
    <updated>2018-10-29T12:53:08.397Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="引言">引言</h2><p>早上上班的路上读《社会心理学》里面有一段话，觉得不错，摘在这里。</p><blockquote><p><strong>我们人类总是有一种不可抑制的冲动，想要解释行为，对其归因，以使其变得次序井然．具有可预见性，使一切尽在掌握之中。</strong>你我对于类似的情境却可能表现出截然不同的反应，这是因为我们的想法不同。我们对朋友的责难做何反应，取决于我们对其所做的解释，取决于我们是把它归咎于朋友的敌意行为，还是归结于他糟糕的心情。 从某种角度来说，我们都是天生的科学家。我们解释着他人的行为，通常足够快也足够准确，以适应我们日常生活的需要。当他人的行为具有一致性而且与众不同时，我们会把其行为归因于他们的人格。例如。如果你发现一个人说话总是对人冷嘲热讽．你可能就会推断此人秉性不良，然后便设法尽量避免与他的接触。</p></blockquote><p>当然这是指更大范围内的人类心理，在对数据和模型的痴迷上，人类的欲望显然也是强烈的，人类总是想尽一切的办法打破现有的桎梏，在创造了更多的不确定性之后，期望通过对数据的把控和预测以看到更确切的未来。 <a id="more"></a> 这次我们来从矩阵和向量的角度来解释最小二乘法及非线性的模拟建模。</p><h2 id="ls-的矩阵推导">LS 的矩阵推导</h2><p>继续使用上一次的方程式并将其改写成矩阵的形式如下：</p><p><span class="math display">\[f(x_n;w_0,w_1) = w_0 + w_1x = w^Tx \tag{2.1} \]</span></p><p>代入最小二乘损失函数，得到结果为：</p><p><span class="math display">\[\begin{align}\mathcal{L} &amp;= \frac{1}{N} \sum_{n=1}^{N} \mathcal{L}_n(t_n,f(x_n;w_0,w_1 )) \\&amp;= \frac{1}{N} \sum_{n=1}^{N} (t_n-w^tx_n)^2 \tag{2.2} \\&amp; = \frac{1}{N} \sum_{n=1}^{N} (t-Xw)^T(t-Xw) \tag{2.3}\end{align}\]</span></p><p>式 2.2 到式 2.3 的证明忽略。</p><p>其中 <span class="math inline">\(X\)</span> 、<span class="math inline">\(W\)</span> 和 <span class="math inline">\(T\)</span> 为：</p><p><span class="math display">\[ X = \begin{bmatrix} x_1^T  \\ x_2^T  \\ x_3^T   \\ \vdots \\  x_n^T  \\ \end{bmatrix} =  \begin{bmatrix} 1 &amp; x_1  \\ 1 &amp;  x_2 \\ 1 &amp; x_3  \\ \vdots &amp; \vdots\\ 1 &amp; x_n  \\ \end{bmatrix} \\ w = \begin{bmatrix} w_0^T  \\ w_1^T \end{bmatrix} \quad \\ t = \begin{bmatrix} t_1^T  \\ t_2^T  \\ t_3^T   \\ \vdots \\  t_n^T  \\ \end{bmatrix}\]</span></p><p>对上述 2.3 展开，得到下面的表达式：</p><p><span class="math display">\[\begin{align}\mathcal{L} &amp;= \frac{1}{N} w^TX^TXw - \frac {2} {N}w^TX^Tt + \frac {1}{N} t^Tt \\&amp; = \frac{1}{N} (w^TX^TXw - 2 w^TX^Tt + t^Tt)\end{align}\]</span></p><p>为了得到最小值，需要得到 <span class="math inline">\(\mathcal{L}\)</span>的拐点（极小值）一致的向量<span class="math inline">\(w\)</span>的值，这里一样是求 <span class="math inline">\(\mathcal{L}\)</span> 关于 <span class="math inline">\(w\)</span> 的偏导数，并令其为 0，可以代入上述的矩阵进行求解，也可以使用一些恒等式来直接化简:</p><p><span class="math display">\[% inner array of minimum values 内层&quot;最小值&quot;数组\begin{array}{c|c}\hlinef(w) &amp; \frac {\partial f} {\partial w} \\\hlinew^Tx &amp; x \\x^t=Tw &amp; x \\w^Tw &amp; 2w \\w^TCw &amp; 2Cw \\\hline\end{array}\]</span></p><p>得到的表达式如下：</p><p><span class="math display">\[\frac {\partial \mathcal{L}} {\partial w} = \frac {2} {N} X^TXw - \frac {2} {N}X^Tt = 0 \]</span></p><p><span class="math display">\[X^Xw = X^Tt \tag{2.4}\]</span></p><p>从而得到使损失最小的<span class="math inline">\(w\)</span>值，<span class="math inline">\(\hat w\)</span> 的矩阵公式为：</p><p><span class="math display">\[\hat w = (X^TX)^{-1}X^Tt \tag{2.5}\]</span></p><p>根据此公式解出的值与上次用标量形式解出的是一样的。</p><h2 id="线性模型的非线性响应">线性模型的非线性响应</h2><p>前面我们所假设的是拟合函数是一次函数，但是可以明显的看出拟合效果并不好，所以需要往更高次的多项式延伸，假如是二次的话，那么可以表示为：</p><p><span class="math display">\[f(x;w) = w^Tx = w_0+w_1x+w_2x^2\]</span></p><p>更一般的，扩展 <span class="math inline">\(x\)</span> 的幂次到任意任意阶的多项式函数，对于一个 K 阶多项式，可以扩展数据矩阵为：</p><p><span class="math display">\[t = \begin{bmatrix} x_1^0 &amp; x_1^1 &amp; x_1^2 &amp; \cdots &amp; x_1^k \\ x_2^0 &amp; x_2^1 &amp; x_2^2 &amp; \cdots &amp; x_2^k\\ \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\x_n^0 &amp; x_n^1 &amp; x_n^2 &amp; \cdots &amp; x_n^k \\\end{bmatrix}\]</span></p><p>函数表达为更一般的形式：</p><p><span class="math display">\[f(x;w)= \sum^K_{k=0} w_kx^k\]</span></p><p>其解一样适用于式 <span class="math inline">\(2.5\)</span></p><p>可以求得其八阶线性拟合结果如下：</p><figure><img src="https://suool-bolg.b0.upaiyun.com/2018/07/03/FE170A95-A609-4B5D-AE3C-4090B7B63FA2.png" alt="FE170A95-A609-4B5D-AE3C-4090B7B63FA2"><figcaption>FE170A95-A609-4B5D-AE3C-4090B7B63FA2</figcaption></figure><p>代码如下:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x_cord = []</span><br><span class="line">y_cord = []</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">drawScatterDiagram</span><span class="params">(fileName)</span>:</span></span><br><span class="line">    fr=open(fileName)</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> fr.readlines():</span><br><span class="line">        lineArr=line.split(<span class="string">','</span>)</span><br><span class="line">        x_cord.append(float(lineArr[<span class="number">0</span>]))</span><br><span class="line">        y_cord.append(float(lineArr[<span class="number">1</span>]))</span><br><span class="line">    <span class="comment"># plt.scatter(x_cord,y_cord,s=30,c='red',marker='o', alpha=0.7,label='比赛成绩 ')</span></span><br><span class="line">    <span class="comment"># plt.xlabel("year")</span></span><br><span class="line">    <span class="comment"># plt.ylabel("time")</span></span><br><span class="line">    <span class="comment"># plt.title("result of game")</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">noLinearMoreTimesCalculate</span><span class="params">()</span>:</span></span><br><span class="line">    x_mat = np.ones((len(x_cord),<span class="number">1</span>))</span><br><span class="line">    y_mat = np.mat(y_cord).T</span><br><span class="line">    test = np.array(x_cord)</span><br><span class="line">    test = (test - <span class="number">1896</span>)/<span class="number">4.0</span>  // 数据预处理，缩小化</span><br><span class="line">    <span class="comment"># x_mat = np.mat(np.c_[x_zeros,test])</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">        x_temp = test**index</span><br><span class="line">        x_mat = np.mat(np.c_[x_mat, x_temp])</span><br><span class="line">    print(x_mat)</span><br><span class="line">    w_mat = ((x_mat.T * x_mat).I*x_mat.T*y_mat)[::<span class="number">-1</span>]</span><br><span class="line">    w_mat = w_mat.T</span><br><span class="line">    c = np.squeeze([i <span class="keyword">for</span> i <span class="keyword">in</span> w_mat])</span><br><span class="line">    print(c)</span><br><span class="line">    func = np.poly1d(c)</span><br><span class="line">    x_mLo = np.linspace(<span class="number">0</span>, <span class="number">29</span>, <span class="number">112</span>)</span><br><span class="line"></span><br><span class="line">    y_mLo = func(x_mLo)</span><br><span class="line"></span><br><span class="line">    plt.scatter(test,y_cord,s=<span class="number">30</span>,c=<span class="string">'red'</span>,marker=<span class="string">'o'</span>, alpha=<span class="number">0.7</span>,label=<span class="string">'比赛成绩 '</span>)</span><br><span class="line">    plt.xlabel(<span class="string">"year"</span>)</span><br><span class="line">    plt.ylabel(<span class="string">"time"</span>)</span><br><span class="line">    plt.title(<span class="string">"result of game"</span>)</span><br><span class="line"></span><br><span class="line">    plt.plot(x_mLo,y_mLo, c=<span class="string">"yellow"</span>,label=<span class="string">'线性拟合-8阶'</span>)</span><br><span class="line">    plt.legend(loc=<span class="string">'upper right'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    drawScatterDiagram(<span class="string">"olympic100m.txt"</span>)</span><br><span class="line">    <span class="comment"># linearCalculate()</span></span><br><span class="line">    <span class="comment"># noLinearCalculate()</span></span><br><span class="line">    noLinearMoreTimesCalculate()</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure><h2 id="过拟合与验证">过拟合与验证</h2><p>从上次的一阶线性拟合到现在的八阶拟合，从直观上看，八阶的拟合效果比一阶的明显好很多，但是我们做拟合的根本目的是为了做预测，不是纯粹为了拟合而拟合，因为理论上说，一般对于 n 个点，可以拟合 n-1 次多项式以便完全通过这些点。但是这样子的拟合结果对于预测而言可能是极其差的。</p><p>那么如何衡量呢? 和拟合是一样的思想，看模型在泛化问题时候的表现，即是在预测验证数据上的表现，如果其损失很小，那么可以认为这个模型的预测能力不错。</p><h3 id="验证数据">验证数据</h3><p>克服过拟合问题的一般方法是使用第二个数据集，即是验证集。用其来验证模型的预测性能，验证集可以是单独提供的，也可以从原始训练集中拿出来的。</p><p>从验证集计算的损失对于验证集数据的选择敏感，如果验证集非常小，那就更加困难了，而交叉验证是一个有效使用现有数据集的方法。</p><p>一般是 K 折交叉验证，当 K = N 的时候，及 K 恰好是等于数据集中的可观测数据的数量，每个观测数据依次拿出用作测试其他 N-1 个对象训练得到的模型，其又叫 留一交叉验证 （Leave-One-Out Cross Validation, LOOCV）,对于 LOOCV 的均方验证为：</p><p><span class="math display">\[\mathcal{L}^{CV} = \frac {1}{N} \sum^N_{n=1}(t_n-\hat{w}^T_{-n}x_n)^2\]</span></p><p>其中 <span class="math inline">\(\hat{w}_{-n}\)</span> 是除去第 n 个训练样例的参数估计值。</p><h3 id="应用实例及代码实现">应用实例及代码实现</h3><p>首先定义一个带噪声的函数，并用其生成 100 个随机数据点作为训练数据，生成 1000 个随机数据点作为测试数据，生成数据点的 <span class="math inline">\(x\)</span> 范围是 [-5,5], 表达式如下，其中噪声<span class="math inline">\(\mathcal {N}\)</span> 符合正态分布 <span class="math display">\[y = 5 \times x^3 - x^2 + x + 100 \times \mathcal N \\\mathcal N(x \mid \mu,\sigma^2) = \frac {1}{\sigma \sqrt {2 \pi}} \exp \{- \frac {1}{2\sigma^2}(x-\mu)^2\}\]</span></p><p>使用如上的矩阵式，对数据进行不同阶数的拟合，得到的结果如下:</p><figure><img src="https://suool-bolg.b0.upaiyun.com/2018/07/03/51A2EEB0-A96E-44EC-BFC9-10C5C196DC89.png" alt="51A2EEB0-A96E-44EC-BFC9-10C5C196D"><figcaption>51A2EEB0-A96E-44EC-BFC9-10C5C196D</figcaption></figure><p>然后，分别对比训练损失、测试损失及使用 LOOCV 方法拟合及其损失随着阶数增高而变化的曲线如下图所示:</p><figure><img src="https://suool-bolg.b0.upaiyun.com/2018/07/03/274FF482-8C88-4A58-B39D-3231ADBBFAF4.png" alt="274FF482-8C88-4A58-B39D-3231ADBBFAF4"><figcaption>274FF482-8C88-4A58-B39D-3231ADBBFAF4</figcaption></figure><p>可以从图中看出，在 3 阶的时候，测试损失和 LOOCV 损失达到最小，且 3 阶拟合之后训练损失不明显，但是测试损失明显增高，即产生了过拟合的现象。</p><p>实现代码如下:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.random.randint(<span class="number">-5000</span>,<span class="number">5000</span>, size=[<span class="number">100</span>,<span class="number">1</span>]) / <span class="number">1000.0</span></span><br><span class="line"></span><br><span class="line">t = <span class="number">5</span>*(x**<span class="number">3</span>)  - x**<span class="number">2</span> + x + <span class="number">100</span>*np.random.randn(<span class="number">100</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">testx = np.linspace(<span class="number">-5</span>,<span class="number">5</span>,<span class="number">1001</span>)</span><br><span class="line"></span><br><span class="line">testt = <span class="number">5</span>*(testx**<span class="number">3</span>) - testx**<span class="number">2</span> + testx + <span class="number">100</span>*np.random.randn(<span class="number">1001</span>, <span class="number">1</span>)</span><br><span class="line">plt.figure()</span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">plt.scatter(x, t, s=<span class="number">35</span>, c=<span class="string">"red"</span>, marker=<span class="string">'o'</span>, alpha=<span class="number">0.9</span>)</span><br><span class="line">plt.xlabel(<span class="string">"x"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"y"</span>)</span><br><span class="line">plt.title(<span class="string">"points of train"</span>)</span><br><span class="line"></span><br><span class="line">x_mat = np.ones((len(x),<span class="number">1</span>))</span><br><span class="line">y_mat = np.mat(t)</span><br><span class="line"></span><br><span class="line">color = [<span class="string">""</span>,<span class="string">""</span>,<span class="string">""</span>]</span><br><span class="line"></span><br><span class="line">degrees = np.arange(<span class="number">2</span>, <span class="number">10</span>)</span><br><span class="line">trainLoss = []</span><br><span class="line">predictLoss = []</span><br><span class="line">LOOCVLoss = []</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trainAndGetLoss</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> degree <span class="keyword">in</span> degrees:</span><br><span class="line">        <span class="keyword">global</span> x_mat</span><br><span class="line">        <span class="keyword">global</span> y_mat</span><br><span class="line">        tempX = x_mat</span><br><span class="line">        tempY = y_mat</span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">1</span>, degree):</span><br><span class="line">            x_temp = x ** index</span><br><span class="line">            tempX = np.mat(np.c_[tempX, x_temp])</span><br><span class="line">        <span class="comment"># print(tempX)</span></span><br><span class="line">        print(<span class="string">"计算"</span>)</span><br><span class="line">        print(type(tempX.T*tempX))</span><br><span class="line">        w_mat = ((tempX.T * tempX).I * tempX.T * tempY)[::<span class="number">-1</span>]</span><br><span class="line">        w_mat = w_mat.T</span><br><span class="line">        c = np.squeeze([i <span class="keyword">for</span> i <span class="keyword">in</span> w_mat])</span><br><span class="line">        print(c)</span><br><span class="line">        func = np.poly1d(c)</span><br><span class="line">        <span class="keyword">if</span> degree ==<span class="number">2</span> <span class="keyword">or</span> degree == <span class="number">3</span> <span class="keyword">or</span> degree == <span class="number">5</span> :</span><br><span class="line">            x_mLo = np.linspace(<span class="number">-5</span>, <span class="number">5</span>, <span class="number">100</span>)</span><br><span class="line">            y_mLo = func(x_mLo)</span><br><span class="line">            plt.subplot(<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">            plt.plot(x_mLo, y_mLo, linewidth=<span class="number">2</span>, c=np.random.rand(<span class="number">3</span>,), label=<span class="string">'线性拟合-%d阶'</span> % (degree - <span class="number">1</span>))</span><br><span class="line">            plt.legend(loc=<span class="string">'upper left'</span>)</span><br><span class="line">        <span class="comment">#  训练数据损失</span></span><br><span class="line">        y_train = func(x)</span><br><span class="line">        print(np.mean((y_train-t)**<span class="number">2</span>), type(y_train), len(y_train))</span><br><span class="line">        trainLoss.append(np.mean((y_train-t)**<span class="number">2</span>))</span><br><span class="line">        <span class="comment"># 预测数据损失</span></span><br><span class="line">        y_predict = func(testx)</span><br><span class="line">        print(np.mean((y_predict-testt)**<span class="number">2</span>), type(y_predict), len(y_predict))</span><br><span class="line">        predictLoss.append(np.mean((y_predict-testt)**<span class="number">2</span>))</span><br><span class="line">    plt.subplot(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">    new_ticks = np.linspace(<span class="number">1</span>, <span class="number">8</span>, <span class="number">8</span>)</span><br><span class="line">    plt.xticks(new_ticks)</span><br><span class="line">    plt.plot(new_ticks, trainLoss, <span class="string">'o-'</span>, color=<span class="string">'g'</span>)</span><br><span class="line">    plt.xlabel(<span class="string">"x"</span>)</span><br><span class="line">    plt.ylabel(<span class="string">"y"</span>)</span><br><span class="line">    plt.title(<span class="string">"训练数据损失"</span>)</span><br><span class="line"></span><br><span class="line">    plt.subplot(<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line">    plt.xticks(new_ticks)</span><br><span class="line">    plt.plot(new_ticks, predictLoss, <span class="string">'o-'</span>, color=<span class="string">'g'</span>)</span><br><span class="line">    plt.xlabel(<span class="string">"x"</span>)</span><br><span class="line">    plt.ylabel(<span class="string">"y"</span>)</span><br><span class="line">    plt.title(<span class="string">"预测数据损失"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trainLOOCVAndGetLoss</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> degree <span class="keyword">in</span> degrees:</span><br><span class="line">        trainLoocv = []</span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">100</span>):</span><br><span class="line">            <span class="comment"># 准备训练数据</span></span><br><span class="line">            index_x = (index)</span><br><span class="line">            new_x = np.delete(x, index_x)</span><br><span class="line">            new_y = np.delete(t, index_x)</span><br><span class="line">            tempX = np.ones([<span class="number">99</span>, <span class="number">1</span>])</span><br><span class="line">            tempY = np.mat(new_y).T</span><br><span class="line">            <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">1</span>, degree):</span><br><span class="line">                x_temp = new_x ** index</span><br><span class="line">                tempX = np.mat(np.c_[tempX, x_temp])</span><br><span class="line">            w_mat = ((tempX.T * tempX).I * tempX.T * tempY)[::<span class="number">-1</span>]</span><br><span class="line">            w_mat = w_mat.T</span><br><span class="line">            c = np.squeeze([i <span class="keyword">for</span> i <span class="keyword">in</span> w_mat])</span><br><span class="line">            func = np.poly1d(c)</span><br><span class="line">            <span class="keyword">if</span> index_x == <span class="number">0</span>:</span><br><span class="line">                print((func(x[index,<span class="number">0</span>])-t[index,<span class="number">0</span>])**<span class="number">2</span>)</span><br><span class="line">            trainLoocv.append((func(x[index,<span class="number">0</span>])-t[index,<span class="number">0</span>])**<span class="number">2</span>)</span><br><span class="line">        LOOCVLoss.append(np.mean(trainLoocv))</span><br><span class="line">        plt.subplot(<span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>)</span><br><span class="line">        new_ticks = np.linspace(<span class="number">1</span>, <span class="number">8</span>, <span class="number">8</span>)</span><br><span class="line">        plt.xticks(new_ticks)</span><br><span class="line">        plt.plot(new_ticks, predictLoss, <span class="string">'o-'</span>, color=<span class="string">'g'</span>)</span><br><span class="line">        plt.xlabel(<span class="string">"x"</span>)</span><br><span class="line">        plt.ylabel(<span class="string">"y"</span>)</span><br><span class="line">        plt.title(<span class="string">"LOOCV损失"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    trainAndGetLoss()</span><br><span class="line">    trainLOOCVAndGetLoss()</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure><p>## Next</p><p>下一次是真正入门啦，将之前说过的贝叶斯定理应用于机器学习，和你分享如何使用朴素的贝叶斯方法来进行简单的分类工作，比如识别手写数字，新闻素材的主题分类。（具体是挖那个主题的坑，还不知道</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;引言&quot;&gt;引言&lt;/h2&gt;
&lt;p&gt;早上上班的路上读《社会心理学》里面有一段话，觉得不错，摘在这里。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;我们人类总是有一种不可抑制的冲动，想要解释行为，对其归因，以使其变得次序井然．具有可预见性，使一切尽在掌握之中。&lt;/strong&gt;你我对于类似的情境却可能表现出截然不同的反应，这是因为我们的想法不同。我们对朋友的责难做何反应，取决于我们对其所做的解释，取决于我们是把它归咎于朋友的敌意行为，还是归结于他糟糕的心情。 从某种角度来说，我们都是天生的科学家。我们解释着他人的行为，通常足够快也足够准确，以适应我们日常生活的需要。当他人的行为具有一致性而且与众不同时，我们会把其行为归因于他们的人格。例如。如果你发现一个人说话总是对人冷嘲热讽．你可能就会推断此人秉性不良，然后便设法尽量避免与他的接触。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;当然这是指更大范围内的人类心理，在对数据和模型的痴迷上，人类的欲望显然也是强烈的，人类总是想尽一切的办法打破现有的桎梏，在创造了更多的不确定性之后，期望通过对数据的把控和预测以看到更确切的未来。
    
    </summary>
    
      <category term="机器学习" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="机器学习" scheme="https://suool.net/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>最小二乘法的朴素实现</title>
    <link href="https://suool.net/2018/06/24/Least-Squares/"/>
    <id>https://suool.net/2018/06/24/Least-Squares/</id>
    <published>2018-06-24T12:23:21.000Z</published>
    <updated>2018-10-29T12:53:08.397Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="引言">引言</h2><p>最小二乘法（Least Squares Method, 简记为LS）的维基解释。</p><blockquote><p>最小二乘法（又称最小平方法）是一种数学优化技术。它通过最小化误差的平方和寻找数据的最佳函数匹配。利用最小二乘法可以简便地求得未知的数据，并使得这些求得的数据与实际数据之间误差的平方和为最小。 <sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top-right hint--error hint--large" data-aria-label="维基百科[最小二乘法](https://zh.wikipedia.org/wiki/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95)">[1]</span></a></sup></p></blockquote><p>如果大学的时候学过高等数学，或许你对这个名词就不会陌生，这是下册第九章第十节的内容。 <a id="more"></a> 其表示法为</p><p><span class="math display">\[\min\sum_in(y_m^{(i)}-y^{(i)})^2 \]</span></p><p>其中 <span class="math inline">\(y_m\)</span> 表示我们拟合函数得到的拟合结果，<span class="math inline">\(y_i\)</span> 表示真实值。</p><p>    “最小二乘法”是最优化问题中建立经验公式的一种实现方法。了解它的原理，对于了解后面“Logistic回归”和“支持向量机的学习”都很有裨益。</p><p>这次就是最小二乘法的朴素实现，即是不借助矩阵、向量等，纯粹借助数学标量推导完成。</p><h2 id="起源背景">起源背景</h2><p>最小二乘法是在十九世纪的产生的，源于天文学和测地学上的应用需要。</p><p>其中高斯使用的最小二乘法的方法发表于1809年他的著作《天体运动论》中，而法国科学家勒让德于1806年独立发现“最小二乘法”，但因不为时人所知而默默无闻。两人曾为谁最早创立最小二乘法原理发生争执。<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top-right hint--error hint--large" data-aria-label="维基百科[最小二乘法](https://zh.wikipedia.org/wiki/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95)">[1]</span></a></sup></p><p>1829年，高斯提供了最小二乘法的优化效果强于其他方法的证明，即高斯-马尔可夫定理。</p><h2 id="使用及实现">使用及实现</h2><h3 id="问题引入">问题引入</h3><p>“最小二乘法”的核心就是保证所有数据偏差的平方和最小。</p><p>首先有这样一组看起来比较杂乱的数据，这组数据是 1896 到 2008 年间部分年份的男子百米赛跑最佳成绩，其散点图效果如下： <img src="https://suool-bolg.b0.upaiyun.com/2018/06/26/F8FC66C1-84BB-450C-BE96-8477C1C0C45F.png" alt="散点图"></p><p>如何于混沌中找出规律，在杂乱中确定关系，往往是我们最关心的事情，那么对于上面这样一组数据，我们就尝试对它进行建模拟合。</p><p>最简单的拟合是线性建模的拟合，即假设存在最佳的线性关系 $y=f(x;w_0,w_1)=w_0+w_1x $ 可以拟合这组数据。</p><h3 id="什么是最好">什么是最好？</h3><p>这里首先要解决的一个问题就是什么是“最佳”？或者如何衡量“最佳”？这里最佳显然是存在由一组<span class="math inline">\(w_0,w_1\)</span>确定的直线，这条直线尽可能的与所有的数据点接近，那么衡量远近即距离的最佳方法显然使用平方差，则这里可以使用下面这样一个平方差函数表示( <span class="math inline">\(x_n\)</span> 是年份，<span class="math inline">\(t_n\)</span> 是比赛成绩)： <span class="math display">\[\mathcal{L}_n =(t_n-f(x_n;w_0,w_1))^2 \]</span></p><p>这个表达式的值越小，则表示误差越小。</p><p>这里用下面的公式表示 N 年的平均损失，最小二乘损失函数 <span class="math display">\[\mathcal{L}= \frac{1}{N} \sum_{n=1}^{N} \mathcal{L}_n(t_n,f(x_n;w_0,w_1 )) \]</span></p><p>这个值显然越小越好，而其最小的关键是寻找到最合适的<span class="math inline">\(w_0, w_1\)</span>，这个数学表达式为</p><p><span class="math display">\[\mathop{\arg\;\min}\limits_{w_0, w_1} \frac{1}{N} \sum_{n=1}^{N} \mathcal{L}_n(t_n,f(x_n;w_0,w_1 ))\]</span></p><p>此时将函数关系表示为 <span class="math display">\[f(x_n;w_0,w_1) = w_0 + w_1x\]</span></p><p>代入最小二乘损失函数，得到结果为：</p><p><span class="math display">\[\begin{align}\mathcal{L} &amp;= \frac{1}{N} \sum_{n=1}^{N} \mathcal{L}_n(t_n,f(x_n;w_0,w_1 )) \\&amp; = \frac{1}{N} \sum_{n=1}^{N}(w_1^2x_n^2 + 2w_1x_n(w_0-t_n)+w_0^2-2w_0t_n+t^2)\end{align}\]</span></p><p>在上述函数 <span class="math inline">\(\mathcal {L}\)</span> 的最小值点处，其关于 <span class="math inline">\(w_0\)</span> 和 <span class="math inline">\(w_1\)</span> 的偏导数一定是 0。因此，对上函数式求偏导，使其等于 0 并对 <span class="math inline">\(w_0\)</span> 和 <span class="math inline">\(w_1\)</span> 求解，可以得到最小值。</p><h3 id="化简结果">化简结果</h3><p>关于 <span class="math inline">\(w_0\)</span> 和 <span class="math inline">\(w_1\)</span> 的表示式分别为 <span class="math display">\[\left\{ \begin{array}{c}\hat{w_0} = \overline {t} - w_1\overline {x} \\ \hat{w_1} = \frac {\overline {xt} - \overline{x} \overline{t}} {\overline{x^2}-(\overline{x})^2} \end{array}\right. \]</span></p><p>###代码实现 有了上述的表达式，直接使用代码计算得出的结果如下： <img src="https://suool-bolg.b0.upaiyun.com/2018/06/26/5C466B2C-2AF5-4469-A8F5-5325E8C7D2B5.png" alt="线性建模结果"></p><p>代码实现如下：</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-<span class="number">8</span> -*</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">import numpy as <span class="built_in">np</span></span><br><span class="line"></span><br><span class="line">x_cord = []</span><br><span class="line">y_cord = []</span><br><span class="line">def drawScatterDiagram(fileName):</span><br><span class="line">    fr=open(fileName)</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> fr.readlines():</span><br><span class="line">        lineArr=line.<span class="built_in">split</span>(',')</span><br><span class="line">        x_cord.<span class="built_in">append</span>(<span class="built_in">float</span>(lineArr[<span class="number">0</span>]))</span><br><span class="line">        y_cord.<span class="built_in">append</span>(<span class="built_in">float</span>(lineArr[<span class="number">1</span>]))</span><br><span class="line">    plt.scatter(x_cord,y_cord,s=<span class="number">30</span>,c='red',marker='o', alpha=<span class="number">0.7</span>)</span><br><span class="line">    plt.<span class="built_in">xlabel</span>(<span class="string">"year"</span>)</span><br><span class="line">    plt.<span class="built_in">ylabel</span>(<span class="string">"time"</span>)</span><br><span class="line">    plt.<span class="built_in">title</span>(<span class="string">"result of game"</span>)</span><br><span class="line"></span><br><span class="line">def linearCalculate():</span><br><span class="line">    x = <span class="built_in">np</span>.<span class="built_in">array</span>(x_cord)</span><br><span class="line">    y = <span class="built_in">np</span>.<span class="built_in">array</span>(y_cord)</span><br><span class="line">    x_mean = <span class="built_in">np</span>.<span class="built_in">mean</span>(x_cord)</span><br><span class="line">    y_mean = <span class="built_in">np</span>.<span class="built_in">mean</span>(y_cord)</span><br><span class="line">    xy_mean = <span class="built_in">np</span>.<span class="built_in">mean</span>(x*y)</span><br><span class="line">    x_square_mean = <span class="built_in">np</span>.<span class="built_in">mean</span>(x**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    w1 = (xy_mean-x_mean*y_mean)/(x_square_mean-x_mean**<span class="number">2</span>)</span><br><span class="line">    w0 = y_mean - w1*x_mean</span><br><span class="line">    xasix = <span class="built_in">np</span>.linspace(<span class="number">1896</span>, <span class="number">2008</span>, <span class="number">112</span>)</span><br><span class="line">    yasix = w1 * xasix + w0</span><br><span class="line">    plt.plot(xasix,yasix, <span class="built_in">label</span>='<span class="built_in">linear</span> line')</span><br><span class="line">    plt.<span class="built_in">legend</span>(loc='upper right')</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == '__main__':</span><br><span class="line">    drawScatterDiagram(<span class="string">"olympic100m.txt"</span>)</span><br><span class="line">    linearCalculate()</span><br><span class="line">    plt.<span class="built_in">show</span>()</span><br></pre></td></tr></table></figure><h2 id="reference">Reference</h2><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">维基百科<a href="https://zh.wikipedia.org/wiki/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95" target="_blank" rel="noopener">最小二乘法</a><a href="#fnref:1" rev="footnote"> ↩</a></span></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;引言&quot;&gt;引言&lt;/h2&gt;
&lt;p&gt;最小二乘法（Least Squares Method, 简记为LS）的维基解释。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;最小二乘法（又称最小平方法）是一种数学优化技术。它通过最小化误差的平方和寻找数据的最佳函数匹配。利用最小二乘法可以简便地求得未知的数据，并使得这些求得的数据与实际数据之间误差的平方和为最小。 &lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;&lt;span class=&quot;hint--top-right hint--error hint--large&quot; data-aria-label=&quot;维基百科[最小二乘法](https://zh.wikipedia.org/wiki/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95)&quot;&gt;[1]&lt;/span&gt;&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;如果大学的时候学过高等数学，或许你对这个名词就不会陌生，这是下册第九章第十节的内容。
    
    </summary>
    
      <category term="机器学习" scheme="https://suool.net/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="机器学习" scheme="https://suool.net/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
</feed>
